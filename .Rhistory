type = "tree_map",
id = c("setor.1", "setor.2", "setor.3", "nome.empresa"),
width = "100%",
height = 500) %>%
d3plusSize(value = "patrimonio.liquido") %>%
d3plusLegend(value = TRUE, order = list(sort = "desc", value = "size")) %>%
d3plusColor("setor.1") %>%
d3plusDepth(0) %>%
d3plusLabels(value = TRUE, valign = "top") %>%
d3plusUi(value = list(list(method = "size",
value = list(list(Patrimonio = "patrimonio.liquido"),
list(Quantidade = "quantidade"),
list(Lucro.por.Acao = "lucro.acao"),
list(Lucro.por.Patrimonio = "lucro.patrimonio"),
list(Atividade.por.Patrimonio = "atividades.patrimonio"))),
list(method = "depth", type = "drop",
value = list(list(Setor = 0),
list(Subsetor = 1),
list(Sub.Subsetor = 2),
list(Empresa = 3)))))
dados.grafico <- dados %>%
mutate(quantidade = 1)
d3plus(data = dados.grafico,
type = "tree_map",
id = c("setor.1", "setor.2", "setor.3", "nome.empresa"),
width = "100%",
height = 500) %>%
d3plusSize(value = "patrimonio.liquido") %>%
d3plusLegend(value = TRUE, order = list(sort = "desc", value = "size")) %>%
d3plusColor("setor.1") %>%
d3plusDepth(0) %>%
d3plusLabels(value = TRUE, valign = "top") %>%
d3plusUi(value = list(list(method = "size",
value = list(list(Patrimonio = "patrimonio.liquido"),
list(Quantidade = "quantidade"))),
list(method = "depth", type = "drop",
value = list(list(Setor = 0),
list(Subsetor = 1),
list(Sub.Subsetor = 2),
list(Empresa = 3)))))
dados <- dados %>%
mutate_at(.vars = vars(patrimonio.liquido, lucro.liquido, atividades.operacionais),
.funs = function(x) { ifelse(.$mil, x * 1000, x) })
dados %>%
group_by(setor.1) %>%
filter(patrimonio.liquido == max(patrimonio.liquido)) %>%
ungroup() %>%
select(setor.1, nome.empresa, patrimonio.liquido) %>%
arrange(-patrimonio.liquido)
d3plus(data = dados.grafico,
type = "tree_map",
id = c("setor.1", "setor.2", "setor.3", "nome.empresa"),
width = "100%",
height = 500) %>%
d3plusSize(value = "patrimonio.liquido") %>%
d3plusLegend(value = TRUE, order = list(sort = "desc", value = "size")) %>%
d3plusColor("setor.1") %>%
d3plusDepth(0) %>%
d3plusLabels(value = TRUE, valign = "top") %>%
d3plusUi(value = list(list(method = "size",
value = list(list(Patrimonio = "patrimonio.liquido"),
list(Quantidade = "quantidade"))),
list(method = "depth", type = "drop",
value = list(list(Setor = 0),
list(Subsetor = 1),
list(Sub.Subsetor = 2),
list(Empresa = 3)))))
dados.grafico <- dados %>%
mutate(quantidade = 1)
d3plus(data = dados.grafico,
type = "tree_map",
id = c("setor.1", "setor.2", "setor.3", "nome.empresa"),
width = "100%",
height = 500) %>%
d3plusSize(value = "patrimonio.liquido") %>%
d3plusLegend(value = TRUE, order = list(sort = "desc", value = "size")) %>%
d3plusColor("setor.1") %>%
d3plusDepth(0) %>%
d3plusLabels(value = TRUE, valign = "top") %>%
d3plusUi(value = list(list(method = "size",
value = list(list(Patrimonio = "patrimonio.liquido"),
list(Quantidade = "quantidade"))),
list(method = "depth", type = "drop",
value = list(list(Setor = 0),
list(Subsetor = 1),
list(Sub.Subsetor = 2),
list(Empresa = 3)))))
d3plus(data = dados.grafico,
type = "tree_map",
id = c("setor.1", "setor.2", "setor.3", "nome.empresa"),
width = "100%",
height = 500) %>%
d3plusSize(value = "patrimonio.liquido") %>%
d3plusLegend(value = TRUE, order = list(sort = "desc", value = "size")) %>%
d3plusColor("setor.1") %>%
d3plusDepth(0) %>%
d3plusLabels(value = TRUE, valign = "top") %>%
d3plusUi(value = list(list(method = "size",
value = list(list(Patrimonio = "patrimonio.liquido"),
list(Quantidade = "quantidade"),
list(Qtd.Acoes = "total.acoes"))),
list(method = "depth", type = "drop",
value = list(list(Setor = 0),
list(Subsetor = 1),
list(Sub.Subsetor = 2),
list(Empresa = 3)))))
d3plus(data = dados %>% mutate(quantidade = 1),
type = "tree_map",
id = c("setor.1", "setor.2", "setor.3", "nome.empresa"),
width = "100%",
height = 500) %>%
d3plusSize(value = "patrimonio.liquido") %>%
d3plusLegend(value = TRUE, order = list(sort = "desc", value = "size")) %>%
d3plusColor("setor.1") %>%
d3plusDepth(0) %>%
d3plusLabels(value = TRUE, valign = "top") %>%
d3plusUi(value = list(list(method = "size",
value = list(list(Patrimonio = "patrimonio.liquido"),
list(Quantidade = "quantidade"),
list(Qtd.Acoes = "total.acoes"))),
list(method = "depth", type = "drop",
value = list(list(Setor = 0),
list(Subsetor = 1),
list(Sub.Subsetor = 2),
list(Empresa = 3)))))
vignette("D3plusR")
d3plus(data = dados %>% mutate(lucro.acao = lucro.liquido/total.acoes),
type = "plot")
d3plus(data = dados %>% mutate(lucro.acao = lucro.liquido/total.acoes),
type = "plot",
# id = c("setor.1", "setor.2", "setor.3", "nome.empresa"),
width = "100%",
height = 500) %>%
d3plusSize(value = "lucro.acao")
glimpse(dados)
glimpse(dados)
d3plus(data = dados %>% mutate(lucro.patrimonio = lucro.liquido/patrimonio.liquido,
atividade.patrimonio = atividades.operacionais/patrimonio.liquido),
type = "plot",
# id = c("setor.1", "setor.2", "setor.3", "nome.empresa"),
width = "100%",
height = 500) %>%
d3plusSize(value = "patrimonio.liquido") %>%
d3plusX(value = "lucro.patrimonio") %>%
d3plusY(value = "atividade.patrimonio") %>%
d3plusColor("setor.1") %>%
d3plusLegend(value = TRUE, order = list(sort = "desc", value = "size"))
d3plus(data = dados %>% mutate(lucro.patrimonio = lucro.liquido/patrimonio.liquido,
atividade.patrimonio = atividades.operacionais/patrimonio.liquido),
type = "plot",
id = "nome.empresa",
width = "100%",
height = 500) %>%
d3plusSize(value = "patrimonio.liquido") %>%
d3plusX(value = "lucro.patrimonio") %>%
d3plusY(value = "atividade.patrimonio") %>%
d3plusColor("setor.1") %>%
d3plusLegend(value = TRUE, order = list(sort = "desc", value = "size"))
d3plus(data = dados %>% mutate(lucro.patrimonio = lucro.liquido/patrimonio.liquido,
atividade.patrimonio = atividades.operacionais/patrimonio.liquido),
type = "Plot",
id = "nome.empresa",
width = "100%",
height = 500) %>%
d3plusSize(value = "patrimonio.liquido") %>%
d3plusX(value = "lucro.patrimonio") %>%
d3plusY(value = "atividade.patrimonio") %>%
d3plusColor("setor.1") %>%
d3plusLegend(value = TRUE, order = list(sort = "desc", value = "size"))
d3plus(data = dados %>% mutate(lucro.patrimonio = lucro.liquido/patrimonio.liquido,
atividade.patrimonio = atividades.operacionais/patrimonio.liquido),
type = "bubbles",
id = "nome.empresa",
width = "100%",
height = 500) %>%
d3plusSize(value = "patrimonio.liquido") %>%
d3plusX(value = "lucro.patrimonio") %>%
d3plusY(value = "atividade.patrimonio") %>%
d3plusColor("setor.1") %>%
d3plusLegend(value = TRUE, order = list(sort = "desc", value = "size"))
library(ggplot2)
dados.grafico <- dados %>%
mutate(lucro.patrimonio = lucro.liquido/patrimonio.liquido,
atividade.patrimonio = atividades.operacionais/patrimonio.liquido,
lucro.acao = lucro.liquido/total.acoes)
ggplot(data = dados.grafico, aes(x = lucro.patrimonio, y = lucro.acao))
ggplot(data = dados.grafico, aes(x = lucro.patrimonio, y = lucro.acao)) +
geom_point()
ggplot(data = dados.grafico, aes(x = patrimonio.liquido, y = lucro.patrimonio)) +
geom_point()
ggplot(data = dados.grafico, aes(x = patrimonio.liquido, y = lucro.acao)) +
geom_point()
glimpse(dados.grafico)
d3plus(data = dados.grafico, id = "nome.empresa",
type = "bar",
height = 400,
width = "100%") %>%
d3plusX(value = "nome.empresa") %>%
d3plusY(value = "lucro.patrimonio")
unique(dados$setor.1)
dados.grafico <- dados %>%
mutate(lucro.patrimonio = lucro.liquido/patrimonio.liquido,
atividade.patrimonio = atividades.operacionais/patrimonio.liquido,
lucro.acao = lucro.liquido/total.acoes) %>%
arrange(-lucro.acao)
dados.grafico %>% setor.1 == 'Petróleo. Gás e Biocombustíveis')
d3plus(data = dados.grafico %>% filter(setor.1 == 'Petróleo. Gás e Biocombustíveis')), id = "nome.empresa",
dados.grafico %>%
filter(setor.1 == 'Petróleo. Gás e Biocombustíveis'))
dados.grafico %>%
filter(setor.1 == 'Petróleo. Gás e Biocombustíveis')
d3plus(data = dados.grafico %>%
filter(setor.1 == 'Petróleo. Gás e Biocombustíveis'), id = "nome.empresa",
type = "bar",
height = 400,
width = "100%") %>%
d3plusX(value = "nome.empresa") %>%
d3plusY(value = "lucro.acao")
filter(setor.1 == 'Petróleo. Gás e Biocombustíveis') %>%
top_n(5), id = "nome.empresa",
d3plus(data = dados.grafico %>%
filter(setor.1 == 'Petróleo. Gás e Biocombustíveis') %>%
top_n(5), id = "nome.empresa",
type = "bar",
height = 400,
width = "100%") %>%
d3plusX(value = "nome.empresa")
d3plus(data = dados.grafico %>%
filter(setor.1 == 'Petróleo. Gás e Biocombustíveis') %>%
top_n(5), id = "nome.empresa",
type = "bar",
height = 400,
width = "100%") %>%
d3plusX(value = "nome.empresa") %>%
d3plusY(value = "lucro.acao")
dados.grafico
dados.grafico <- dados %>%
gorup_by(setor.1, setor.2, setor.3) %>%
summarise(lucro.total = sum(luco.liquido),
patrimonio.total = sum(patrimonio.liquido))
dados.grafico <- dados %>%
group_by(setor.1, setor.2, setor.3) %>%
summarise(lucro.total = sum(luco.liquido),
patrimonio.total = sum(patrimonio.liquido))
dados.grafico <- dados %>%
group_by(setor.1, setor.2, setor.3) %>%
summarise(lucro.total = sum(lucro.liquido),
patrimonio.total = sum(patrimonio.liquido))
dados.grafico <- dados %>%
group_by(setor.1, setor.2, setor.3) %>%
summarise(lucro.total = sum(lucro.liquido),
patrimonio.total = sum(patrimonio.liquido),
lucro.patrimonio = lucro.total/patrimonio.total)
ggplot(dados.grafico, aes(y = lucro.patrimonio, x = setor.3)) +
geom_bar(fill=setor.1)
ggplot(dados.grafico, aes(y = lucro.patrimonio, x = setor.3, fill = setor.1)) +
geom_bar(fill = setor.1)
ggplot(dados.grafico, aes(y = lucro.patrimonio, x = setor.3, fill = setor.1)) +
geom_bar()
ggplot(dados.grafico, aes(y = lucro.patrimonio, x = setor.3, color = setor.1)) +
geom_bar()
ggplot(dados.grafico, aes(y = lucro.patrimonio, x = setor.3, color = setor.1)) +
geom_bar(stat = "identity")
ggplot(dados.grafico, aes(y = lucro.patrimonio, x = setor.3, color = setor.1)) +
geom_bar(stat = "identity", fill = setor.1)
ggplot(dados.grafico, aes(y = lucro.patrimonio, x = setor.3, color = setor.1)) +
geom_bar(stat = "identity", aes(fill = setor.1))
ggplot(dados.grafico, aes(y = lucro.patrimonio, x = setor.3, color = setor.1)) +
geom_bar(stat = "identity", aes(fill = setor.1)) +
coord_flip()
ggplot(dados.grafico, aes(y = lucro.patrimonio, x = setor.2, color = setor.1)) +
geom_bar(stat = "identity", aes(fill = setor.1)) +
coord_flip()
dados.grafico <- dados %>%
group_by(setor.1) %>%
summarise(lucro.total = sum(lucro.liquido),
patrimonio.total = sum(patrimonio.liquido),
lucro.patrimonio = lucro.total/patrimonio.total)
ggplot(dados.grafico, aes(y = lucro.patrimonio, x = setor.1, color = setor.1)) +
geom_bar(stat = "identity", aes(fill = setor.1)) +
coord_flip()
ggplot(dados.grafico, aes(y = lucro.patrimonio, x = reorder(setor.1, lucro.liquido), color = setor.1)) +
geom_bar(stat = "identity", aes(fill = setor.1)) +
coord_flip()
ggplot(dados.grafico, aes(y = lucro.patrimonio, x = reorder(setor.1, -lucro.patrimonio), color = setor.1)) +
geom_bar(stat = "identity", aes(fill = setor.1)) +
coord_flip()
ggplot(dados.grafico, aes(y = lucro.patrimonio, x = reorder(setor.1, lucro.patrimonio), color = setor.1)) +
geom_bar(stat = "identity", aes(fill = setor.1)) +
coord_flip()
ggplot(dados.grafico, aes(y = lucro.patrimonio, x = reorder(setor.1, lucro.patrimonio),
color = lucro.patrimonio > 0)) +
geom_bar(stat = "identity", aes(fill = setor.1)) +
coord_flip()
ggplot(dados.grafico, aes(y = lucro.patrimonio, x = reorder(setor.1, lucro.patrimonio),
color = lucro.patrimonio > 0)) +
geom_bar(stat = "identity", aes(fill = lucro.patrimonio > 0)) +
coord_flip()
dados.grafico.2 <- dados %>%
group_by(setor.1, nome.empresa) %>%
summarise(lucro.total = sum(lucro.liquido),
patrimonio.total = sum(patrimonio.liquido),
lucro.patrimonio = lucro.total/patrimonio.total,
rank = rank(lucro.patrimonio))
View(dados.grafico.2)
dados.grafico.2 <- dados %>%
group_by(setor.1, nome.empresa) %>%
summarise(lucro.total = sum(lucro.liquido),
patrimonio.total = sum(patrimonio.liquido),
lucro.patrimonio = lucro.total/patrimonio.total) %>%
ungroup() %>%
group_by(setor.1) %>%
mutate(rank = rank(lucro.patrimonio))
View(dados.grafico.2)
dados.grafico.2 <- dados %>%
group_by(setor.1, nome.empresa) %>%
summarise(lucro.total = sum(lucro.liquido),
patrimonio.total = sum(patrimonio.liquido),
lucro.patrimonio = lucro.total/patrimonio.total) %>%
ungroup() %>%
group_by(setor.1) %>%
mutate(rank = rank(-lucro.patrimonio))
View(dados.grafico.2)
dados.grafico.2 <- dados %>%
group_by(setor.1, nome.empresa) %>%
summarise(lucro.total = sum(lucro.liquido),
patrimonio.total = sum(patrimonio.liquido),
lucro.patrimonio = lucro.total/patrimonio.total) %>%
ungroup() %>%
group_by(setor.1) %>%
mutate(rank = rank(-lucro.patrimonio)) %>%
filter(rank <= 3)
View(dados.grafico.2)
dados.grafico.2 <- dados %>%
group_by(setor.1, nome.empresa) %>%
summarise(lucro.total = sum(lucro.liquido),
patrimonio.total = sum(patrimonio.liquido),
lucro.patrimonio = lucro.total/patrimonio.total) %>%
ungroup() %>%
group_by(setor.1) %>%
filter(lucro.total > 0) %>%
mutate(rank = rank(-lucro.patrimonio)) %>%
filter(rank <= 3)
View(dados.grafico.2)
ggplot(dados.grafico, aes(y = lucro.patrimonio, x = reorder(setor.1, lucro.patrimonio),
color = lucro.patrimonio > 0)) +
geom_bar(stat = "identity", aes(fill = setor.1)) +
coord_flip()
ggplot(dados.grafico, aes(y = lucro.patrimonio, x = reorder(setor.1, lucro.patrimonio),
color = setor.1)) +
geom_bar(stat = "identity", aes(fill = setor.1)) +
coord_flip()
ggplot(dados.grafico.2, aes(y = lucro.patrimonio, x = reorder(nome.empresa, setor.1, rank),
color = setor.1)) +
geom_bar(stat = "identity", aes(fill = setor.1)) +
coord_flip()
filter(lucro.total > 0) %>%
mutate(rank = rank(-lucro.patrimonio))
dados.grafico.2 <- dados %>%
group_by(setor.1, nome.empresa) %>%
summarise(lucro.total = sum(lucro.liquido),
patrimonio.total = sum(patrimonio.liquido),
lucro.patrimonio = lucro.total/patrimonio.total) %>%
ungroup() %>%
group_by(setor.1) %>%
mutate(lucro.total.setor = sum(lucro.liquido),
patrimonio.total.setor = sum(patrimonio.liquido),
lucro.patrimonio.setor = lucro.total/patrimonio.total,
rank.setor = rank(-lucro.patrimonio.setor)) %>%
filter(lucro.total > 0) %>%
mutate(rank = rank(-lucro.patrimonio))
dados.grafico.2 <- dados %>%
group_by(setor.1, nome.empresa) %>%
summarise(lucro.total = sum(lucro.liquido),
patrimonio.total = sum(patrimonio.liquido),
lucro.patrimonio = lucro.total/patrimonio.total) %>%
ungroup() %>%
group_by(setor.1) %>%
mutate(lucro.total.setor = sum(lucro.liquido),
patrimonio.total.setor = sum(patrimonio.liquido),
lucro.patrimonio.setor = lucro.total.setor/patrimonio.total.setor,
rank.setor = rank(-lucro.patrimonio.setor)) %>%
filter(lucro.total > 0) %>%
mutate(rank = rank(-lucro.patrimonio))
dados.grafico.2 <- dados %>%
group_by(setor.1, nome.empresa) %>%
summarise(lucro.total = sum(lucro.liquido),
patrimonio.total = sum(patrimonio.liquido),
lucro.patrimonio = lucro.total/patrimonio.total) %>%
ungroup() %>%
group_by(setor.1)
%>%
dados.grafico.2 <- dados %>%
group_by(setor.1, nome.empresa) %>%
summarise(lucro.total = sum(lucro.liquido),
patrimonio.total = sum(patrimonio.liquido),
lucro.patrimonio = lucro.total/patrimonio.total) %>%
ungroup() %>%
group_by(setor.1) %>%
mutate(lucro.total.setor = sum(lucro.liquido),
patrimonio.total.setor = sum(patrimonio.liquido),
lucro.patrimonio.setor = lucro.total.setor/patrimonio.total.setor,
rank.setor = rank(-lucro.patrimonio.setor))
dados.grafico.2 <- dados %>%
group_by(setor.1, nome.empresa) %>%
summarise(lucro.total = sum(lucro.liquido),
patrimonio.total = sum(patrimonio.liquido),
lucro.patrimonio = lucro.total/patrimonio.total) %>%
ungroup() %>%
group_by(setor.1) %>%
mutate(lucro.total.setor = sum(lucro.liquido),
patrimonio.total.setor = sum(patrimonio.liquido),
lucro.patrimonio.setor = lucro.total.setor/patrimonio.total.setor)
dados.grafico.2 <- dados %>%
group_by(setor.1, nome.empresa) %>%
summarise(lucro.total = sum(lucro.liquido),
patrimonio.total = sum(patrimonio.liquido),
lucro.patrimonio = lucro.total/patrimonio.total) %>%
ungroup() %>%
group_by(setor.1) %>%
mutate(lucro.total.setor = sum(lucro.total),
patrimonio.total.setor = sum(patrimonio.total),
lucro.patrimonio.setor = lucro.total.setor/patrimonio.total.setor,
rank.setor = rank(-lucro.patrimonio.setor)) %>%
filter(lucro.total > 0) %>%
mutate(rank = rank(-lucro.patrimonio))
View(dados.grafico.2)
dados.grafico <- dados %>%
group_by(setor.1) %>%
summarise(lucro.total = sum(lucro.liquido),
patrimonio.total = sum(patrimonio.liquido),
total.acoes = sum(total.acoes),
lucro.patrimonio = lucro.total/patrimonio.total,
lucro.acao = lucro.total/total.acoes)
View(dados.grafico.2)
View(dados.grafico)
dados.grafico <- dados %>%
group_by(setor.1) %>%
summarise(lucro.total = sum(lucro.liquido),
patrimonio.total = sum(patrimonio.liquido),
total.acoes = sum(total.acoes),
lucro.patrimonio = lucro.total/patrimonio.total,
lucro.acao = lucro.total/total.acoes) %>%
ungroup() %>%
gather(key, value, lucro.patrimonio, lucro.acao)
View(dados.grafico)
ggplot(dados.grafico, aes(y = value, x = reorder(setor.1, lucro.patrimonio),
color = setor.1)) +
geom_bar(stat = "identity", aes(fill = setor.1)) +
coord_flip() +
facet_wrap(key)
View(dados.grafico)
ggplot(dados.grafico, aes(y = value, x = reorder(setor.1, lucro.patrimonio),
color = setor.1)) +
geom_bar(stat = "identity", aes(fill = setor.1)) +
coord_flip() +
facet_grid(key ~ .)
ggplot(dados.grafico, aes(y = value, x = reorder(setor.1, key),
color = setor.1)) +
geom_bar(stat = "identity", aes(fill = setor.1)) +
coord_flip() +
facet_grid(key ~ .)
ggplot(dados.grafico, aes(y = value, x = reorder(setor.1, value),
color = setor.1)) +
geom_bar(stat = "identity", aes(fill = setor.1)) +
coord_flip() +
facet_grid(key ~ .)
ggplot(dados.grafico, aes(y = value, x = reorder(setor.1, value),
color = setor.1)) +
geom_bar(stat = "identity", aes(fill = setor.1)) +
coord_flip() +
facet_grid(key ~ ., rows = 1)
ggplot(dados.grafico, aes(y = value, x = reorder(setor.1, value),
color = setor.1)) +
geom_bar(stat = "identity", aes(fill = setor.1)) +
coord_flip() +
facet_grid(key ~ ., cols = 1)
ggplot(dados.grafico, aes(y = value, x = reorder(setor.1, value),
color = setor.1)) +
geom_bar(stat = "identity", aes(fill = setor.1)) +
coord_flip() +
facet_grid(key ~ ., scales = 'free')
ggplot(dados.grafico, aes(y = value, x = reorder(setor.1, value),
color = setor.1)) +
geom_bar(stat = "identity", aes(fill = setor.1)) +
coord_flip() +
facet_grid(key ~ ., scales = 'free_y', ncols = 2)
ggplot(dados.grafico, aes(y = value, x = reorder(setor.1, value),
color = setor.1)) +
geom_bar(stat = "identity", aes(fill = setor.1)) +
coord_flip() +
facet_grid(key ~ ., scales = 'free_y', ncol = 2)
ggplot(dados.grafico, aes(y = value, x = reorder(setor.1, value),
color = setor.1)) +
geom_bar(stat = "identity", aes(fill = setor.1)) +
coord_flip() +
facet_grid(key ~ ., scales = 'free_y', nrow = 1)
ggplot(dados.grafico, aes(y = value, x = reorder(setor.1, value),
color = setor.1)) +
geom_bar(stat = "identity", aes(fill = setor.1)) +
coord_flip() +
facet_grid(key ~ ., scales = 'free_y')
ggplot(dados.grafico, aes(y = value, x = reorder(setor.1, value),
color = setor.1)) +
geom_bar(stat = "identity", aes(fill = setor.1)) +
coord_flip() +
facet_wrap(key ~ ., scales = 'free_y')
ggplot(dados.grafico, aes(y = value, x = reorder(setor.1, value),
color = setor.1)) +
geom_bar(stat = "identity", aes(fill = setor.1)) +
coord_flip() +
facet_wrap(key ~ ., scales = 'free_y', ncol = 1)
