patrimonio.liquido <- conteudo.iframe %>%
html_node(xpath=".//td[contains(., 'nio Líquido')]/following-sibling::td[1]") %>%
html_text() %>%
str_replace_all('\\.|\\)', '') %>%
str_replace_all('\\(', '-')
patrimonio.liquido
extrai_informacoes <- function(link) {
conteudo <- link %>%
read_html(encoding = 'Latin1')
nome.empresa <- conteudo %>%
html_nodes('h2') %>%
html_text()
conteudo.iframe <- conteudo %>%
html_nodes('iframe') %>%
.[2] %>%
html_attr('src') %>%
str_replace_all(., '../../', '') %>%
paste0(base, .) %>%
read_html()
codigo.negociacao <- conteudo.iframe %>%
html_nodes('.LinkCodNeg') %>%
html_text() %>%
unique() %>%
paste(collapse = '/')
setores <- conteudo.iframe %>%
html_nodes(xpath=".//td[contains(., 'Classificação Setorial:')]/following-sibling::td[1]") %>%
html_text()
patrimonio.liquido <- conteudo.iframe %>%
html_node(xpath=".//td[contains(., 'nio Líquido')]/following-sibling::td[1]") %>%
html_text() %>%
str_replace_all('\\.|\\)', '') %>%
str_replace_all('\\(', '-')
final <- data.frame(nome = nome.empresa, codigo = codigo.negociacao,
setor = setores, patrimonio = patrimonio.liquido,
stringsAsFactors = FALSE)
}
dados <- data_frame()
for(i in links.empresas) {
parcial <- extrai_informacoes(i)
dados <- bind_rows(dados, parcial)
}
View(dados)
dados.bkp1 <- dados
links.empresas
str_locate_all(links.empresas, pattern = '\d+$')
str_locate_all(links.empresas, pattern = '\\d+$')
str_locate(links.empresas, pattern = '\\d+$')
str_extract_all(links.empresas, pattern = '\\d+$')
str_extract_all(links.empresas, pattern = '.*\\d+$')
str_extract_all(links.empresas, pattern = '.*\\d+$', simplify = TRUE)
links.empresas
unique(links.empresas) %>%
filter(!grepl("\d+$", .)
unique(links.empresas) %>%
filter(!grepl("\\d+$", .)
unique(links.empresas) %>%
filter(!grepl("\\d+$", .))
unique(links.empresas) %>%
grepl("\\d+$", .)
unique(links.empresas) %>%
.[grepl("\\d+$", .)]
links.empresas <- unique(links.empresas) %>%
.[grepl("\\d+$", .)]
View(dados)
dados.final <- dados %>%
separate(c("a", "b", "c"), extra = "drop", fill = "right")
dados.final <- dados %>%
separate(c("a", "b", "c"), sep = '/' extra = "drop", fill = "right")
dados.final <- dados %>%
separate(c("a", "b", "c"), sep = '/')
dados.final <- dados %>%
separate(setor, c("a", "b", "c"), sep = '/')
dados.final
View(dados.final)
dados.final <- dados %>%
separate(setor, c("setor1", "setor2", "setor3"), sep = '/')
View(dados.final)
devtools::install_github('paulofelipe/D3plusR')
library(D3plusR)
devtools::install_github('paulofelipe/D3plusR')
vignette("D3plusR")
data("bra_exp_2015")
glimpse(bra_exp_2015)
d3plus(data = dados.final,
type = "tree_map",
id = c("setor1", "setor2", "setor3"),
width = "100%",
height = 500) %>%
d3plusSize(value = "patrimonio") %>%
d3plusLegend(value = TRUE, order = list(sort = "desc", value = "size")) %>%
d3plusColor("region") %>%
d3plusDepth(0) %>%
d3plusLabels(value = TRUE, valign = "top") %>%
d3plusUi(value = list(list(method = "color",
value = list(list(Region = "setor1"), list(Value = "patrimonio"))),
list(method = "depth", type = "drop",
value = list(list(Continent = 0), list(Country = 1)))))
d3plus(data = dados.final,
type = "tree_map",
id = c("setor1", "setor2", "setor3"),
width = "100%",
height = 500) %>%
d3plusSize(value = "patrimonio")
glimpse(dados.final)
dados.final <- dados %>%
separate(setor, c("setor1", "setor2", "setor3"), sep = '/') %>%
mutate(patrimonio.grafico = ifelse(patrimonio < 0, 0, patrimonio))
d3plus(data = dados.final,
type = "tree_map",
id = c("setor1", "setor2", "setor3"),
width = "100%",
height = 500) %>%
d3plusSize(value = "patrimonio.grafico")
data("bra_exp_2015")
vignette("D3plusR")
d3plus(data = dados.final,
type = "tree_map",
id = c("setor1"),
width = "100%",
height = 500) %>%
d3plusSize(value = "patrimonio.grafico")
d3plus(data = dados.final,
type = "tree_map",
id = c("setor1"),
width = "100%",) %>%
d3plusSize(value = "patrimonio.grafico")
dados.final
d3plus(data = dados.final,
type = "tree_map",
id = c("setor1"),
width = "100%")
d3plus(data = dados.final,
type = "tree_map",
id = c("setor1"),
width = "100%",
height = 500)
d3plus(data = dados.final,
type = "tree_map",
id = c("setor1"),
width = "100%",
height = 500) %>%
d3plusSize(value = "patrimonio.grafico")
glimpse(dados.final)
dados.final <- dados %>%
separate(setor, c("setor1", "setor2", "setor3"), sep = '/') %>%
mutate(patrimonio.grafico = as.numeric(ifelse(patrimonio < 0, 0, patrimonio)))
d3plus(data = dados.final,
type = "tree_map",
id = c("setor1"),
width = "100%",
height = 500) %>%
d3plusSize(value = "patrimonio.grafico")
d3plus(data = dados.final,
type = "tree_map",
id = c("setor1", "setor2"),
width = "100%",
height = 500) %>%
d3plusSize(value = "patrimonio.grafico") %>%
d3plusLegend(value = TRUE, order = list(sort = "desc", value = "size")) %>%
d3plusColor("region") %>%
d3plusDepth(0) %>%
d3plusLabels(value = TRUE, valign = "top") %>%
d3plusUi(value = list(list(method = "color",
value = list(list(Region = "setor1"), list(Value = "patrimonio.grafico"))),
list(method = "depth", type = "drop",
value = list(list(Continent = 0), list(Country = 1)))))
d3plus(data = dados.final,
type = "tree_map",
id = c("setor1", "setor2"),
width = "100%",
height = 500) %>%
d3plusSize(value = "patrimonio.grafico") %>%
d3plusLegend(value = TRUE, order = list(sort = "desc", value = "size")) %>%
d3plusColor("setor1") %>%
d3plusDepth(0) %>%
d3plusLabels(value = TRUE, valign = "top") %>%
d3plusUi(value = list(list(method = "color",
value = list(list(Region = "setor1"), list(Value = "patrimonio.grafico"))),
list(method = "depth", type = "drop",
value = list(list(Continent = 0), list(Country = 1)))))
d3plus(data = dados.final,
type = "tree_map",
id = c("setor1", "setor2", "setor3", "nome"),
width = "100%",
height = 500) %>%
d3plusSize(value = "patrimonio.grafico") %>%
d3plusLegend(value = TRUE, order = list(sort = "desc", value = "size")) %>%
d3plusColor("setor1") %>%
d3plusDepth(0) %>%
d3plusLabels(value = TRUE, valign = "top") %>%
d3plusUi(value = list(list(method = "color",
value = list(list(Region = "setor1"), list(Value = "patrimonio.grafico"))),
list(method = "depth", type = "drop",
value = list(list(Continent = 0), list(Country = 1)))))
d3plus(data = dados.final,
type = "tree_map",
id = c("setor1", "setor2", "setor3", "nome"),
width = "100%",
height = 500) %>%
d3plusSize(value = "patrimonio.grafico") %>%
d3plusLegend(value = TRUE, order = list(sort = "desc", value = "size")) %>%
d3plusColor("setor1") %>%
d3plusDepth(0) %>%
d3plusLabels(value = TRUE, valign = "top")
write.csv2(dados.final, 'EMPRESA_SETOR.csv', row.names = FALSE)
getwd()
path <- './migrations'
files <- list.files(path)
files
file <- files[5]
file
folder <- str_replace(file, '\\.markdown$|\\.md$', '')
folder
glue('./_posts/{folder}/{folder}.Rmd')
folder <- str_replace(file, '\\.markdown$|\\.md$', '')
folder
new.file <- str_sub(folder, 11, -1)
new.file
new.file <- str_sub(folder, 12, -1)
new.file
for (file in files) {
folder <- str_replace(file, '\\.markdown$|\\.md$', '')
new.file <- str_sub(folder, 12, -1)
dir.create(glue('./_posts/{folder}'))
file.copy(glue('{path}/{file}'), glue('./_posts/{folder}/{new.file}.Rmd'))
}
file.copy(glue('{path}/{file}'), glue('./_posts/{folder}/{new.file}.Rmd'))
file <- files[5]
folder <- str_replace(file, '\\.markdown$|\\.md$', '')
new.file <- str_sub(folder, 12, -1)
file
conteudo <- read_file(glue('./_posts/{folder}/{new.file}.Rmd'))
conteudo
str_extract(conteudo, '---.*---')
str_extract(conteudo, '---(.*)---')
str_extract(conteudo, '(---.*---)')
str_extract(conteudo, '.*---|---.*')
str_match(conteudo, "--- (.*?) ---")
str_match(conteudo, "---(.*?)---")
conteudo
str_match(conteudo, "---(.*?)---")
str_match(conteudo, "---\\n(.*?)\\n---")
str_match(conteudo, "\-\-\-\\n(.*?)\\n\-\-\-")
str_match(conteudo, "---\\n(.*?)---")
str_match(conteudo, "--- (.*?) ---")
str_match(conteudo, "^--- (.*?) ---")
str_match(conteudo, "^---\\n (.*?) ---")
str_match(conteudo, "^---\\n")
str_match(conteudo, "^---\\n .* ---")
str_match(conteudo, "^---\\n .*")
str_match(conteudo, "(---\\n(.*?)---)")
str_match(conteudo, "(---\\n.*?---)")
str_match(conteudo, "(---\\n.*---)")
teste <- "---\ncategories:\n- r\n- básie-2/\n---\n\nSeguindo v"
str_match(conteudo, "---.*---")
str_match(conteudo, "^---.*---")
str_match(conteudo, "^---(.*?)---")
str_match_all(conteudo, "^---.*---")
str_match_all(conteudo, "^---(.*?)---")
teste <- "---\ncategories:\n- r\n- básie-2/\n---\n\nSeguindo v"
str_match_all(conteudo, "---(.*?)---")
conteudo
teste <- "---a---\n\nSeguindo v"
str_match_all(conteudo, "---(.*?)---")
str_match_all(teste, "---(.*?)---")
str_match_all(teste, "---(.*?)---")
teste <- "---\ncategories:\n- r\n- básie-2/\n---\n\nSeguindo v"
str_match_all(teste, "---(.*?)---")
teste <- "---categories:\n- r\n- básie-2/\n---\n\nSeguindo v"
str_match_all(teste, "---(.*?)---")
teste <- "---categories:\n- r\n- básie-2/---\n\nSeguindo v"
str_match_all(teste, "---(.*?)---")
teste <- "---categories:--- v"
str_match_all(teste, "---(.*?)---")
str_match_all(conteudo, "---\\n(.*?)\\n---")
str_match_all(conteudo, "---\n(.*?)\n---")
str_match(conteudo, "---\n(.*?)\n---")
conteudo
str_match(conteudo, "/^---(.*?)---/g")
str_match(conteudo, "^---(.*?)---/")
str_match(conteudo, "^---(.*?)---/", perl=TRUE)
str_match(conteudo, "^---(.*?)---")
grep("^---(.*?)---", conteudo)
grep("^---(.*?)---", conteudo, perl = TRUE)
grep("^---(.*?)---", conteudo, value = TRUE)
grep("^---(.*?)---", teste, value = TRUE)
grep("^---(.*?)---", teste, pearl = TRUE, value = TRUE)
grep("^---(.*?)---", teste, perl = TRUE, value = TRUE)
sub("^---(.*?)---", teste, perl = TRUE, value = TRUE)
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
library(glue)
library(tidyverse)
path <- './migrations'
files <- list.files(path)
file <- files[5]
files
files <- list.files(path)
files
file <- files[5]
folder <- str_replace(file, '\\.markdown$|\\.md$', '')
folder
new.file <- str_sub(folder, 12, -1)
new.file
dir.create(glue('./_posts/{folder}'))
file.copy(glue('{path}/{file}'), glue('./_posts/{folder}/{new.file}.Rmd'))
folder
folder <- str_replace(file, '\\.markdown$|\\.Rmd$', '')
folder
new.file <- str_sub(folder, 12, -1)
dir.create(glue('./_posts/{folder}'))
file.copy(glue('{path}/{file}'), glue('./_posts/{folder}/{new.file}.Rmd'))
rmarkdown::render_site()
rmarkdown::render_site()
create_post("The Sharpe Ratio")
rmarkdown::create_post("The Sharpe Ratio")
library(distill)
rmarkdown::create_post("The Sharpe Ratio")
files <- list.files(path)
files <- list.files(path)
# Cria pasta e copia arquivo pra cada pasta
for (file in files) {
folder <- str_replace(file, '\\.markdown$|\\.Rmd$', '')
new.file <- str_sub(folder, 12, -1)
dir.create(glue('./_posts/{folder}'))
file.copy(glue('{path}/{file}'), glue('./_posts/{folder}/{new.file}.Rmd'))
}
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
install.packages("BETS")
install.packages("BETS")
knitr::opts_chunk$set(echo = TRUE)
sudo apt-get install mesa-common-dev libglu1-mesa-dev
install.packages("WDI")
install.packages("ISLR")
rmarkdown::render_site()
knitr::opts_chunk$set(echo = TRUE)
getwd()
rmarkdown::render_site()
rmarkdown::render_site()
file.create(".nojekyll")
getwd()
file.create(".nojekyll")
rmarkdown::create('.nojekyll')
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
teste <- read.csv('fulljoin-2019-07-14T21_55_24.715646-links.csv')
teste
teste <- read.csv('fulljoin-2019-07-14T21_55_24.715646-links.csv',
header = FALSE)
teste
library('fuzzyjoin')
install.packages('fuzzyjoin')
library('fuzzyjoin')
novos <- data.frame(V2 = c('https://www.fulljoin.com.br/posts/2017-03-12-introducao-d3plusr',
'https://www.fulljoin.com.br/posts/2017-01-28-bases-de-dados-kaggle',
'https://www.fulljoin.com.br/posts/2016-08-26-visualizacao-de-dados-parte-1',
'https://www.fulljoin.com.br/posts/2016-08-01-manipulacao-de-dados-parte-1',
'https://www.fulljoin.com.br/posts/2016-07-30-comex-vis',
'https://www.fulljoin.com.br/posts/2016-06-06-intro-modelos-r',
'https://www.fulljoin.com.br/posts/2016-05-12-tudo-sobre-joins',
'https://www.fulljoin.com.br/posts/2016-05-09-kit-de-sobrevivencia-em-r-parte-7',
'https://www.fulljoin.com.br/posts/2016-05-01-kit-de-sobrevivencia-em-r-parte-6',
'https://www.fulljoin.com.br/posts/2016-04-11-kit-de-sobrevivencia-em-r-parte-5',
'https://www.fulljoin.com.br/posts/2016-04-07-kit-de-sobrevivencia-em-r-parte-4',
'https://www.fulljoin.com.br/posts/2016-03-28-kit-de-sobrevivencia-em-r-parte-3',
'https://www.fulljoin.com.br/posts/2016-03-25-kit-de-sobrevivencia-em-r-parte-2',
'https://www.fulljoin.com.br/posts/2016-03-20-kit-de-sobrevivencia-em-r-parte-1',
'https://www.fulljoin.com.br/posts/2016-03-20-aplicando-ciencia-de-dados-parte-2-equipe',
'https://www.fulljoin.com.br/posts/2016-03-14-como-aplicar-ciencia-de-dados',
'https://www.fulljoin.com.br/posts/2016-03-09-hello-world'))
novos
glimpse(teste)
library(tidyverse)
glimpse(teste)
teste %>%
stringdist_full_join(novos, by = c('V1' = 'V2'))
novos <- data.frame(V2 = c('https://www.fulljoin.com.br/posts/2017-03-12-introducao-d3plusr',
'https://www.fulljoin.com.br/posts/2017-01-28-bases-de-dados-kaggle',
'https://www.fulljoin.com.br/posts/2016-08-26-visualizacao-de-dados-parte-1',
'https://www.fulljoin.com.br/posts/2016-08-01-manipulacao-de-dados-parte-1',
'https://www.fulljoin.com.br/posts/2016-07-30-comex-vis',
'https://www.fulljoin.com.br/posts/2016-06-06-intro-modelos-r',
'https://www.fulljoin.com.br/posts/2016-05-12-tudo-sobre-joins',
'https://www.fulljoin.com.br/posts/2016-05-09-kit-de-sobrevivencia-em-r-parte-7',
'https://www.fulljoin.com.br/posts/2016-05-01-kit-de-sobrevivencia-em-r-parte-6',
'https://www.fulljoin.com.br/posts/2016-04-11-kit-de-sobrevivencia-em-r-parte-5',
'https://www.fulljoin.com.br/posts/2016-04-07-kit-de-sobrevivencia-em-r-parte-4',
'https://www.fulljoin.com.br/posts/2016-03-28-kit-de-sobrevivencia-em-r-parte-3',
'https://www.fulljoin.com.br/posts/2016-03-25-kit-de-sobrevivencia-em-r-parte-2',
'https://www.fulljoin.com.br/posts/2016-03-20-kit-de-sobrevivencia-em-r-parte-1',
'https://www.fulljoin.com.br/posts/2016-03-20-aplicando-ciencia-de-dados-parte-2-equipe',
'https://www.fulljoin.com.br/posts/2016-03-14-como-aplicar-ciencia-de-dados',
'https://www.fulljoin.com.br/posts/2016-03-09-hello-world'),
stringsAsFactors = TRUE)
teste <- read.csv('fulljoin-2019-07-14T21_55_24.715646-links.csv',
header = FALSE,
stringsAsFactors = TRUE)
glimpse(teste)
teste <- read.csv('fulljoin-2019-07-14T21_55_24.715646-links.csv',
header = FALSE,
stringsAsFactors = FALSE)
novos <- data.frame(V2 = c('https://www.fulljoin.com.br/posts/2017-03-12-introducao-d3plusr',
'https://www.fulljoin.com.br/posts/2017-01-28-bases-de-dados-kaggle',
'https://www.fulljoin.com.br/posts/2016-08-26-visualizacao-de-dados-parte-1',
'https://www.fulljoin.com.br/posts/2016-08-01-manipulacao-de-dados-parte-1',
'https://www.fulljoin.com.br/posts/2016-07-30-comex-vis',
'https://www.fulljoin.com.br/posts/2016-06-06-intro-modelos-r',
'https://www.fulljoin.com.br/posts/2016-05-12-tudo-sobre-joins',
'https://www.fulljoin.com.br/posts/2016-05-09-kit-de-sobrevivencia-em-r-parte-7',
'https://www.fulljoin.com.br/posts/2016-05-01-kit-de-sobrevivencia-em-r-parte-6',
'https://www.fulljoin.com.br/posts/2016-04-11-kit-de-sobrevivencia-em-r-parte-5',
'https://www.fulljoin.com.br/posts/2016-04-07-kit-de-sobrevivencia-em-r-parte-4',
'https://www.fulljoin.com.br/posts/2016-03-28-kit-de-sobrevivencia-em-r-parte-3',
'https://www.fulljoin.com.br/posts/2016-03-25-kit-de-sobrevivencia-em-r-parte-2',
'https://www.fulljoin.com.br/posts/2016-03-20-kit-de-sobrevivencia-em-r-parte-1',
'https://www.fulljoin.com.br/posts/2016-03-20-aplicando-ciencia-de-dados-parte-2-equipe',
'https://www.fulljoin.com.br/posts/2016-03-14-como-aplicar-ciencia-de-dados',
'https://www.fulljoin.com.br/posts/2016-03-09-hello-world'),
stringsAsFactors = FALSE)
teste %>%
stringdist_full_join(novos, by = c('V1' = 'V2'))
velho <- read.csv('fulljoin-2019-07-14T21_55_24.715646-links.csv',
header = FALSE,
stringsAsFactors = FALSE)
velhos <- read.csv('fulljoin-2019-07-14T21_55_24.715646-links.csv',
header = FALSE,
stringsAsFactors = FALSE)
novos <- data.frame(V2 = c('https://www.fulljoin.com.br/posts/2017-03-12-introducao-d3plusr',
'https://www.fulljoin.com.br/posts/2017-01-28-bases-de-dados-kaggle',
'https://www.fulljoin.com.br/posts/2016-08-26-visualizacao-de-dados-parte-1',
'https://www.fulljoin.com.br/posts/2016-08-01-manipulacao-de-dados-parte-1',
'https://www.fulljoin.com.br/posts/2016-07-30-comex-vis',
'https://www.fulljoin.com.br/posts/2016-06-06-intro-modelos-r',
'https://www.fulljoin.com.br/posts/2016-05-12-tudo-sobre-joins',
'https://www.fulljoin.com.br/posts/2016-05-09-kit-de-sobrevivencia-em-r-parte-7',
'https://www.fulljoin.com.br/posts/2016-05-01-kit-de-sobrevivencia-em-r-parte-6',
'https://www.fulljoin.com.br/posts/2016-04-11-kit-de-sobrevivencia-em-r-parte-5',
'https://www.fulljoin.com.br/posts/2016-04-07-kit-de-sobrevivencia-em-r-parte-4',
'https://www.fulljoin.com.br/posts/2016-03-28-kit-de-sobrevivencia-em-r-parte-3',
'https://www.fulljoin.com.br/posts/2016-03-25-kit-de-sobrevivencia-em-r-parte-2',
'https://www.fulljoin.com.br/posts/2016-03-20-kit-de-sobrevivencia-em-r-parte-1',
'https://www.fulljoin.com.br/posts/2016-03-20-aplicando-ciencia-de-dados-parte-2-equipe',
'https://www.fulljoin.com.br/posts/2016-03-14-como-aplicar-ciencia-de-dados',
'https://www.fulljoin.com.br/posts/2016-03-09-hello-world'),
stringsAsFactors = FALSE)
final <- velhos %>%
stringdist_full_join(novos, by = c('V1' = 'V2'))
View(final)
final <- velhos %>%
fuzzy_full_join(novos, by = c('V1' = 'V2'))
final <- velhos %>%
distance_full_join(novos, by = c('V1' = 'V2'))
final <- velhos %>%
stringdist_full_join(novos, by = c('V1' = 'V2'), max_dist = 5)
View(final)
final <- velhos %>%
stringdist_full_join(novos, by = c('V1' = 'V2'), max_dist = 0)
View(final)
final <- velhos %>%
stringdist_full_join(novos, by = c('V1' = 'V2'), max_dist = 10)
View(final)
getwd()
distill::create_post('Estamos de volta!')
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
voltamos <- function() {}
now()
systime()
time()
Sys.time()
voltamos <- function() {
if (Sys.time() >= as.Date('2019-07-15')) {
return('Sim!')
}
return('Não...')
}
voltamos()
knitr::opts_chunk$set(echo = FALSE)
# Learn more about creating websites with Distill at:
# https://rstudio.github.io/distill/website.html
# Learn more about publishing to GitHub Pages at:
# https://rstudio.github.io/distill/publish_website.html#github-pages
voltamos <- function() {
if (Sys.time() >= as.Date('2019-07-15')) {
return('Sim!')
}
return('Não...')
}
voltamos()
voltamos <- function() {
if (Sys.time() >= as.Date('2019-07-15')) {
return('Sim!')
}
return('Não...')
}
voltamos()
