<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

  <!--radix_placeholder_meta_tags-->
<title>Fulljoin: B3 + rvest: Explorando dados financeiros com R - parte 1</title>

<meta property="description" itemprop="description" content="Primeiro de uma sequência de posts onde vamos utilizar o R para explorar dados financeiros disponíveis na internet. Aprofundaremos bastante em web scraping e manipulação de dados."/>

<link rel="canonical" href="https://www.fulljoin.com.br/posts/2019-07-18-b3-rvest-explorando-dados-financeiros-com-r/"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2019-08-27"/>
<meta property="article:created" itemprop="dateCreated" content="2019-08-27"/>
<meta name="article:author" content="Saulo Guerra"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="Fulljoin: B3 + rvest: Explorando dados financeiros com R - parte 1"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="Primeiro de uma sequência de posts onde vamos utilizar o R para explorar dados financeiros disponíveis na internet. Aprofundaremos bastante em web scraping e manipulação de dados."/>
<meta property="og:url" content="https://www.fulljoin.com.br/posts/2019-07-18-b3-rvest-explorando-dados-financeiros-com-r/"/>
<meta property="og:image" content="https://www.fulljoin.com.br/posts/2019-07-18-b3-rvest-explorando-dados-financeiros-com-r/../../images/b3_rvest.png"/>
<meta property="og:image:width" content="501"/>
<meta property="og:image:height" content="218"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="Fulljoin"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="Fulljoin: B3 + rvest: Explorando dados financeiros com R - parte 1"/>
<meta property="twitter:description" content="Primeiro de uma sequência de posts onde vamos utilizar o R para explorar dados financeiros disponíveis na internet. Aprofundaremos bastante em web scraping e manipulação de dados."/>
<meta property="twitter:url" content="https://www.fulljoin.com.br/posts/2019-07-18-b3-rvest-explorando-dados-financeiros-com-r/"/>
<meta property="twitter:image" content="https://www.fulljoin.com.br/posts/2019-07-18-b3-rvest-explorando-dados-financeiros-com-r/../../images/b3_rvest.png"/>
<meta property="twitter:image:width" content="501"/>
<meta property="twitter:image:height" content="218"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="Fulljoin: B3 + rvest: Explorando dados financeiros com R - parte 1"/>
<meta name="citation_fulltext_html_url" content="https://www.fulljoin.com.br/posts/2019-07-18-b3-rvest-explorando-dados-financeiros-com-r/"/>
<meta name="citation_online_date" content="2019/08/27"/>
<meta name="citation_publication_date" content="2019/08/27"/>
<meta name="citation_author" content="Saulo Guerra"/>
<!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","output","draft","categories","preview","citation_url","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["B3 + rvest: Explorando dados financeiros com R - parte 1"]},{"type":"character","attributes":{},"value":["Primeiro de uma sequência de posts onde vamos utilizar o R para explorar dados financeiros disponíveis na internet. Aprofundaremos bastante em web scraping e manipulação de dados."]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Saulo Guerra"]},{"type":"character","attributes":{},"value":["https://github.com/sauloguerra"]}]}]},{"type":"character","attributes":{},"value":["08-27-2019"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[false]}]}]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["rvest","scraping"]},{"type":"character","attributes":{},"value":["../../images/b3_rvest.png"]},{"type":"character","attributes":{},"value":["https://www.fulljoin.com.br/posts/2019-07-18-b3-rvest-explorando-dados-financeiros-com-r/"]},{"type":"character","attributes":{},"value":["https://www.fulljoin.com.br/posts/2019-07-18-b3-rvest-explorando-dados-financeiros-com-r/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["b3-rvest-explorando-dados-financeiros-com-r_files/bowser-1.9.3/bowser.min.js","b3-rvest-explorando-dados-financeiros-com-r_files/d3plus-1.9.6/d3-format.v1.min.js","b3-rvest-explorando-dados-financeiros-com-r_files/d3plus-1.9.6/d3.min.js","b3-rvest-explorando-dados-financeiros-com-r_files/d3plus-1.9.6/d3plus.min.js","b3-rvest-explorando-dados-financeiros-com-r_files/d3plus-1.9.6/index.html","b3-rvest-explorando-dados-financeiros-com-r_files/d3plus-1.9.6/LICENSE","b3-rvest-explorando-dados-financeiros-com-r_files/d3plus-1.9.6/README.md","b3-rvest-explorando-dados-financeiros-com-r_files/d3plus-1.9.6/topojson.js","b3-rvest-explorando-dados-financeiros-com-r_files/d3plus-1.9.6/topojson.min.js","b3-rvest-explorando-dados-financeiros-com-r_files/d3plus-binding-0.0.1/d3plus.js","b3-rvest-explorando-dados-financeiros-com-r_files/distill-2.2.21/template.v2.js","b3-rvest-explorando-dados-financeiros-com-r_files/figure-html5/unnamed-chunk-34-1.png","b3-rvest-explorando-dados-financeiros-com-r_files/figure-html5/unnamed-chunk-35-1.png","b3-rvest-explorando-dados-financeiros-com-r_files/figure-html5/unnamed-chunk-36-1.png","b3-rvest-explorando-dados-financeiros-com-r_files/htmlwidgets-1.3/htmlwidgets.js","b3-rvest-explorando-dados-financeiros-com-r_files/jquery-1.11.3/jquery.min.js","b3-rvest-explorando-dados-financeiros-com-r_files/jquery-3.2.1/jquery-3.2.1.min.js","b3-rvest-explorando-dados-financeiros-com-r_files/jquery-3.2.1/jquery.3.1.1.slim.min.js","b3-rvest-explorando-dados-financeiros-com-r_files/webcomponents-2.0.0/webcomponents.js","dados_cache_b3_parciais.csv","empresas_b3_2019-03-31.csv","empresas_b3_2019-06-30.csv"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #455a64;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative;}
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

</style>

<link href="../../site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

d-article {
  padding-bottom: 30px;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for table of contents */

.d-toc {
  color: rgba(0,0,0,0.8);
  font-size: 0.8em;
  line-height: 1em;
}

.d-toc-header {
  font-size: 0.6rem;
  font-weight: 400;
  color: rgba(0, 0, 0, 0.5);
  text-transform: uppercase;
  margin-top: 0;
  margin-bottom: 1.3em;
}

.d-toc a {
  border-bottom: none;
}

.d-toc ul {
  padding-left: 0;
}

.d-toc li>ul {
  padding-top: 0.8em;
  padding-left: 16px;
  margin-bottom: 0.6em;
}

.d-toc ul,
.d-toc li {
  list-style-type: none;
}

.d-toc li {
  margin-bottom: 0.9em;
}

.d-toc-separator {
  margin-top: 20px;
  margin-bottom: 2em;
}

.d-article-with-toc {
  border-top: none;
  padding-top: 0;
}



/* Tweak code blocks (note that this CSS is repeated above in an injection
   into the d-code shadow dom) */

d-code {
  overflow-x: auto !important;
}

pre.d-code code.d-code {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

pre.text-output {

  font-size: 12px;
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

@media(min-width: 768px) {

d-code {
  overflow-x: visible !important;
}

pre.d-code code.d-code  {
    padding-left: 18px;
    font-size: 14px;
}
pre.text-output {
  font-size: 14px;
}
}

/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure img {
  width: 100%;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}



/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}


/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // create d-bibliography
  var bibliography = $('<d-bibliography></d-bibliography>');
  $('#distill-bibliography').wrap(bibliography);

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace citations with <d-cite>
  $('.citation').each(function(i, val) {
    appendix = true;
    var cites = $(this).attr('data-cites').split(" ");
    var dt_cite = $('<d-cite></d-cite>');
    dt_cite.attr('key', cites.join());
    $(this).replaceWith(dt_cite);
  });
  // remove refs
  $('#refs').remove();

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-toc a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // replace code blocks with d-code
  $('pre>code').each(function(i, val) {
    var code = $(this);
    var pre = code.parent();
    var clz = "";
    var language = pre.attr('class');
    if (language) {
      // map unknown languages to "clike" (without this they just dissapear)
      if ($.inArray(language, ["bash", "clike", "css", "go", "html",
                               "javascript", "js", "julia", "lua", "markdown",
                               "markup", "mathml", "python", "svg", "xml"]) == -1)
        language = "clike";
      language = ' language="' + language + '"';
      var dt_code = $('<d-code block' + language + clz + '></d-code>');
      dt_code.text(code.text());
      pre.replaceWith(dt_code);
    } else {
      code.addClass('text-output').unwrap().changeElementType('pre');
    }
  });

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('d-code, pre.text-output, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // table of contents
    if (have_authors) // adjust border if we are in authors
      $('.d-toc').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // inject pre code styles (can't do this with a global stylesheet b/c a shadow root is used)
    $('d-code').each(function(i, val) {
      var style = document.createElement('style');
      style.innerHTML = 'pre code { padding-left: 10px; font-size: 12px; border-left: 2px solid rgba(0,0,0,0.1); } ' +
                        '@media(min-width: 768px) { pre code { padding-left: 18px; font-size: 14px; } }';
      if (this.shadowRoot)
        this.shadowRoot.appendChild(style);
    });

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-toc-header').remove();
  $('.d-toc').remove();
  $('.d-toc-separator').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<!--/radix_placeholder_distill-->
  <script src="../../site_libs/htmlwidgets-1.3/htmlwidgets.js"></script>
  <script src="../../site_libs/jquery-3.2.1/jquery-3.2.1.min.js"></script>
  <script src="../../site_libs/d3plus-1.9.6/d3.min.js"></script>
  <script src="../../site_libs/d3plus-1.9.6/d3plus.min.js"></script>
  <script src="../../site_libs/d3plus-1.9.6/topojson.js"></script>
  <script src="../../site_libs/d3plus-binding-0.0.1/d3plus.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-75406624-1"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-75406624-1');
</script>
<style type="text/css">
d-article {
    font-weight: 300;
}

d-code {
    background: #f7f7f7;
}

pre.text-output {
    color: #d2a963;
    background: #2f2f2f;
    padding: 10px;
}

.distill-site-nav {
    background-color: #268bd2;
}

.distill-site-header .title {
    font-size: 20px;
    font-weight: bolder;
}

d-appendix {
    display: none !important;
}
</style>
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"B3 + rvest: Explorando dados financeiros com R - parte 1","description":"Primeiro de uma sequência de posts onde vamos utilizar o R para explorar dados financeiros disponíveis na internet. Aprofundaremos bastante em web scraping e manipulação de dados.","authors":[{"author":"Saulo Guerra","authorURL":"https://github.com/sauloguerra","affiliation":"&nbsp;","affiliationURL":"#"}],"publishedDate":"2019-08-27T00:00:00.000-03:00","citationText":"Guerra, 2019"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="../../index.html" class="title">Fulljoin</a>
</div>
<div class="nav-right">
<div class="nav-dropdown">
<button class="nav-dropbtn">
Labs!
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="../../dashboard_pnad.html">Dashboard PNAD contínua</a>
</div>
</div>
<a href="../../index.html">Posts</a>
<a href="../../about.html">Autores</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>B3 + rvest: Explorando dados financeiros com R - parte 1</h1>
<p>Primeiro de uma sequência de posts onde vamos utilizar o R para explorar dados financeiros disponíveis na internet. Aprofundaremos bastante em web scraping e manipulação de dados.</p>
</div>

<div class="d-byline">
  Saulo Guerra <a href="https://github.com/sauloguerra" class="uri">https://github.com/sauloguerra</a> 
  
<br/>08-27-2019
</div>

<div class="d-article">
<h2 id="disclaimer">DISCLAIMER</h2>
<p><strong>NADA</strong> aqui pode ser interpretado como sugestão de investimento, dica de mercado ou coisa do tipo, pelo contrário! O foco é totalmente em como extrair o dado e trabalhar com ele no R, todos os comentários sobre o assunto mercado financeiro serão simplesmente para contextualizar os dados.</p>
<h2 id="definindo-objetivo">Definindo objetivo</h2>
<p>Como objetivo a ser alcançado nesse post, gostaríamos de ter um panorama geral das empresas listadas na bolsa de valores brasileira, bem como seus setores, e entender um pouco mais sobre valores agregados desse cenário para tentar tirar alguns insights.</p>
<h2 id="achando-a-fonte-de-dados">Achando a fonte de dados</h2>
<p>Na busca por informações e fontes de estudos, me deparei com muitos sites legais e muito conteúdo. Porém, acho muito importante saber consultar dados diretamente na origem, na fonte. No Brasil, até onde eu saiba, só temos uma bolsa de valores e é a <strong>[B]³</strong> (antiga Bovespa + BM&amp;F + CETIP): <a href="http://www.b3.com.br" class="uri">http://www.b3.com.br</a>. São eles os responsáveis por coletar dados das empresas e divulgar ao público.</p>
<p>Encontrei o seguinte link onde são listadas todas as empresas da bolsa e algumas informações econômico-financeiras de cada uma. É aqui que será o nosso ponto de partida: <a href="http://www.b3.com.br/pt_br/produtos-e-servicos/negociacao/renda-variavel/empresas-listadas.htm" class="uri">http://www.b3.com.br/pt_br/produtos-e-servicos/negociacao/renda-variavel/empresas-listadas.htm</a></p>
<h2 id="web-scraping-ou-raspagem-dos-dados">Web scraping ou “raspagem dos dados”</h2>
<p>Infelizmente não encontrei uma base de dados pronta, csv, excel ou algo que concentre tudo em um lugar só. Mas isso não é necessariamente um problema, pois se está em um site HTML, então é possível extrair uma base de dados.</p>
<p>Temos um post que começa a explicar sobre <a href="$base_url">Web Scraping com R aqui</a>, antes de seguirmos é importante dar uma lida.</p>
<p>Para praticar um bom scraping é importante também entender bem sobre HTML, CSS e protocolo HTTP. Nesse post tentarei cobrir com mais detalhes o “raciocínio geral” para modelar um scraping. Como pré-requisito, deixo algumas leituras recomendadas:</p>
<ul>
<li><em>Curso-R</em> - <a href="http://material.curso-r.com/scrape/" class="uri">http://material.curso-r.com/scrape/</a></li>
<li><em>ScrapeHero</em> - <a href="https://www.scrapehero.com/a-beginners-guide-to-web-scraping-part-1-the-basics/" class="uri">https://www.scrapehero.com/a-beginners-guide-to-web-scraping-part-1-the-basics/</a></li>
<li><em>W3 (DOM)</em> - <a href="https://www.w3.org/TR/WD-DOM/introduction.html" class="uri">https://www.w3.org/TR/WD-DOM/introduction.html</a></li>
<li><em>Khan Academy</em> - <a href="https://pt.khanacademy.org/computing/computer-programming/html-css-js/js-and-the-dom/pt/the-dom-document-object-model" class="uri">https://pt.khanacademy.org/computing/computer-programming/html-css-js/js-and-the-dom/pt/the-dom-document-object-model</a></li>
</ul>
<p>Voltando a lista disponível no site da B3, a partir de uma lista inicial filtrada pela primeira letra da empresa, temos acesso a uma lista de empresas e, em cada link, algumas informações gerais de cada empresa. Vamos tentar explorar esses dados sem se aprofundar em detalhes de balanço, apenas dados gerais por enquanto.</p>
<figure>
<img src="../../images/b3_inicial.gif" alt="Listagem das empresas da bolsa" width="75" /><figcaption>Listagem das empresas da bolsa</figcaption>
</figure>
<p>Para uma extração generalizada, a sua rotina de scraping deve reproduzir de forma massiva o comportamento que você mesmo faria se estivesse clicando com o mouse: clicar na letra para listar as empresas, clicar na empresa específica, copiar as informações desejadas da página específica e colar em uma planilha. Reproduziremos esse comportamento no R. Comecemos carregando alguns pacotes</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
library(tidyverse)
library(rvest)
library(glue) # EXCELENTE pacote para colar variáveis a strings!
library(ggplot2)</code></pre>
</div>
<h2 id="identificando-links-e-urls">Identificando links e urls</h2>
<p>Uma das primeiras coisas antes de modelar o scraping é tentar entender as dinâmicas das chamadas, urls, clicks, etc.</p>
<p>A má notícia é que o site da B3 é meio bagunçado. Eles fazem uso intenso de <a href="https://pt.stackoverflow.com/.../por-que-o-uso-de-frames-e-iframes-é-considerado-um...">iframes</a>, que é uma antiga e péssima prática de construção de sites. Além disso, fazem um uso não padronizado de urls internas com diferentes domínios, que também é uma péssima prática. É como se estivessem tentando aproveitar sites antigos em uma “casca” nova. Isso dificulta bastante o trabalho de scraping, mas não é um obstáculo intransponível.</p>
<p>Ao clicar em uma letra ou empresa específica você vai reparar que a URL em seu browser não muda. Esse efeito acontece (dentre outras razões) pois eles estão usando um iframe, um espaço dentro da página que na verdade está carregando outra página.</p>
<p><em>Uma dica para identificar isso:</em> Abra a ferramenta de desenvolvedor do seu navegador (F12 ou Ctrl + Shift + I - ou Cmd + Opt + I no Mac) &gt; escolha a opção <strong>Network</strong> &gt; escolha a opção Doc</p>
<figure>
<img src="../../images/b3_inspecionar.gif" alt="Inspecionando o código de um site" /><figcaption>Inspecionando o código de um site</figcaption>
</figure>
<p>Em seguida, clique em uma letra. Repare que aparecerá um documento listado na área de network, é o resultado da sua chamada. Repare na “URL Real” onde a requisição foi feita: o domínio é <a href="http://bvmf.bmfbovespa.com.br/" class="uri">http://bvmf.bmfbovespa.com.br/</a> e não <a href="http://www.b3.com.br" class="uri">http://www.b3.com.br</a> como aparece no seu navegador.</p>
<figure>
<img src="../../images/b3_inspecionar2.gif" alt="Inspecionando o código de um site" /><figcaption>Inspecionando o código de um site</figcaption>
</figure>
<p>A página <a href="http://www.b3.com.br/pt_br/produtos-e-servicos/negociacao/renda-variavel/empresas-listadas.htm" class="uri">http://www.b3.com.br/pt_br/produtos-e-servicos/negociacao/renda-variavel/empresas-listadas.htm</a> está “mascarando”, por meio de um iframe, a verdadeira página que iremos fazer scraping. Com a ajuda da ferramenta de desenvolvedor (Chrome ou Firefox) você consegue identificar que a verdadeira página que está sendo exibida e respondendo a requisição é: <a href="http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx" class="uri">http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx</a></p>
<p>Agora que identificamos a página verdadeira, vamos pensar na lógica e no fluxo do scraping:</p>
<p>Vou clicar em cada uma das letras para ver a lista de empresas que começam com aquela letra, em seguida vou clicar em cada empresa e coletar cada uma das informações necessárias. Repito isso para cada letra, para cada empresa e cada informação que desejo coletar. Seria absurdamente trabalhoso fazer isso manualmente.</p>
<p>Vamos começar a preparar a base do nosso scraping:</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
base.url &lt;- &#39;http://bvmf.bmfbovespa.com.br/&#39; #URL BASE
base.lista.empresas &lt;- glue(&#39;{base.url}cias-listadas/empresas-listadas/&#39;)
letras &lt;- c(LETTERS, 0:9) #criando vetor de LETRAS e números de 0 a 9

for (i in letras) { #percorrendo meu vetor de LETRAS e números
  listagem &lt;- glue(&#39;{base.lista.empresas}BuscaEmpresaListada.aspx?Letra={i}&amp;idioma=pt-br&#39;)
  #para cada letra, colei junto da URL e gerei um link completo
  print(listagem)
}</code></pre>
<pre><code>
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?Letra=A&amp;idioma=pt-br
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?Letra=B&amp;idioma=pt-br
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?Letra=C&amp;idioma=pt-br
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?Letra=D&amp;idioma=pt-br
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?Letra=E&amp;idioma=pt-br
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?Letra=F&amp;idioma=pt-br
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?Letra=G&amp;idioma=pt-br
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?Letra=H&amp;idioma=pt-br
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?Letra=I&amp;idioma=pt-br
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?Letra=J&amp;idioma=pt-br
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?Letra=K&amp;idioma=pt-br
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?Letra=L&amp;idioma=pt-br
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?Letra=M&amp;idioma=pt-br
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?Letra=N&amp;idioma=pt-br
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?Letra=O&amp;idioma=pt-br
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?Letra=P&amp;idioma=pt-br
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?Letra=Q&amp;idioma=pt-br
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?Letra=R&amp;idioma=pt-br
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?Letra=S&amp;idioma=pt-br
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?Letra=T&amp;idioma=pt-br
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?Letra=U&amp;idioma=pt-br
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?Letra=V&amp;idioma=pt-br
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?Letra=W&amp;idioma=pt-br
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?Letra=X&amp;idioma=pt-br
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?Letra=Y&amp;idioma=pt-br
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?Letra=Z&amp;idioma=pt-br
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?Letra=0&amp;idioma=pt-br
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?Letra=1&amp;idioma=pt-br
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?Letra=2&amp;idioma=pt-br
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?Letra=3&amp;idioma=pt-br
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?Letra=4&amp;idioma=pt-br
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?Letra=5&amp;idioma=pt-br
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?Letra=6&amp;idioma=pt-br
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?Letra=7&amp;idioma=pt-br
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?Letra=8&amp;idioma=pt-br
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?Letra=9&amp;idioma=pt-br</code></pre>
</div>
<p>Com a ajuda de um loop e do pacote glue, é possível criar um link para cada letra, que é justamente cada página que vamos precisar visitar, letra a letra, para em seguida “clicar” em cada empresa. Com o <em>glue</em> você “cola” uma variável em uma string utilizando as chaves assim <code>{sua_variavel}</code>. O pacote glue é bem legal, vale a pena aprender a usar, é bem simples e ajuda bastante (eu prefiro o <em>glue</em> ao clássico <em>paste</em>). Sugiro uma rápida leitura em <a href="https://glue.tidyverse.org/" class="uri">https://glue.tidyverse.org/</a></p>
<h2 id="identificando-as-estruturas-de-html">identificando as estruturas de HTML</h2>
<p>Ao clicar em uma letra recebemos uma lista de empresas. Agora precisamos pegar o link de cada empresa e preparar uma lista maior ainda, não mais de letras e sim das empresas em si.</p>
<p>Há uma estrutura padrão para links em html. O que temos que fazer é descobrir essa estrutura em nossa página e verificar se está padronizada. Nesse caso específico, o nome de cada empresa está estruturado em uma tabela e felizmente o link está disponível na estrutura padrão de links do HTML.</p>
<p>Abra novamente a ferramenta de desenvolvedor do Chorme (ou Firefox), clique na pequena seta que fica na ponta esquerda superior da ferramenta (seletor de elementos) e em seguida passe o mouse em cima do nome de uma empresa. Observe a ferramenta de desenvolvedor na aba <em>Elements</em>. Cada lugar que você passa o mouse a ferramenta te mostra a estrutura daquele ponto em HTML.</p>
<figure>
<img src="../../images/ferramenta_dev_chrome.png" alt="Seletor de elementos" /><figcaption>Seletor de elementos</figcaption>
</figure>
<p>Você pode passar o mouse nas estruturas em HTML apresentadas na ferramenta e observar a lista de empresas com uma parte escura mosrando o equivalente do HTML. Tente se familiarizar com essa dinâmica, é fundamental para criar bons scrapings. Esse artifício nos permitirá identificar as estruturas que buscamos.</p>
<figure>
<img src="../../images/b3_element_selector.gif" alt="Inspecionando elementos" /><figcaption>Inspecionando elementos</figcaption>
</figure>
<p>O que queremos? O link de cada empresa. A estrutura que procuramos é a seguinte:</p>
<figure>
<img src="../../images/b3_linha_tabela.png" alt="HTML de linha da tabela" /><figcaption>HTML de linha da tabela</figcaption>
</figure>
<p>Repare nas tags HTML: <code>&lt;tr&gt;...&lt;/tr&gt;</code> estrutura uma linha de uma tabela, <code>&lt;td&gt;...&lt;/td&gt;</code> define uma célula em uma linha, e <code>&lt;a&gt;...&lt;a&gt;</code> define um link. Repare que nossa tabela com uma lista de empresas tem 3 colunas, ou seja, 3 células. Então precisamos observar 3 sequências <code>&lt;td&gt;...&lt;/td&gt;</code>, estruturando o equivalente a 3 colunas: Razão Social, Nome de Pregão e Segmento. Mas no momento não quero nenhuma dessas informações, quero apenas o link de cada empresa que vai me levar a página onde contem informações gerais da empresa. Repare que essa informação está no atributo <code>href</code> da tag <code>&lt;a href=&quot;...&quot;&gt; ... &lt;/a&gt;</code> que especifica o destino de um link.</p>
<p>No fim das contas o que queremos agora é o conteúdo do atributo href. Vamos obter da seguinte forma (exemplificando com as empresas listadas na letra E):</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
i &lt;- &#39;E&#39;
links &lt;- glue(&#39;{base.lista.empresas}BuscaEmpresaListada.aspx?Letra={i}&amp;idioma=pt-br&#39;)%&gt;% 
  read_html() %&gt;% 
  html_nodes(&#39;td a&#39;) %&gt;% 
  html_attr(&#39;href&#39;) %&gt;% 
  unique()

glue(&#39;{base.lista.empresas}{links}&#39;)</code></pre>
<pre><code>
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=21741
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=21903
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=19453
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=19763
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=15342
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=16985
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=5380
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=4359
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=17485
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=15784
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=16209
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=14176
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=16993
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=20087
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=19011
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=16497
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=22365
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=5576
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=14605
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=15253
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=21237
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=17329
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=20010
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=21016
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=5762
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=5770
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=20524
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=1570
http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=20770</code></pre>
</div>
<p>Basicamente lemos o HTML de uma página com o <code>read_html()</code>, pegamos os “nós” com <code>html_nodes()</code>, ou seja, as tags na hierarquia seguidas por <code>&lt;td&gt;&lt;a&gt;...&lt;/a&gt;&lt;/td&gt;</code> e do resultado obtivemos o conteúdo do atributo <code>href</code> com <code>html_httr()</code>. Como aparecem 2 links em cada tabela (duas colunas: em Razão Social e Nome de Pregão) e os links são os mesmos, ao final usamos <code>unique</code> para garantir que teremos apenas um link de cada linha da tabela.</p>
<p>É possível obter o mesmo resultado com diferentes seleções de elementos HTML, é quase uma escolha pessoal baseada na interpretação da estrutura da página e na criatividade.</p>
<p>Juntando a nossa varredura por cada letra e nossa varredura por cada linha da página pegando o link de cada empresa, teremos o seguinte:</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
links.empresas &lt;- c()
for (i in letras) {
  listagem &lt;- glue(&#39;{base.lista.empresas}BuscaEmpresaListada.aspx?Letra={i}&amp;idioma=pt-br&#39;)
  
  links &lt;- listagem %&gt;% 
    read_html() %&gt;% 
    html_nodes(&#39;td a&#39;) %&gt;% 
    html_attr(&#39;href&#39;) %&gt;% 
    unique()
  
  links.empresas &lt;- c(links.empresas, glue(&#39;{base.lista.empresas}{links}&#39;))
}

# amostra
links.empresas[1:3] #primeiros links</code></pre>
<pre><code>
[1] &quot;http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=21725&quot;
[2] &quot;http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=18970&quot;
[3] &quot;http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=22179&quot;</code></pre>
<pre class="r"><code>
links.empresas[231:233] #links do meio</code></pre>
<pre><code>
[1] &quot;http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=11932&quot;
[2] &quot;http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=24180&quot;
[3] &quot;http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=19364&quot;</code></pre>
<pre class="r"><code>
links.empresas[(length(links.empresas)-2):length(links.empresas)] #ultimos links</code></pre>
<pre><code>
[1] &quot;http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=23590&quot;
[2] &quot;http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=11070&quot;
[3] &quot;http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=16284&quot;</code></pre>
</div>
<h2 id="coletando-a-informacao-alvo-e-juntando-tudo">Coletando a informação alvo e juntando tudo</h2>
<p>Tendo o link de cada página de empresa listada, bastaria entrar um a um e coletar a informação desejada e, ao final, juntar tudo em um dataframe.</p>
<p>Nesse modelo de coleta talvez seja interessante testar para alguns alvos aleatórios para ver se o padrão de coleta persiste e depois executar o scraping massivavamente observando se haverá algum erro no processo. Infelizmente o site da B3 apresenta alguns detalhes não padronizados, o que dificulta um pouco o processo. Veremos a seguir.</p>
<p>Primeiro escolhemos uma empresa qualquer:</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
(link &lt;- links.empresas[178])</code></pre>
<pre><code>
[1] &quot;http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=22365&quot;</code></pre>
</div>
<p>Pegamos o conteúdo da página. Por aqui tive problema de enconding (caracteres desformatados), então precisei especificar o <em>Latin1</em> como enconding de leitura. Mas isso pode variar conforme o ambiente.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
conteudo &lt;- link %&gt;% 
    read_html(encoding = &#39;Latin1&#39;)

conteudo</code></pre>
<pre><code>
{html_document}
&lt;html class=&quot;no-js&quot; lang=&quot;pt-br&quot;&gt;
[1] &lt;head id=&quot;ctl00_Head1&quot;&gt;\n&lt;meta http-equiv=&quot;Content-Type&quot; conten ...
[2] &lt;body id=&quot;ctl00_bovespa&quot;&gt;\r\n&lt;!-- Google Tag Manager --&gt;\r\n&lt;no ...
[3] &lt;script type=&quot;text/javascript&quot;&gt;iframe_resize();&lt;/script&gt;</code></pre>
</div>
<p>Queremos o nome da empresa. Com a ajuda do seletor de elementos, facilmente descobrimos o trecho HTML do alvo.</p>
<p><img src="../../images/b3_nome_empresa.png" alt="HTML do nome da empresa" /> Podemos selecionar pelo <em>id</em> ou pela tag.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
nome.empresa &lt;- conteudo %&gt;% 
  html_nodes(&#39;#ctl00_contentPlaceHolderConteudo_MenuEmpresasListadas1_lblNomeEmpresa&#39;) %&gt;% 
  html_text()

nome.empresa</code></pre>
<pre><code>
[1] &quot;ENAUTA PARTICIPAÇÕES S.A.&quot;</code></pre>
<pre class="r"><code>
nome.empresa.tag &lt;- conteudo %&gt;% 
  html_nodes(&#39;h2&#39;) %&gt;% #Opção menos precisa... Será que vai funcionar para todas as páginas?
  html_text()

nome.empresa == nome.empresa.tag</code></pre>
<pre><code>
[1] TRUE</code></pre>
</div>
<p>Sempre que possível opte por estratégias menos ambíguas e mais precisas. Escolher pelo <em>id</em> de um elemento é certamente mais preciso do que escolher pelo seu tipo de tag. Quando você especifica o padrão do elemento que você quer selecionar em <code>html_nodes()</code> você pode especificar diretamente o tipo de elemento ou o <em>id</em> com <code>#</code> antes, ou então a classe com <code>.</code> antes do nome da classe.</p>
<p>Ao tentar buscar o resto do conteúdo alvo, nos deparamos com mais uma dificuldade: OUTRO IFRAME! Explorando o seletor pela página em busca do resto dos elementos você até vai encontrar os elementos desejados, mas não vai conseguir fazer o <em>rvest</em> buscar diretamente pois o conteúdo na verdade foi carregado de OUTRA página. Talvez exista alguma forma mais simples de lidar com isso, mas ainda não descobri (se souber, nos avise nos comentários!).</p>
<p>Não bastasse 1, estão usando 2 iframes na página. O primeiro é pra alguma coisa de google, o seguindo é o que queremos:</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
conteudo %&gt;% #a partir do conteúdo da página
  html_nodes(&#39;iframe&#39;)</code></pre>
<pre><code>
{xml_nodeset (2)}
[1] &lt;iframe src=&quot;//www.googletagmanager.com/ns.html?id=GTM-KPF8G3&quot;  ...
[2] &lt;iframe id=&quot;ctl00_contentPlaceHolderConteudo_iframeCarregadorPa ...</code></pre>
</div>
<p>No atributo <em>src</em> vamos buscar o endereçamento da página para pegar o conteúdo diretamente de lá. Estão usando <a href="https://pt.stackoverflow.com/questions/2315/diferen%C3%A7a-entre-urls-absolutos-e-relativos-nos-conte%C3%BAdos-da-p%C3%A1gina">endereçamento relativo</a>. Vamos transformar para absoluto e fazer nossa própria chamada:</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
conteudo %&gt;% #a partir do conteúdo da página
  html_nodes(&#39;iframe&#39;) %&gt;% #seleciona a tag iframe
  .[2] %&gt;% #não bastasse 1, são 2 iframes na página, queremos apenas o seguindo
  html_attr(&#39;src&#39;)</code></pre>
<pre><code>
[1] &quot;../../pt-br/mercados/acoes/empresas/ExecutaAcaoConsultaInfoEmp.asp?CodCVM=22365&amp;ViewDoc=1&amp;AnoDoc=2019&amp;VersaoDoc=3&amp;NumSeqDoc=83916#a&quot;</code></pre>
</div>
<p>Substituindo o <em>../../</em> típico de endereçamentos relativos e colocando com nosso <code>base.url</code> para fabricar o link real:</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
conteudo %&gt;% #a partir do conteúdo da página
  html_nodes(&#39;iframe&#39;) %&gt;% #seleciona a tag iframe
  .[2] %&gt;% #não bastasse 1, são 2 iframes na página, queremos apenas o seguindo
  html_attr(&#39;src&#39;) %&gt;% # o atributo src contém a página que foi inserida no iframe
  str_replace_all(., &#39;../../&#39;, &#39;&#39;) %&gt;% #substituimos o endereçamento relativo
  paste0(base.url, .) </code></pre>
<pre><code>
[1] &quot;http://bvmf.bmfbovespa.com.br/pt-br/mercados/acoes/empresas/ExecutaAcaoConsultaInfoEmp.asp?CodCVM=22365&amp;ViewDoc=1&amp;AnoDoc=2019&amp;VersaoDoc=3&amp;NumSeqDoc=83916#a&quot;</code></pre>
</div>
<p>Finalmente agora conseguimos buscar todo o conteúdo da página que está sendo renderizada dentro do iframe:</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
conteudo.iframe &lt;- conteudo %&gt;% #a partir do conteúdo da página
  html_nodes(&#39;iframe&#39;) %&gt;% #seleciona a tag iframe
  .[2] %&gt;% #não bastasse 1, são 2 iframes na página, queremos apenas o seguindo
  html_attr(&#39;src&#39;) %&gt;% # o atributo src contém a página que foi inserida no iframe
  str_replace_all(., &#39;../../&#39;, &#39;&#39;) %&gt;% #substituimos o endereçamento relativo
  paste0(base.url, .) %&gt;% #colamos com base.url para criar endereçamento absoluto
  read_html() #finalmente pegamos o conteúdo do iframe!

conteudo.iframe</code></pre>
<pre><code>
{html_document}
&lt;html class=&quot;no-js&quot; lang=&quot;pt-br&quot;&gt;
[1] &lt;head&gt;\n&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; cha ...
[2] &lt;body onload=&quot;parent.resizeFrame(parent.document.getElementById ...</code></pre>
</div>
<p><em>Obs: se essa parte não ficou muito clara, por favor avise no comentário para eu tentar explicar mais detalhadamente!</em></p>
<p>Com o conteúdo do iframe vamos coletar de fato o que precisamos. Vamos escolher algumas informações para alcançarmos nosso objetivo inicial. Que tal o seguinte:</p>
<ul>
<li>Classificação Setorial</li>
<li>Patrimônio Líquido</li>
<li>Lucro (Prejuízo) do Período</li>
<li>Atividades Operacionais</li>
<li>Total de Ações.</li>
</ul>
<p>Vamos considerar apenas as informações reportadas no último período disponível.</p>
<p>Obteremos os setores da seguinte forma:</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
setores &lt;- conteudo.iframe %&gt;% 
    html_nodes(xpath=&quot;//td[contains(., &#39;Classificação Setorial:&#39;)]/following-sibling::td[1]&quot;) %&gt;% 
    html_text()

setores</code></pre>
<pre><code>
[1] &quot;Petróleo. Gás e Biocombustíveis / Petróleo. Gás e Biocombustíveis / Exploração. Refino e Distribuição&quot;</code></pre>
</div>
<p>Repare que mudei o formato de parâmetro padrão em <code>html_nodes(xpath='...')</code>. O padrão é <code>html_nodes(css='...')</code>. Há basicamente duas formas de selecionar os elementos HTML: <a href="https://www.w3schools.com/cssref/css_selectors.asp">css selectors</a> e <a href="https://www.w3schools.com/xml/xpath_syntax.asp">xpath</a>. Ambos formatos são razoavelmente complexos e leva tempo (experiência) para dominar bem seu uso.</p>
<p>Traduzindo o que está escrito em <code>//td[contains(., 'Classificação Setorial:')]/following-sibling::td[1]</code>: selecione a primeira tag <code>td</code> que aparece logo em seguida de outra tag <code>td</code> que tenha em seu conteúdo o texto <code>Classificação Setorial:</code>. Ou seja, selecionamos o irmão subsequente da célula que tem o texto <code>Classificação Setorial</code>. Para entender melhor sobre as funções hierárquicas do padrão xpath sugiro a seguinte leitura: <a href="https://www.w3schools.com/xml/xpath_axes.asp" class="uri">https://www.w3schools.com/xml/xpath_axes.asp</a></p>
<p>Lembrando sempre que daria pra extrair essa mesma informação com outro padrão de busca. Vai da sua experiência e estilo de trabalho!</p>
<p>Obtemos o patrimônio líquido da seguinte forma:</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
patrimonio.liquido &lt;- conteudo.iframe %&gt;% 
    html_node(xpath=&quot;.//td[contains(., &#39;nio Líquido&#39;)]/following-sibling::td[1]&quot;) %&gt;%
    html_text()

patrimonio.liquido</code></pre>
<pre><code>
[1] &quot;2.744.900&quot;</code></pre>
</div>
<p>No exemplo acima, peguei com o texto truncado <code>nio Líquido</code> pois o site da B3 te uma bela pegadinha: ora escreve patrimônio com acento circunflexo e ora escreve errado com acento agudo <code>Património Líquido</code>. Com o texto truncado eu cubro as duas possibilidades.</p>
<p>Obtemos o lucro líquido da seguinte forma:</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
lucro.liquido &lt;- conteudo.iframe %&gt;% 
    html_node(xpath=&quot;.//td[contains(., &#39;Lucro (Prejuízo) do Período&#39;)]/following-sibling::td[1]&quot;) %&gt;%
    html_text()

lucro.liquido</code></pre>
<pre><code>
[1] &quot;71.380&quot;</code></pre>
</div>
<p>Obtemos o valor de atividades operacionais da seguinte forma:</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
atividades.operacionais &lt;- conteudo.iframe %&gt;% 
    html_node(xpath=&quot;.//td[contains(., &#39;Atividades Operacionais&#39;)]/following-sibling::td[1]&quot;) %&gt;%
    html_text()

atividades.operacionais</code></pre>
<pre><code>
[1] &quot;266.320&quot;</code></pre>
</div>
<p>E o total de ação pegamos da seguinte forma:</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
total.acoes &lt;- conteudo.iframe %&gt;% 
    html_node(xpath=&quot;.//td[contains(., &#39;Total de Ações&#39;)]/following-sibling::td[1]&quot;) %&gt;%
    html_text()

total.acoes</code></pre>
<pre><code>
[1] &quot;75.621.071&quot;</code></pre>
</div>
<p>Depois de alguns testes par diferentes links notamos mais uma pegadinha: alguns valores estão em múltiplos de MIL e outros em unidade. Para colocar todos no mesmo padrão vamos criar uma flag apontando qual é múltiplo de mil. O texto está na tag <code>h3</code> dentro da <code>div</code> com <em>id</em> <code>divDadosEconomicoFinanceiros</code>. Faremos uma limpada no texto e verificamos se ele acaba em <code>mil</code>. Se sim, é porque os números são múltiplos de mil.</p>
<figure>
<img src="../../images/b3_mil.png" alt="Indicador se é múltiplo de mil" /><figcaption>Indicador se é múltiplo de mil</figcaption>
</figure>
<p>Capturamos todo o texto <code>Dados Econômico-Financeiros - R$ - mil</code> e, depois de uma limpada, verificamos se termina com a string <code>mil</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
mil &lt;- conteudo.iframe %&gt;% 
    html_nodes(&#39;#divDadosEconomicoFinanceiros h3&#39;) %&gt;% 
    .[1] %&gt;% 
    html_text() %&gt;% 
    str_replace_all(&#39;\\r|\\n&#39;, &#39;&#39;) %&gt;% 
    trimws() %&gt;% 
    endsWith(&#39;mil&#39;)</code></pre>
</div>
<p>Para facilitar, faremos uma funçao com cada parte juntando tudo em um dataframe:</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
extrai_informacoes &lt;- function(link) {
  conteudo &lt;- link %&gt;% 
    read_html(encoding = &#39;Latin1&#39;)
  
  nome.empresa &lt;- conteudo %&gt;% 
    html_nodes(&#39;#ctl00_contentPlaceHolderConteudo_MenuEmpresasListadas1_lblNomeEmpresa&#39;) %&gt;% 
    html_text()
  
  conteudo.iframe &lt;- conteudo %&gt;% #a partir do conteúdo da página
    html_nodes(&#39;iframe&#39;) %&gt;% #seleciona a tag iframe
    .[2] %&gt;% #não bastasse 1, são 2 iframes na página, queremos apenas o seguindo
    html_attr(&#39;src&#39;) %&gt;% # o atributo src contém a página que foi inserida no iframe
    str_replace_all(., &#39;../../&#39;, &#39;&#39;) %&gt;% #substituimos o endereçamento relativo
    paste0(base.url, .) %&gt;% #colamos com base.url para criar endereçamento absoluto
    read_html() #finalmente pegamos o conteúdo do iframe!

  setores &lt;- conteudo.iframe %&gt;% 
    html_nodes(xpath=&quot;//td[contains(., &#39;Classificação Setorial:&#39;)]/following-sibling::td[1]&quot;) %&gt;% 
    html_text()

  patrimonio.liquido &lt;- conteudo.iframe %&gt;% 
    html_node(xpath=&quot;.//td[contains(., &#39;nio Líquido&#39;)]/following-sibling::td[1]&quot;) %&gt;%
    html_text()
  
  lucro.liquido &lt;- conteudo.iframe %&gt;% 
    html_node(xpath=&quot;.//td[contains(., &#39;Lucro (Prejuízo) do Período&#39;)]/following-sibling::td[1]&quot;) %&gt;%
    html_text()
  
  atividades.operacionais &lt;- conteudo.iframe %&gt;% 
    html_node(xpath=&quot;.//td[contains(., &#39;Atividades Operacionais&#39;)]/following-sibling::td[1]&quot;) %&gt;%
    html_text()
  
  total.acoes &lt;- conteudo.iframe %&gt;% 
    html_node(xpath=&quot;.//td[contains(., &#39;Total de Ações&#39;)]/following-sibling::td[1]&quot;) %&gt;%
    html_text()
  
  mil &lt;- conteudo.iframe %&gt;% 
    html_nodes(&#39;#divDadosEconomicoFinanceiros h3&#39;) %&gt;% 
    .[1] %&gt;% 
    html_text() %&gt;% 
    str_replace_all(&#39;\\r|\\n&#39;, &#39;&#39;) %&gt;% 
    trimws() %&gt;% 
    endsWith(&#39;mil&#39;)  
 
  resultado &lt;- data.frame(
    nome.empresa, setores, 
    patrimonio.liquido, lucro.liquido,
    atividades.operacionais, total.acoes, mil,
      stringsAsFactors = FALSE) 
  
  return(resultado)
}</code></pre>
</div>
<p>Vejamos o teste da nossa função para mais alguns casos:</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
extrai_informacoes(links.empresas[273])</code></pre>
<pre><code>
              nome.empresa
1 METALGRAFICA IGUACU S.A.
                                      setores patrimonio.liquido
1 Materiais Básicos / Embalagens / Embalagens         19.822.010
  lucro.liquido atividades.operacionais total.acoes   mil
1   (4.735.399)               3.885.208      43.163 FALSE</code></pre>
<pre class="r"><code>
extrai_informacoes(links.empresas[388])</code></pre>
<pre><code>
                      nome.empresa
1 TERMELÉTRICA PERNAMBUCO III S.A.
                                                  setores
1 Utilidade Pública / Energia Elétrica / Energia Elétrica
  patrimonio.liquido lucro.liquido atividades.operacionais
1          (238.471)      (19.887)                   8.034
  total.acoes  mil
1           0 TRUE</code></pre>
<pre class="r"><code>
extrai_informacoes(links.empresas[132])</code></pre>
<pre><code>
                                       nome.empresa
1 CONC ROD AYRTON SENNA E CARV PINTO S.A.-ECOPISTAS
                                                 setores
1 Bens Industriais / Transporte / Exploração de Rodovias
  patrimonio.liquido lucro.liquido atividades.operacionais
1            580.960         5.255                  94.187
  total.acoes  mil
1           0 TRUE</code></pre>
</div>
<p>Agora podemos executar nossa função para todos os links (deve demorar de 5 a 10 minutos pois são diversas chamadas, uma para cada empresa):</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
dados &lt;- data_frame()

for(i in links.empresas) {
  parcial &lt;- extrai_informacoes(i)
  dados &lt;- bind_rows(dados, parcial)
}</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<p>Precisamos ter o tanto de linhas igual ao tanto de links que capturamos:</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
nrow(dados) == length(links.empresas)</code></pre>
<pre><code>
[1] TRUE</code></pre>
</div>
<p>Rápida olhada na estrutura do dataframe final</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
head(dados)</code></pre>
<pre><code>
# A tibble: 6 x 7
  nome.empresa setores patrimonio.liqu… lucro.liquido atividades.oper…
  &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;            &lt;chr&gt;         &lt;chr&gt;           
1 ADVANCED DI… Saúde … (17.283)         (2.699)       0               
2 AES TIETE E… Utilid… 1.466.649        97.452        344.262         
3 AFLUENTE TR… Utilid… 208.222          12.468        13.243          
4 ALEF S.A.    Outros… 114.009          (103.674)     (102.944)       
5 ALFA HOLDIN… Financ… 975.533          17.400        (1.146)         
6 ALGAR TELEC… Teleco… 1.626.672        219.879       427.710         
# … with 2 more variables: total.acoes &lt;chr&gt;, mil &lt;lgl&gt;</code></pre>
<pre class="r"><code>
tail(dados)</code></pre>
<pre><code>
# A tibble: 6 x 7
  nome.empresa setores patrimonio.liqu… lucro.liquido atividades.oper…
  &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;            &lt;chr&gt;         &lt;chr&gt;           
1 WETZEL S.A.  Bens I… (190.336)        (19.532)      (1.655)         
2 WHIRLPOOL S… Consum… 2.551.517        536.254       126.850         
3 WILSON SONS… Bens I… 1.890.969        47.123        200.518         
4 WIZ SOLUÇÕE… Financ… 194.894          110.655       128.358         
5 WLM PART. E… Bens I… 400.923          15.083        16.092          
6 524 PARTICI… Outros… 88               (104)         (100)           
# … with 2 more variables: total.acoes &lt;chr&gt;, mil &lt;lgl&gt;</code></pre>
<pre class="r"><code>
glimpse(dados)</code></pre>
<pre><code>
Observations: 421
Variables: 7
$ nome.empresa            &lt;chr&gt; &quot;ADVANCED DIGITAL HEALTH MEDICINA P…
$ setores                 &lt;chr&gt; &quot;Saúde / Serv.Méd.Hospit..Análises …
$ patrimonio.liquido      &lt;chr&gt; &quot;(17.283)&quot;, &quot;1.466.649&quot;, &quot;208.222&quot;,…
$ lucro.liquido           &lt;chr&gt; &quot;(2.699)&quot;, &quot;97.452&quot;, &quot;12.468&quot;, &quot;(10…
$ atividades.operacionais &lt;chr&gt; &quot;0&quot;, &quot;344.262&quot;, &quot;13.243&quot;, &quot;(102.944…
$ total.acoes             &lt;chr&gt; &quot;1.724.272&quot;, &quot;1.489.623.772&quot;, &quot;862.…
$ mil                     &lt;lgl&gt; TRUE, TRUE, TRUE, FALSE, TRUE, TRUE…</code></pre>
</div>
<p>Vamos manipular um pouco para deixar o dataframe perfeito e em seguida trabalhar alguns gráficos. Primeiro vamos separar os setores. Cada empresa tem 3 classificações: Setores, Subsetores e Segmento, sendo o último o nível mais detalhado da classificação.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
dados &lt;- dados %&gt;% 
  separate(setores, c(&quot;setor&quot;, &quot;subsetor&quot;, &quot;segmento&quot;), sep = &#39;/&#39;) %&gt;%
  mutate_at(.vars = vars(starts_with(&#39;setor&#39;)), .funs = ~trimws(.))

unique(dados$setor)</code></pre>
<pre><code>
 [1] &quot;Saúde&quot;                          
 [2] &quot;Utilidade Pública&quot;              
 [3] &quot;Outros&quot;                         
 [4] &quot;Financeiro&quot;                     
 [5] &quot;Telecomunicações&quot;               
 [6] &quot;Consumo Cíclico&quot;                
 [7] &quot;Consumo não Cíclico&quot;            
 [8] &quot;Bens Industriais&quot;               
 [9] &quot;Materiais Básicos&quot;              
[10] &quot;Tecnologia da Informação&quot;       
[11] &quot;Petróleo. Gás e Biocombustíveis&quot;
[12] &quot;Não Classificados&quot;              </code></pre>
<pre class="r"><code>
unique(dados$subsetor)</code></pre>
<pre><code>
 [1] &quot; Serv.Méd.Hospit..Análises e Diagnósticos &quot;
 [2] &quot; Energia Elétrica &quot;                        
 [3] &quot; Outros &quot;                                  
 [4] &quot; Intermediários Financeiros &quot;              
 [5] &quot; Telecomunicações &quot;                        
 [6] &quot; Exploração de Imóveis &quot;                   
 [7] &quot; Tecidos. Vestuário e Calçados &quot;           
 [8] &quot; Previdência e Seguros &quot;                   
 [9] &quot; Securitizadoras de Recebíveis &quot;           
[10] &quot; Bebidas &quot;                                 
[11] &quot; Holdings Diversificadas &quot;                 
[12] &quot; Diversos &quot;                                
[13] &quot; Comércio &quot;                                
[14] &quot; Comércio e Distribuição &quot;                 
[15] &quot; Construção e Engenharia &quot;                 
[16] &quot; Transporte &quot;                              
[17] &quot; Serviços Financeiros Diversos &quot;           
[18] &quot; Máquinas e Equipamentos &quot;                 
[19] &quot; Equipamentos &quot;                            
[20] &quot; Serviços &quot;                                
[21] &quot; Viagens e Lazer &quot;                         
[22] &quot; Medicamentos e Outros Produtos &quot;          
[23] &quot; Alimentos Processados &quot;                   
[24] &quot; Hoteis e Restaurantes &quot;                   
[25] &quot; Produtos de Uso Pessoal e de Limpeza &quot;    
[26] &quot; Mineração &quot;                               
[27] &quot; Agropecuária &quot;                            
[28] &quot; Químicos &quot;                                
[29] &quot; Programas e Serviços &quot;                    
[30] &quot; Madeira e Papel &quot;                         
[31] &quot; água e Saneamento &quot;                       
[32] &quot; Gás &quot;                                     
[33] &quot; Siderurgia e Metalurgia &quot;                 
[34] &quot; Mídia &quot;                                   
[35] &quot; Construção Civil &quot;                        
[36] &quot; Petróleo. Gás e Biocombustíveis &quot;         
[37] &quot; Não Classificado &quot;                        
[38] &quot; Material de Transporte &quot;                  
[39] &quot; Utilidades Domésticas &quot;                   
[40] &quot; Automóveis e Motocicletas &quot;               
[41] &quot; Embalagens &quot;                              
[42] &quot; Computadores e Equipamentos &quot;             
[43] &quot; Materiais Diversos &quot;                      </code></pre>
<pre class="r"><code>
unique(dados$segmento)</code></pre>
<pre><code>
 [1] &quot; Serv.Méd.Hospit..Análises e Diagnósticos&quot;
 [2] &quot; Energia Elétrica&quot;                        
 [3] &quot; Outros&quot;                                  
 [4] &quot; Bancos&quot;                                  
 [5] &quot; Telecomunicações&quot;                        
 [6] &quot; Exploração de Imóveis&quot;                   
 [7] &quot; Calçados&quot;                                
 [8] &quot; Corretoras de Seguros&quot;                   
 [9] &quot; Securitizadoras de Recebíveis&quot;           
[10] &quot; Cervejas e Refrigerantes&quot;                
[11] &quot; Holdings Diversificadas&quot;                 
[12] &quot; Serviços Educacionais&quot;                   
[13] &quot; Tecidos. Vestuário e Calçados&quot;           
[14] &quot; Alimentos&quot;                               
[15] &quot; Construção Pesada&quot;                       
[16] &quot; Transporte Aéreo&quot;                        
[17] &quot; Produtos Diversos&quot;                       
[18] &quot; Serviços Financeiros Diversos&quot;           
[19] &quot; Máq. e Equip. Industriais&quot;               
[20] &quot; Equipamentos&quot;                            
[21] &quot; Seguradoras&quot;                             
[22] &quot; Serviços Diversos&quot;                       
[23] &quot; Bicicletas&quot;                              
[24] &quot; Medicamentos e Outros Produtos&quot;          
[25] &quot; Açucar e Alcool&quot;                         
[26] &quot; Restaurante e Similares&quot;                 
[27] &quot; Gestão de Recursos e Investimentos&quot;      
[28] &quot; Produtos de Limpeza&quot;                     
[29] &quot; Soc. Arrendamento Mercantil&quot;             
[30] &quot; Minerais Metálicos&quot;                      
[31] &quot; Intermediação Imobiliária&quot;               
[32] &quot; Agricultura&quot;                             
[33] &quot; Petroquímicos&quot;                           
[34] &quot; Carnes e Derivados&quot;                      
[35] &quot; Programas e Serviços&quot;                    
[36] &quot; Alimentos Diversos&quot;                      
[37] &quot; Exploração de Rodovias&quot;                  
[38] &quot; Papel e Celulose&quot;                        
[39] &quot; água e Saneamento&quot;                       
[40] &quot; Gás&quot;                                     
[41] &quot; Siderurgia&quot;                              
[42] &quot; Fios e Tecidos&quot;                          
[43] &quot; Vestuário&quot;                               
[44] &quot; Aluguel de carros&quot;                       
[45] &quot; Produção e Difusão de Filmes e Programas&quot;
[46] &quot; Serviços de Apoio e Armazenagem&quot;         
[47] &quot; Incorporações&quot;                           
[48] &quot; Transporte Ferroviário&quot;                  
[49] &quot; Exploração. Refino e Distribuição&quot;       
[50] &quot; Viagens e Turismo&quot;                       
[51] &quot; Madeira&quot;                                 
[52] &quot; Não Classificados&quot;                       
[53] &quot; Material Aeronáutico e de Defesa&quot;        
[54] &quot; Produtos para Construção&quot;                
[55] &quot; Fertilizantes e Defensivos&quot;              
[56] &quot; Soc. Crédito e Financiamento&quot;            
[57] &quot; Material Rodoviário&quot;                     
[58] &quot; Utensílios Domésticos&quot;                   
[59] &quot; Hotelaria&quot;                               
[60] &quot; Automóveis e Motocicletas&quot;               
[61] &quot; Transporte Rodoviário&quot;                   
[62] &quot; Transporte Hidroviário&quot;                  
[63] &quot; Equipamentos e Serviços&quot;                 
[64] &quot; Eletrodomésticos&quot;                        
[65] &quot; Artefatos de Ferro e Aço&quot;                
[66] &quot; Brinquedos e Jogos&quot;                      
[67] &quot; Embalagens&quot;                              
[68] &quot; Máq. e Equip. Construção e Agrícolas&quot;    
[69] &quot; Material de Transporte&quot;                  
[70] &quot; Acessórios&quot;                              
[71] &quot; Produtos de Uso Pessoal&quot;                 
[72] &quot; Artefatos de Cobre&quot;                      
[73] &quot; Computadores e Equipamentos&quot;             
[74] &quot; Materiais Diversos&quot;                      
[75] &quot; Produção de Eventos e Shows&quot;             
[76] &quot; Motores . Compressores e Outros&quot;         
[77] &quot; Atividades Esportivas&quot;                   
[78] &quot; Programas de Fidelização&quot;                
[79] &quot; Engenharia Consultiva&quot;                   
[80] &quot; Armas e Munições&quot;                        
[81] &quot; Químicos Diversos&quot;                       
[82] &quot; Móveis&quot;                                  </code></pre>
</div>
<p>Vamos transformar os valores em numéricos. Além disso, vamos transformar o número entre parêntesis em número negativo.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
dados &lt;- dados %&gt;% 
  mutate_at(.vars = vars(patrimonio.liquido, lucro.liquido, atividades.operacionais, total.acoes),
            .funs = ~str_replace_all(., &#39;\\.|\\)&#39;, &#39;&#39;)) %&gt;% 
  mutate_at(.vars = vars(patrimonio.liquido, lucro.liquido, atividades.operacionais, total.acoes),
            .funs = ~str_replace_all(., &#39;\\(&#39;, &#39;-&#39;)) %&gt;% 
  mutate_at(.vars = vars(patrimonio.liquido, lucro.liquido, atividades.operacionais, total.acoes),
            .funs = ~as.numeric(.))

glimpse(dados)</code></pre>
<pre><code>
Observations: 421
Variables: 9
$ nome.empresa            &lt;chr&gt; &quot;ADVANCED DIGITAL HEALTH MEDICINA P…
$ setor                   &lt;chr&gt; &quot;Saúde&quot;, &quot;Utilidade Pública&quot;, &quot;Util…
$ subsetor                &lt;chr&gt; &quot; Serv.Méd.Hospit..Análises e Diagn…
$ segmento                &lt;chr&gt; &quot; Serv.Méd.Hospit..Análises e Diagn…
$ patrimonio.liquido      &lt;dbl&gt; -17283, 1466649, 208222, 114009, 97…
$ lucro.liquido           &lt;dbl&gt; -2699, 97452, 12468, -103674, 17400…
$ atividades.operacionais &lt;dbl&gt; 0, 344262, 13243, -102944, -1146, 4…
$ total.acoes             &lt;dbl&gt; 1724272, 1489623772, 862287, 3, 209…
$ mil                     &lt;lgl&gt; TRUE, TRUE, TRUE, FALSE, TRUE, TRUE…</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
dados &lt;- dados %&gt;% 
  mutate_at(.vars = vars(patrimonio.liquido, lucro.liquido, atividades.operacionais),
            .funs = function(x) { ifelse(.$mil, x * 1000, x) })</code></pre>
</div>
<p>Acho que chegamos em uma base de dados satisfatória para uma abordagem inicial! Vamos salvar.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
write_csv(dados, &#39;empresas_b3_2019-06-30.csv&#39;)</code></pre>
</div>
<h2 id="alcancando-o-objetivo">Alcançando o objetivo</h2>
<p>Construída a base de dados, vamos nos informar para conhecer o cenário atual das ações listadas na B3. Lembrando que pegamos apenas os dados reportados pelas empresas referentes ao período de 01/01/2019 a 30/06/2019.</p>
<p>Quantas empresas temos listadas segundo o próprio site da B3?</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
nrow(dados)</code></pre>
<pre><code>
[1] 421</code></pre>
</div>
<p>Qual empresa com maior patrimônio de cada grande setor?</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
dados %&gt;% 
  group_by(setor) %&gt;% 
  filter(patrimonio.liquido == max(patrimonio.liquido)) %&gt;% 
  ungroup() %&gt;% 
  select(setor, nome.empresa, patrimonio.liquido) %&gt;% 
  arrange(-patrimonio.liquido)</code></pre>
<pre><code>
# A tibble: 12 x 3
   setor                nome.empresa                 patrimonio.liqui…
   &lt;chr&gt;                &lt;chr&gt;                                    &lt;dbl&gt;
 1 Petróleo. Gás e Bio… PETROLEO BRASILEIRO S.A. PE…      309418000000
 2 Materiais Básicos    VALE S.A.                         165982310000
 3 Financeiro           ITAU UNIBANCO HOLDING S.A.        143813000000
 4 Telecomunicações     TELEFÔNICA BRASIL S.A              69666124000
 5 Consumo não Cíclico  AMBEV S.A.                         62928776000
 6 Utilidade Pública    CENTRAIS ELET BRAS S.A. - E…       62790108000
 7 Consumo Cíclico      KROTON EDUCACIONAL S.A.            16050647000
 8 Bens Industriais     EMBRAER S.A.                       14984326000
 9 Saúde                HYPERA S.A.                         8557617000
10 Tecnologia da Infor… TOTVS S.A.                          2405720000
11 Outros               ELETRON S.A.                        1224736000
12 Não Classificados    TCP TERMINAL DE CONTEINERES…         265123000</code></pre>
</div>
<p>Qual a quantidade de empresas listadas por cada grande setor?</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
dados %&gt;% 
  group_by(setor) %&gt;% 
  summarise(quantidade.empresas = n()) %&gt;% 
  arrange(-quantidade.empresas)</code></pre>
<pre><code>
# A tibble: 12 x 2
   setor                           quantidade.empresas
   &lt;chr&gt;                                         &lt;int&gt;
 1 Financeiro                                       86
 2 Consumo Cíclico                                  77
 3 Bens Industriais                                 72
 4 Utilidade Pública                                66
 5 Materiais Básicos                                30
 6 Consumo não Cíclico                              25
 7 Outros                                           22
 8 Saúde                                            18
 9 Petróleo. Gás e Biocombustíveis                  10
10 Tecnologia da Informação                          6
11 Telecomunicações                                  5
12 Não Classificados                                 4</code></pre>
</div>
<p>Para responder mais perguntas e possibilitar uma exploração mais dinâmica, vamos montar um gráfico TreeMap interativo expondo algumas variáveis.</p>
<p>Primeiro vamos comprar os totais por setor para entender como as empresas estão distribuídas. Para o gráfico vamos utilizar o excelente pacote <a href="https://github.com/paulofelipe/D3plusR">D3plusR</a>. Temos um <a href="https://www.fulljoin.com.br/posts/2017-03-12-introducao-d3plusr/">post sobre esse pacote cuja leitura é obrigatória</a>!</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
library(D3plusR)</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
d3plus(data = dados %&gt;% mutate(quantidade = 1),
       type = &quot;tree_map&quot;,
       id = c(&quot;setor&quot;, &quot;subsetor&quot;, &quot;segmento&quot;, &quot;nome.empresa&quot;),
       width = &quot;100%&quot;,
       height = 500) %&gt;% 
  d3plusSize(value = &quot;patrimonio.liquido&quot;) %&gt;% 
  d3plusLegend(value = TRUE, order = list(sort = &quot;desc&quot;, value = &quot;size&quot;)) %&gt;% 
  d3plusColor(&quot;setor&quot;) %&gt;% 
  d3plusDepth(1) %&gt;% 
  d3plusLabels(value = TRUE, valign = &quot;top&quot;) %&gt;% 
  d3plusUi(value = list(list(method = &quot;size&quot;,
                             value = list(list(Patrimonio = &quot;patrimonio.liquido&quot;), 
                                          list(Qtd.Empresas = &quot;quantidade&quot;),
                                          list(Qtd.Acoes = &quot;total.acoes&quot;))),
                        list(method = &quot;depth&quot;, type = &quot;drop&quot;,
                             value = list(list(Setor = 0), 
                                          list(Subsetor = 1),
                                          list(Segmento = 2),
                                          list(Empresa = 3)))))</code></pre>
<div id="htmlwidget-15ac03af086fb7d916ef" style="width:100%;height:500px;" class="d3plus html-widget"></div>
<script type="application/json" data-for="htmlwidget-15ac03af086fb7d916ef">{"x":{"data":[{"nome.empresa":"ADVANCED DIGITAL HEALTH MEDICINA PREVENTIVA S.A.","setor":"Saúde","subsetor":" Serv.Méd.Hospit..Análises e Diagnósticos ","segmento":" Serv.Méd.Hospit..Análises e Diagnósticos","patrimonio.liquido":-17283000,"lucro.liquido":-2699000,"atividades.operacionais":0,"total.acoes":1724272,"mil":true,"quantidade":1},{"nome.empresa":"AES TIETE ENERGIA SA","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":1466649000,"lucro.liquido":97452000,"atividades.operacionais":344262000,"total.acoes":1489623772,"mil":true,"quantidade":1},{"nome.empresa":"AFLUENTE TRANSMISSÃO DE ENERGIA ELÉTRICA S/A","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":208222000,"lucro.liquido":12468000,"atividades.operacionais":13243000,"total.acoes":862287,"mil":true,"quantidade":1},{"nome.empresa":"ALEF S.A.","setor":"Outros","subsetor":" Outros ","segmento":" Outros","patrimonio.liquido":114009,"lucro.liquido":-103674,"atividades.operacionais":-102944,"total.acoes":3,"mil":false,"quantidade":1},{"nome.empresa":"ALFA HOLDINGS S.A.","setor":"Financeiro","subsetor":" Intermediários Financeiros ","segmento":" Bancos","patrimonio.liquido":975533000,"lucro.liquido":17400000,"atividades.operacionais":-1146000,"total.acoes":20917946,"mil":true,"quantidade":1},{"nome.empresa":"ALGAR TELECOM S/A","setor":"Telecomunicações","subsetor":" Telecomunicações ","segmento":" Telecomunicações","patrimonio.liquido":1626672000,"lucro.liquido":219879000,"atividades.operacionais":427710000,"total.acoes":81911749,"mil":true,"quantidade":1},{"nome.empresa":"ALIANSCE SHOPPING CENTERS S.A.","setor":"Financeiro","subsetor":" Exploração de Imóveis ","segmento":" Exploração de Imóveis","patrimonio.liquido":2646744000,"lucro.liquido":69802000,"atividades.operacionais":179911000,"total.acoes":101072936,"mil":true,"quantidade":1},{"nome.empresa":"ALIANSCE SONAE SHOPPING CENTERS S.A.","setor":"Financeiro","subsetor":" Exploração de Imóveis ","segmento":" Exploração de Imóveis","patrimonio.liquido":3939428000,"lucro.liquido":98876000,"atividades.operacionais":111279000,"total.acoes":100529456,"mil":true,"quantidade":1},{"nome.empresa":"ALPARGATAS S.A.","setor":"Consumo Cíclico","subsetor":" Tecidos. Vestuário e Calçados ","segmento":" Calçados","patrimonio.liquido":2528955000,"lucro.liquido":72565000,"atividades.operacionais":313622000,"total.acoes":198398386,"mil":true,"quantidade":1},{"nome.empresa":"ALPER CONSULTORIA E CORRETORA DE SEGUROS S.A.","setor":"Financeiro","subsetor":" Previdência e Seguros ","segmento":" Corretoras de Seguros","patrimonio.liquido":97602000,"lucro.liquido":4475000,"atividades.operacionais":6244000,"total.acoes":5576892,"mil":true,"quantidade":1},{"nome.empresa":"ALTERE SECURITIZADORA S.A.","setor":"Financeiro","subsetor":" Securitizadoras de Recebíveis ","segmento":" Securitizadoras de Recebíveis","patrimonio.liquido":63000,"lucro.liquido":17000,"atividades.operacionais":12000,"total.acoes":36218984,"mil":true,"quantidade":1},{"nome.empresa":"ALUPAR INVESTIMENTO S/A","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":7063486000,"lucro.liquido":891793000,"atividades.operacionais":190750000,"total.acoes":420644774,"mil":true,"quantidade":1},{"nome.empresa":"AMBEV S.A.","setor":"Consumo não Cíclico","subsetor":" Bebidas ","segmento":" Cervejas e Refrigerantes","patrimonio.liquido":62928776000,"lucro.liquido":5364969000,"atividades.operacionais":5194219000,"total.acoes":4344066764,"mil":true,"quantidade":1},{"nome.empresa":"AMPLA ENERGIA E SERVICOS S.A.","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":3550902000,"lucro.liquido":50073000,"atividades.operacionais":-42738000,"total.acoes":442934,"mil":true,"quantidade":1},{"nome.empresa":"ANDRADE GUTIERREZ PARTICIPACOES S.A.","setor":"Financeiro","subsetor":" Holdings Diversificadas ","segmento":" Holdings Diversificadas","patrimonio.liquido":-306201000,"lucro.liquido":-34283000,"atividades.operacionais":11588000,"total.acoes":1292396406,"mil":true,"quantidade":1},{"nome.empresa":"ANIMA HOLDING S.A.","setor":"Consumo Cíclico","subsetor":" Diversos ","segmento":" Serviços Educacionais","patrimonio.liquido":686449000,"lucro.liquido":21205000,"atividades.operacionais":64778000,"total.acoes":40044039,"mil":true,"quantidade":1},{"nome.empresa":"AREZZO INDÚSTRIA E COMÉRCIO S.A.","setor":"Consumo Cíclico","subsetor":" Comércio ","segmento":" Tecidos. Vestuário e Calçados","patrimonio.liquido":678848000,"lucro.liquido":63709000,"atividades.operacionais":84103000,"total.acoes":44066233,"mil":true,"quantidade":1},{"nome.empresa":"ATACADÃO S.A.","setor":"Consumo não Cíclico","subsetor":" Comércio e Distribuição ","segmento":" Alimentos","patrimonio.liquido":14004000000,"lucro.liquido":78000000,"atividades.operacionais":-2666000000,"total.acoes":384888219,"mil":true,"quantidade":1},{"nome.empresa":"ATOM EMPREENDIMENTOS E PARTICIPAÇÕES S.A.","setor":"Outros","subsetor":" Outros ","segmento":" Outros","patrimonio.liquido":4451000,"lucro.liquido":1431000,"atividades.operacionais":3435000,"total.acoes":6338837,"mil":true,"quantidade":1},{"nome.empresa":"AZEVEDO E TRAVASSOS S.A.","setor":"Bens Industriais","subsetor":" Construção e Engenharia ","segmento":" Construção Pesada","patrimonio.liquido":-101375000,"lucro.liquido":-23021000,"atividades.operacionais":8544000,"total.acoes":3445225,"mil":true,"quantidade":1},{"nome.empresa":"AZUL S.A.","setor":"Bens Industriais","subsetor":" Transporte ","segmento":" Transporte Aéreo","patrimonio.liquido":-88430000,"lucro.liquido":483171000,"atividades.operacionais":966210000,"total.acoes":623588376,"mil":true,"quantidade":1},{"nome.empresa":"B2W - COMPANHIA DIGITAL","setor":"Consumo Cíclico","subsetor":" Comércio ","segmento":" Produtos Diversos","patrimonio.liquido":3257816000,"lucro.liquido":-266810000,"atividades.operacionais":-374424000,"total.acoes":168886962,"mil":true,"quantidade":1},{"nome.empresa":"B3 S.A. - BRASIL. BOLSA. BALCÃO","setor":"Financeiro","subsetor":" Serviços Financeiros Diversos ","segmento":" Serviços Financeiros Diversos","patrimonio.liquido":25346178000,"lucro.liquido":1260667000,"atividades.operacionais":-73435000,"total.acoes":2047569597,"mil":true,"quantidade":1},{"nome.empresa":"BAHEMA EDUCAÇÃO S.A.","setor":"Consumo Cíclico","subsetor":" Diversos ","segmento":" Serviços Educacionais","patrimonio.liquido":53855000,"lucro.liquido":-5641000,"atividades.operacionais":-2407000,"total.acoes":452905,"mil":true,"quantidade":1},{"nome.empresa":"BANCO INTER S.A.","setor":"Financeiro","subsetor":" Intermediários Financeiros ","segmento":" Bancos","patrimonio.liquido":972651000,"lucro.liquido":45002000,"atividades.operacionais":311450000,"total.acoes":378638946,"mil":true,"quantidade":1},{"nome.empresa":"BANESTES S.A. - BCO EST ESPIRITO SANTO","setor":"Financeiro","subsetor":" Intermediários Financeiros ","segmento":" Bancos","patrimonio.liquido":1530907000,"lucro.liquido":108993000,"atividades.operacionais":1161811000,"total.acoes":13309111,"mil":true,"quantidade":1},{"nome.empresa":"BARDELLA S.A. INDUSTRIAS MECANICAS","setor":"Bens Industriais","subsetor":" Máquinas e Equipamentos ","segmento":" Máq. e Equip. Industriais","patrimonio.liquido":106730000,"lucro.liquido":-95862000,"atividades.operacionais":-18263000,"total.acoes":1230086,"mil":true,"quantidade":1},{"nome.empresa":"BATTISTELLA ADM PARTICIPACOES S.A.","setor":"Financeiro","subsetor":" Holdings Diversificadas ","segmento":" Holdings Diversificadas","patrimonio.liquido":4832000,"lucro.liquido":4414000,"atividades.operacionais":4037000,"total.acoes":2329491,"mil":true,"quantidade":1},{"nome.empresa":"BAUMER S.A.","setor":"Saúde","subsetor":" Equipamentos ","segmento":" Equipamentos","patrimonio.liquido":108062000,"lucro.liquido":3406000,"atividades.operacionais":8273000,"total.acoes":2599475,"mil":true,"quantidade":1},{"nome.empresa":"BB SEGURIDADE PARTICIPAÇÕES S.A.","setor":"Financeiro","subsetor":" Previdência e Seguros ","segmento":" Seguradoras","patrimonio.liquido":7119372000,"lucro.liquido":2092151000,"atividades.operacionais":840499000,"total.acoes":671601167,"mil":true,"quantidade":1},{"nome.empresa":"BBM LOGISTICA S.A.","setor":"Bens Industriais","subsetor":" Serviços ","segmento":" Serviços Diversos","patrimonio.liquido":102511000,"lucro.liquido":1679000,"atividades.operacionais":20706000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"BCO ABC BRASIL S.A.","setor":"Financeiro","subsetor":" Intermediários Financeiros ","segmento":" Bancos","patrimonio.liquido":3882219000,"lucro.liquido":252279000,"atividades.operacionais":2672965000,"total.acoes":75245599,"mil":true,"quantidade":1},{"nome.empresa":"BCO ALFA DE INVESTIMENTO S.A.","setor":"Financeiro","subsetor":" Intermediários Financeiros ","segmento":" Bancos","patrimonio.liquido":1463448000,"lucro.liquido":28035000,"atividades.operacionais":136354000,"total.acoes":20024233,"mil":true,"quantidade":1},{"nome.empresa":"BCO AMAZONIA S.A.","setor":"Financeiro","subsetor":" Intermediários Financeiros ","segmento":" Bancos","patrimonio.liquido":2008888000,"lucro.liquido":59191000,"atividades.operacionais":875941000,"total.acoes":1071910,"mil":true,"quantidade":1},{"nome.empresa":"BCO BRADESCO S.A.","setor":"Financeiro","subsetor":" Intermediários Financeiros ","segmento":" Bancos","patrimonio.liquido":133636476000,"lucro.liquido":11862521000,"atividades.operacionais":-7165048000,"total.acoes":5013073404,"mil":true,"quantidade":1},{"nome.empresa":"BCO BRASIL S.A.","setor":"Financeiro","subsetor":" Intermediários Financeiros ","segmento":" Bancos","patrimonio.liquido":91685951000,"lucro.liquido":8119872000,"atividades.operacionais":46151816000,"total.acoes":1332879313,"mil":true,"quantidade":1},{"nome.empresa":"BCO BTG PACTUAL S.A.","setor":"Financeiro","subsetor":" Intermediários Financeiros ","segmento":" Bancos","patrimonio.liquido":20379252000,"lucro.liquido":1671327000,"atividades.operacionais":13428126000,"total.acoes":582260781,"mil":true,"quantidade":1},{"nome.empresa":"BCO ESTADO DE SERGIPE S.A. - BANESE","setor":"Financeiro","subsetor":" Intermediários Financeiros ","segmento":" Bancos","patrimonio.liquido":364551000,"lucro.liquido":41360000,"atividades.operacionais":100569000,"total.acoes":1548736,"mil":true,"quantidade":1},{"nome.empresa":"BCO ESTADO DO PARA S.A.","setor":"Financeiro","subsetor":" Intermediários Financeiros ","segmento":" Bancos","patrimonio.liquido":1280963000,"lucro.liquido":149390000,"atividades.operacionais":599964000,"total.acoes":2083,"mil":true,"quantidade":1},{"nome.empresa":"BCO ESTADO DO RIO GRANDE DO SUL S.A.","setor":"Financeiro","subsetor":" Intermediários Financeiros ","segmento":" Bancos","patrimonio.liquido":7518309000,"lucro.liquido":655348000,"atividades.operacionais":386995000,"total.acoes":206997365,"mil":true,"quantidade":1},{"nome.empresa":"BCO INDUSVAL S.A.","setor":"Financeiro","subsetor":" Intermediários Financeiros ","segmento":" Bancos","patrimonio.liquido":318706000,"lucro.liquido":-77230000,"atividades.operacionais":-459719000,"total.acoes":4587338,"mil":true,"quantidade":1},{"nome.empresa":"BCO MERCANTIL DE INVESTIMENTOS S.A.","setor":"Financeiro","subsetor":" Intermediários Financeiros ","segmento":" Bancos","patrimonio.liquido":119372000,"lucro.liquido":251000,"atividades.operacionais":26431000,"total.acoes":409047,"mil":true,"quantidade":1},{"nome.empresa":"BCO MERCANTIL DO BRASIL S.A.","setor":"Financeiro","subsetor":" Intermediários Financeiros ","segmento":" Bancos","patrimonio.liquido":850253000,"lucro.liquido":52071000,"atividades.operacionais":307669000,"total.acoes":25266184,"mil":true,"quantidade":1},{"nome.empresa":"BCO NORDESTE DO BRASIL S.A.","setor":"Financeiro","subsetor":" Intermediários Financeiros ","segmento":" Bancos","patrimonio.liquido":4727782000,"lucro.liquido":744777000,"atividades.operacionais":3063509000,"total.acoes":604527,"mil":true,"quantidade":1},{"nome.empresa":"BCO PAN S.A.","setor":"Financeiro","subsetor":" Intermediários Financeiros ","segmento":" Bancos","patrimonio.liquido":4226556000,"lucro.liquido":213814000,"atividades.operacionais":-12292000,"total.acoes":189246811,"mil":true,"quantidade":1},{"nome.empresa":"BCO PATAGONIA S.A.","setor":"Financeiro","subsetor":" Intermediários Financeiros ","segmento":" Bancos","patrimonio.liquido":2322738000,"lucro.liquido":466959000,"atividades.operacionais":-438435000,"total.acoes":141028367,"mil":true,"quantidade":1},{"nome.empresa":"BCO PINE S.A.","setor":"Financeiro","subsetor":" Intermediários Financeiros ","segmento":" Bancos","patrimonio.liquido":807638000,"lucro.liquido":-70640000,"atividades.operacionais":-1121059000,"total.acoes":34505893,"mil":true,"quantidade":1},{"nome.empresa":"BCO SANTANDER (BRASIL) S.A.","setor":"Financeiro","subsetor":" Intermediários Financeiros ","segmento":" Bancos","patrimonio.liquido":96580373000,"lucro.liquido":7161483000,"atividades.operacionais":11108941000,"total.acoes":752259737,"mil":true,"quantidade":1},{"nome.empresa":"BETA SECURITIZADORA S.A.","setor":"Financeiro","subsetor":" Securitizadoras de Recebíveis ","segmento":" Securitizadoras de Recebíveis","patrimonio.liquido":832000,"lucro.liquido":19000,"atividades.operacionais":7000,"total.acoes":10995705,"mil":true,"quantidade":1},{"nome.empresa":"BETAPART PARTICIPACOES S.A.","setor":"Outros","subsetor":" Outros ","segmento":" Outros","patrimonio.liquido":921000,"lucro.liquido":-95000,"atividades.operacionais":-80000,"total.acoes":3,"mil":true,"quantidade":1},{"nome.empresa":"BICICLETAS MONARK S.A.","setor":"Consumo Cíclico","subsetor":" Viagens e Lazer ","segmento":" Bicicletas","patrimonio.liquido":186953000,"lucro.liquido":1008000,"atividades.operacionais":1033000,"total.acoes":137474,"mil":true,"quantidade":1},{"nome.empresa":"BIOMM S.A.","setor":"Saúde","subsetor":" Medicamentos e Outros Produtos ","segmento":" Medicamentos e Outros Produtos","patrimonio.liquido":79133000,"lucro.liquido":-28737000,"atividades.operacionais":-25983000,"total.acoes":13783125,"mil":true,"quantidade":1},{"nome.empresa":"BIOSEV S.A.","setor":"Consumo não Cíclico","subsetor":" Alimentos Processados ","segmento":" Açucar e Alcool","patrimonio.liquido":383310000,"lucro.liquido":-168894000,"atividades.operacionais":-471776000,"total.acoes":61163399,"mil":true,"quantidade":1},{"nome.empresa":"BIOTOSCANA INVESTMENTS S.A.","setor":"Saúde","subsetor":" Medicamentos e Outros Produtos ","segmento":" Medicamentos e Outros Produtos","patrimonio.liquido":764531357,"lucro.liquido":15891571,"atividades.operacionais":2002136,"total.acoes":50467851,"mil":false,"quantidade":1},{"nome.empresa":"BK BRASIL OPERAÇÃO E ASSESSORIA A RESTAURANTES SA","setor":"Consumo Cíclico","subsetor":" Hoteis e Restaurantes ","segmento":" Restaurante e Similares","patrimonio.liquido":1764909000,"lucro.liquido":1784000,"atividades.operacionais":25847000,"total.acoes":225793788,"mil":true,"quantidade":1},{"nome.empresa":"BNDES PARTICIPACOES S.A. - BNDESPAR","setor":"Financeiro","subsetor":" Serviços Financeiros Diversos ","segmento":" Gestão de Recursos e Investimentos","patrimonio.liquido":101146413000,"lucro.liquido":5041131000,"atividades.operacionais":8368647000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"BOMBRIL S.A.","setor":"Consumo não Cíclico","subsetor":" Produtos de Uso Pessoal e de Limpeza ","segmento":" Produtos de Limpeza","patrimonio.liquido":-265638000,"lucro.liquido":-24249000,"atividades.operacionais":41828000,"total.acoes":26106628,"mil":true,"quantidade":1},{"nome.empresa":"BR MALLS PARTICIPACOES S.A.","setor":"Financeiro","subsetor":" Exploração de Imóveis ","segmento":" Exploração de Imóveis","patrimonio.liquido":11527918000,"lucro.liquido":616209000,"atividades.operacionais":397016000,"total.acoes":840057819,"mil":true,"quantidade":1},{"nome.empresa":"BR PROPERTIES S.A.","setor":"Financeiro","subsetor":" Exploração de Imóveis ","segmento":" Exploração de Imóveis","patrimonio.liquido":5763987000,"lucro.liquido":-110813000,"atividades.operacionais":129885000,"total.acoes":117801430,"mil":true,"quantidade":1},{"nome.empresa":"BRADESCO LEASING S.A. ARREND MERCANTIL","setor":"Financeiro","subsetor":" Intermediários Financeiros ","segmento":" Soc. Arrendamento Mercantil","patrimonio.liquido":3449840000,"lucro.liquido":113391000,"atividades.operacionais":-273509000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"BRADESPAR S.A.","setor":"Materiais Básicos","subsetor":" Mineração ","segmento":" Minerais Metálicos","patrimonio.liquido":9553065000,"lucro.liquido":-376643000,"atividades.operacionais":107402000,"total.acoes":248589018,"mil":true,"quantidade":1},{"nome.empresa":"BRASIL BROKERS PARTICIPACOES S.A.","setor":"Financeiro","subsetor":" Exploração de Imóveis ","segmento":" Intermediação Imobiliária","patrimonio.liquido":204070000,"lucro.liquido":-14617000,"atividades.operacionais":-18957000,"total.acoes":35480938,"mil":true,"quantidade":1},{"nome.empresa":"BRASILAGRO - CIA BRAS DE PROP AGRICOLAS","setor":"Consumo não Cíclico","subsetor":" Agropecuária ","segmento":" Agricultura","patrimonio.liquido":888380000,"lucro.liquido":140076000,"atividades.operacionais":-6095000,"total.acoes":30490748,"mil":true,"quantidade":1},{"nome.empresa":"BRASKEM S.A.","setor":"Materiais Básicos","subsetor":" Químicos ","segmento":" Petroquímicos","patrimonio.liquido":8041460000,"lucro.liquido":1453920000,"atividades.operacionais":546175000,"total.acoes":278039723,"mil":true,"quantidade":1},{"nome.empresa":"BRAZIL REALTY CIA SECURIT. CRÉD. IMOBILIÁRIOS","setor":"Financeiro","subsetor":" Securitizadoras de Recebíveis ","segmento":" Securitizadoras de Recebíveis","patrimonio.liquido":-53290,"lucro.liquido":-129205,"atividades.operacionais":-96052,"total.acoes":0,"mil":false,"quantidade":1},{"nome.empresa":"BRAZILIAN FINANCE E REAL ESTATE S.A.","setor":"Financeiro","subsetor":" Serviços Financeiros Diversos ","segmento":" Gestão de Recursos e Investimentos","patrimonio.liquido":179781000,"lucro.liquido":7732000,"atividades.operacionais":2624000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"BRAZILIAN SECURITIES CIA SECURITIZACAO","setor":"Financeiro","subsetor":" Securitizadoras de Recebíveis ","segmento":" Securitizadoras de Recebíveis","patrimonio.liquido":222354000,"lucro.liquido":455000,"atividades.operacionais":425000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"BRB BCO DE BRASILIA S.A.","setor":"Financeiro","subsetor":" Intermediários Financeiros ","segmento":" Bancos","patrimonio.liquido":1439394000,"lucro.liquido":188543000,"atividades.operacionais":367392000,"total.acoes":1142127,"mil":true,"quantidade":1},{"nome.empresa":"BRC SECURITIZADORA S.A.","setor":"Financeiro","subsetor":" Securitizadoras de Recebíveis ","segmento":" Securitizadoras de Recebíveis","patrimonio.liquido":794551,"lucro.liquido":271799,"atividades.operacionais":123824,"total.acoes":453440,"mil":false,"quantidade":1},{"nome.empresa":"BRF S.A.","setor":"Consumo não Cíclico","subsetor":" Alimentos Processados ","segmento":" Carnes e Derivados","patrimonio.liquido":7444886000,"lucro.liquido":-687377000,"atividades.operacionais":605049000,"total.acoes":811416229,"mil":true,"quantidade":1},{"nome.empresa":"BRPR 55 SECURITIZADORA CRED IMOB S.A.","setor":"Financeiro","subsetor":" Securitizadoras de Recebíveis ","segmento":" Securitizadoras de Recebíveis","patrimonio.liquido":36103000,"lucro.liquido":-1071000,"atividades.operacionais":3713000,"total.acoes":5031024,"mil":true,"quantidade":1},{"nome.empresa":"BRPR 56 SECURITIZADORA CRED IMOB S.A.","setor":"Financeiro","subsetor":" Securitizadoras de Recebíveis ","segmento":" Securitizadoras de Recebíveis","patrimonio.liquido":9394000,"lucro.liquido":6193000,"atividades.operacionais":33583000,"total.acoes":340063,"mil":true,"quantidade":1},{"nome.empresa":"BRQ SOLUCOES EM INFORMATICA S.A.","setor":"Tecnologia da Informação","subsetor":" Programas e Serviços ","segmento":" Programas e Serviços","patrimonio.liquido":90669000,"lucro.liquido":8412000,"atividades.operacionais":-526000,"total.acoes":30515875,"mil":true,"quantidade":1},{"nome.empresa":"BV LEASING - ARRENDAMENTO MERCANTIL S.A.","setor":"Financeiro","subsetor":" Intermediários Financeiros ","segmento":" Soc. Arrendamento Mercantil","patrimonio.liquido":964215000,"lucro.liquido":-14298000,"atividades.operacionais":-263618000,"total.acoes":510404,"mil":true,"quantidade":1},{"nome.empresa":"CABINDA PARTICIPACOES S.A.","setor":"Outros","subsetor":" Outros ","segmento":" Outros","patrimonio.liquido":39000,"lucro.liquido":-41000,"atividades.operacionais":-51000,"total.acoes":7104000,"mil":true,"quantidade":1},{"nome.empresa":"CACHOEIRA PAULISTA TRANSMISSORA ENERGIA S.A.","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":147071000,"lucro.liquido":11006000,"atividades.operacionais":23555000,"total.acoes":76281111,"mil":true,"quantidade":1},{"nome.empresa":"CACONDE PARTICIPACOES S.A.","setor":"Outros","subsetor":" Outros ","segmento":" Outros","patrimonio.liquido":29000,"lucro.liquido":-41000,"atividades.operacionais":-51000,"total.acoes":1839753,"mil":true,"quantidade":1},{"nome.empresa":"CAMBUCI S.A.","setor":"Consumo Cíclico","subsetor":" Tecidos. Vestuário e Calçados ","segmento":" Calçados","patrimonio.liquido":41480000,"lucro.liquido":7896000,"atividades.operacionais":-8198000,"total.acoes":41980080,"mil":true,"quantidade":1},{"nome.empresa":"CAMIL ALIMENTOS S.A.","setor":"Consumo não Cíclico","subsetor":" Alimentos Processados ","segmento":" Alimentos Diversos","patrimonio.liquido":2238772000,"lucro.liquido":49794000,"atividades.operacionais":100186000,"total.acoes":151919527,"mil":true,"quantidade":1},{"nome.empresa":"CAPITALPART PARTICIPACOES S.A.","setor":"Outros","subsetor":" Outros ","segmento":" Outros","patrimonio.liquido":193632,"lucro.liquido":-139690,"atividades.operacionais":-5950,"total.acoes":933,"mil":false,"quantidade":1},{"nome.empresa":"CCR S.A.","setor":"Bens Industriais","subsetor":" Transporte ","segmento":" Exploração de Rodovias","patrimonio.liquido":8521333000,"lucro.liquido":694038000,"atividades.operacionais":2141814000,"total.acoes":1115695556,"mil":true,"quantidade":1},{"nome.empresa":"CCX CARVÃO DA COLÔMBIA S.A.","setor":"Outros","subsetor":" Outros ","segmento":" Outros","patrimonio.liquido":-49076000,"lucro.liquido":-3369000,"atividades.operacionais":-3150000,"total.acoes":744796,"mil":true,"quantidade":1},{"nome.empresa":"CELULOSE IRANI S.A.","setor":"Materiais Básicos","subsetor":" Madeira e Papel ","segmento":" Papel e Celulose","patrimonio.liquido":305009000,"lucro.liquido":-19134000,"atividades.operacionais":29140000,"total.acoes":15028261,"mil":true,"quantidade":1},{"nome.empresa":"CEMEPE INVESTIMENTOS S.A.","setor":"Outros","subsetor":" Outros ","segmento":" Outros","patrimonio.liquido":-5525000,"lucro.liquido":-111000,"atividades.operacionais":-90000,"total.acoes":35693,"mil":true,"quantidade":1},{"nome.empresa":"CEMIG DISTRIBUICAO S.A.","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":6209525000,"lucro.liquido":1567167000,"atividades.operacionais":604413000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"CEMIG GERACAO E TRANSMISSAO S.A.","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":5905849000,"lucro.liquido":925713000,"atividades.operacionais":479496000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"CENTRAIS ELET BRAS S.A. - ELETROBRAS","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":62790108000,"lucro.liquido":6908288000,"atividades.operacionais":-1176219000,"total.acoes":495771527,"mil":true,"quantidade":1},{"nome.empresa":"CENTRAIS ELET DE SANTA CATARINA S.A.","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":1926266000,"lucro.liquido":119124000,"atividades.operacionais":193149000,"total.acoes":29107626,"mil":true,"quantidade":1},{"nome.empresa":"CENTRAIS ELET DO PARA S.A. - CELPA","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":3105190000,"lucro.liquido":99358000,"atividades.operacionais":405789000,"total.acoes":77335252,"mil":true,"quantidade":1},{"nome.empresa":"CENTRO DE IMAGEM DIAGNOSTICOS S.A.","setor":"Saúde","subsetor":" Serv.Méd.Hospit..Análises e Diagnósticos ","segmento":" Serv.Méd.Hospit..Análises e Diagnósticos","patrimonio.liquido":1307509000,"lucro.liquido":23293000,"atividades.operacionais":97793000,"total.acoes":46475090,"mil":true,"quantidade":1},{"nome.empresa":"CESP - CIA ENERGETICA DE SAO PAULO","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":6944187000,"lucro.liquido":-162245000,"atividades.operacionais":100910000,"total.acoes":196480054,"mil":true,"quantidade":1},{"nome.empresa":"CIA BRASILEIRA DE DISTRIBUICAO","setor":"Consumo não Cíclico","subsetor":" Comércio e Distribuição ","segmento":" Alimentos","patrimonio.liquido":10728000000,"lucro.liquido":598000000,"atividades.operacionais":-3975000000,"total.acoes":156457345,"mil":true,"quantidade":1},{"nome.empresa":"CIA CATARINENSE DE AGUAS E SANEAM.-CASAN","setor":"Utilidade Pública","subsetor":" água e Saneamento ","segmento":" água e Saneamento","patrimonio.liquido":1306803000,"lucro.liquido":60798000,"atividades.operacionais":87649000,"total.acoes":24187,"mil":true,"quantidade":1},{"nome.empresa":"CIA CELG DE PARTICIPACOES - CELGPAR","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":-1701383000,"lucro.liquido":25057000,"atividades.operacionais":13967000,"total.acoes":77810,"mil":true,"quantidade":1},{"nome.empresa":"CIA DISTRIB DE GAS DO RIO DE JANEIRO-CEG","setor":"Utilidade Pública","subsetor":" Gás ","segmento":" Gás","patrimonio.liquido":1178831000,"lucro.liquido":158853000,"atividades.operacionais":146859000,"total.acoes":451373,"mil":true,"quantidade":1},{"nome.empresa":"CIA ELETRICIDADE EST. DA BAHIA - COELBA","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":4815555000,"lucro.liquido":525609000,"atividades.operacionais":439704000,"total.acoes":2777464,"mil":true,"quantidade":1},{"nome.empresa":"CIA ENERGETICA DE BRASILIA","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":602989000,"lucro.liquido":52105000,"atividades.operacionais":185631000,"total.acoes":2854274,"mil":true,"quantidade":1},{"nome.empresa":"CIA ENERGETICA DE MINAS GERAIS - CEMIG","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":18860292000,"lucro.liquido":2912225000,"atividades.operacionais":1083269000,"total.acoes":1208699885,"mil":true,"quantidade":1},{"nome.empresa":"CIA ENERGETICA DE PERNAMBUCO - CELPE","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":1591111000,"lucro.liquido":81048000,"atividades.operacionais":153528000,"total.acoes":7725191,"mil":true,"quantidade":1},{"nome.empresa":"CIA ENERGETICA DO CEARA - COELCE","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":2919701000,"lucro.liquido":129965000,"atividades.operacionais":103794000,"total.acoes":20202624,"mil":true,"quantidade":1},{"nome.empresa":"CIA ENERGETICA DO MARANHAO - CEMAR","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":2921513000,"lucro.liquido":297040000,"atividades.operacionais":489596000,"total.acoes":57285795,"mil":true,"quantidade":1},{"nome.empresa":"CIA ENERGETICA DO RIO GDE NORTE - COSERN","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":931570000,"lucro.liquido":123003000,"atividades.operacionais":184473000,"total.acoes":1902903,"mil":true,"quantidade":1},{"nome.empresa":"CIA ESTADUAL DE DISTRIB ENER ELET-CEEE-D","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":-2816969000,"lucro.liquido":-464528000,"atividades.operacionais":19926000,"total.acoes":3298838,"mil":true,"quantidade":1},{"nome.empresa":"CIA ESTADUAL GER.TRANS.ENER.ELET-CEEE-GT","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":2582793000,"lucro.liquido":175882000,"atividades.operacionais":121791000,"total.acoes":3298838,"mil":true,"quantidade":1},{"nome.empresa":"CIA FERRO LIGAS DA BAHIA - FERBASA","setor":"Materiais Básicos","subsetor":" Siderurgia e Metalurgia ","segmento":" Siderurgia","patrimonio.liquido":1782229000,"lucro.liquido":77848000,"atividades.operacionais":75521000,"total.acoes":40471088,"mil":true,"quantidade":1},{"nome.empresa":"CIA FIACAO TECIDOS CEDRO CACHOEIRA","setor":"Consumo Cíclico","subsetor":" Tecidos. Vestuário e Calçados ","segmento":" Fios e Tecidos","patrimonio.liquido":218262000,"lucro.liquido":9561000,"atividades.operacionais":11134000,"total.acoes":5378023,"mil":true,"quantidade":1},{"nome.empresa":"CIA GAS DE SAO PAULO - COMGAS","setor":"Utilidade Pública","subsetor":" Gás ","segmento":" Gás","patrimonio.liquido":3284578000,"lucro.liquido":562144000,"atividades.operacionais":972495000,"total.acoes":6391282,"mil":true,"quantidade":1},{"nome.empresa":"CIA HABITASUL DE PARTICIPACOES","setor":"Financeiro","subsetor":" Exploração de Imóveis ","segmento":" Exploração de Imóveis","patrimonio.liquido":251541000,"lucro.liquido":-38553000,"atividades.operacionais":-80075000,"total.acoes":3826275,"mil":true,"quantidade":1},{"nome.empresa":"CIA HERING","setor":"Consumo Cíclico","subsetor":" Tecidos. Vestuário e Calçados ","segmento":" Vestuário","patrimonio.liquido":1375136000,"lucro.liquido":87368000,"atividades.operacionais":135718000,"total.acoes":125486566,"mil":true,"quantidade":1},{"nome.empresa":"CIA INDUSTRIAL CATAGUASES","setor":"Consumo Cíclico","subsetor":" Tecidos. Vestuário e Calçados ","segmento":" Fios e Tecidos","patrimonio.liquido":112982000,"lucro.liquido":-17127000,"atividades.operacionais":-2691000,"total.acoes":44287,"mil":true,"quantidade":1},{"nome.empresa":"CIA LOCAÇÃO DAS AMÉRICAS","setor":"Consumo Cíclico","subsetor":" Diversos ","segmento":" Aluguel de carros","patrimonio.liquido":2657554000,"lucro.liquido":155674000,"atividades.operacionais":-878386000,"total.acoes":72709385,"mil":true,"quantidade":1},{"nome.empresa":"CIA MELHORAMENTOS DE SAO PAULO","setor":"Materiais Básicos","subsetor":" Madeira e Papel ","segmento":" Papel e Celulose","patrimonio.liquido":907454000,"lucro.liquido":-12764000,"atividades.operacionais":7598000,"total.acoes":755311,"mil":true,"quantidade":1},{"nome.empresa":"CIA PARANAENSE DE ENERGIA - COPEL","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":17181691000,"lucro.liquido":852903000,"atividades.operacionais":1385338000,"total.acoes":188626777,"mil":true,"quantidade":1},{"nome.empresa":"CIA PARTICIPACOES ALIANCA DA BAHIA","setor":"Financeiro","subsetor":" Holdings Diversificadas ","segmento":" Holdings Diversificadas","patrimonio.liquido":527690000,"lucro.liquido":26964000,"atividades.operacionais":19203000,"total.acoes":5631319,"mil":true,"quantidade":1},{"nome.empresa":"CIA PAULISTA DE FORCA E LUZ","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":1888680000,"lucro.liquido":376319000,"atividades.operacionais":673548000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"CIA PIRATININGA DE FORCA E LUZ","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":635619000,"lucro.liquido":118839000,"atividades.operacionais":501609000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"CIA SANEAMENTO BASICO EST SAO PAULO","setor":"Utilidade Pública","subsetor":" água e Saneamento ","segmento":" água e Saneamento","patrimonio.liquido":20593023000,"lucro.liquido":1101666000,"atividades.operacionais":1835367000,"total.acoes":339982576,"mil":true,"quantidade":1},{"nome.empresa":"CIA SANEAMENTO DE MINAS GERAIS-COPASA MG","setor":"Utilidade Pública","subsetor":" água e Saneamento ","segmento":" água e Saneamento","patrimonio.liquido":6468057000,"lucro.liquido":305794000,"atividades.operacionais":674888000,"total.acoes":62969736,"mil":true,"quantidade":1},{"nome.empresa":"CIA SANEAMENTO DO PARANA - SANEPAR","setor":"Utilidade Pública","subsetor":" água e Saneamento ","segmento":" água e Saneamento","patrimonio.liquido":5781189000,"lucro.liquido":450073000,"atividades.operacionais":667100000,"total.acoes":402820597,"mil":true,"quantidade":1},{"nome.empresa":"CIA SEGUROS ALIANCA DA BAHIA","setor":"Financeiro","subsetor":" Previdência e Seguros ","segmento":" Seguradoras","patrimonio.liquido":176652000,"lucro.liquido":784000,"atividades.operacionais":14413000,"total.acoes":3724815,"mil":true,"quantidade":1},{"nome.empresa":"CIA SIDERURGICA NACIONAL","setor":"Materiais Básicos","subsetor":" Siderurgia e Metalurgia ","segmento":" Siderurgia","patrimonio.liquido":12368948000,"lucro.liquido":1981225000,"atividades.operacionais":1924557000,"total.acoes":642387288,"mil":true,"quantidade":1},{"nome.empresa":"CIA TECIDOS NORTE DE MINAS COTEMINAS","setor":"Consumo Cíclico","subsetor":" Tecidos. Vestuário e Calçados ","segmento":" Fios e Tecidos","patrimonio.liquido":1892568000,"lucro.liquido":83574000,"atividades.operacionais":-28030000,"total.acoes":15290147,"mil":true,"quantidade":1},{"nome.empresa":"CIA TECIDOS SANTANENSE","setor":"Consumo Cíclico","subsetor":" Tecidos. Vestuário e Calçados ","segmento":" Fios e Tecidos","patrimonio.liquido":282221000,"lucro.liquido":4599000,"atividades.operacionais":21581000,"total.acoes":4724076,"mil":true,"quantidade":1},{"nome.empresa":"CIBRASEC - COMPANHIA BRASILEIRA DE SECURITIZACAO","setor":"Financeiro","subsetor":" Securitizadoras de Recebíveis ","segmento":" Securitizadoras de Recebíveis","patrimonio.liquido":72205000,"lucro.liquido":-2256000,"atividades.operacionais":5028000,"total.acoes":41649,"mil":true,"quantidade":1},{"nome.empresa":"CIELO S.A.","setor":"Financeiro","subsetor":" Serviços Financeiros Diversos ","segmento":" Serviços Financeiros Diversos","patrimonio.liquido":9132032000,"lucro.liquido":979684000,"atividades.operacionais":-647717000,"total.acoes":1118386806,"mil":true,"quantidade":1},{"nome.empresa":"CIMS S.A.","setor":"Outros","subsetor":" Outros ","segmento":" Outros","patrimonio.liquido":106976,"lucro.liquido":-109042,"atividades.operacionais":-107313,"total.acoes":0,"mil":false,"quantidade":1},{"nome.empresa":"CINESYSTEM S.A.","setor":"Consumo Cíclico","subsetor":" Mídia ","segmento":" Produção e Difusão de Filmes e Programas","patrimonio.liquido":40290000,"lucro.liquido":-594000,"atividades.operacionais":21986000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"CONC AUTO RAPOSO TAVARES S.A.","setor":"Bens Industriais","subsetor":" Transporte ","segmento":" Exploração de Rodovias","patrimonio.liquido":693390000,"lucro.liquido":-60478000,"atividades.operacionais":29627000,"total.acoes":2616389044,"mil":true,"quantidade":1},{"nome.empresa":"CONC DO AEROPORTO INTERNACIONAL DE GUARULHOS S.A.","setor":"Bens Industriais","subsetor":" Transporte ","segmento":" Serviços de Apoio e Armazenagem","patrimonio.liquido":-1261413000,"lucro.liquido":-342622000,"atividades.operacionais":535431000,"total.acoes":3033541675,"mil":true,"quantidade":1},{"nome.empresa":"CONC ECOVIAS IMIGRANTES S.A.","setor":"Bens Industriais","subsetor":" Transporte ","segmento":" Exploração de Rodovias","patrimonio.liquido":596800000,"lucro.liquido":159757000,"atividades.operacionais":284449000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"CONC RIO-TERESOPOLIS S.A.","setor":"Bens Industriais","subsetor":" Transporte ","segmento":" Exploração de Rodovias","patrimonio.liquido":138628000,"lucro.liquido":22797000,"atividades.operacionais":75948000,"total.acoes":86466,"mil":true,"quantidade":1},{"nome.empresa":"CONC ROD AYRTON SENNA E CARV PINTO S.A.-ECOPISTAS","setor":"Bens Industriais","subsetor":" Transporte ","segmento":" Exploração de Rodovias","patrimonio.liquido":580960000,"lucro.liquido":5255000,"atividades.operacionais":94187000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"CONC ROD.OESTE SP VIAOESTE S.A","setor":"Bens Industriais","subsetor":" Transporte ","segmento":" Exploração de Rodovias","patrimonio.liquido":316181000,"lucro.liquido":145788000,"atividades.operacionais":272118000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"CONC RODOVIAS DO TIETÊ S.A.","setor":"Bens Industriais","subsetor":" Transporte ","segmento":" Exploração de Rodovias","patrimonio.liquido":-79165000,"lucro.liquido":-47001000,"atividades.operacionais":65538000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"CONC ROTA DAS BANDEIRAS S.A.","setor":"Bens Industriais","subsetor":" Transporte ","segmento":" Exploração de Rodovias","patrimonio.liquido":852981000,"lucro.liquido":8618000,"atividades.operacionais":131787000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"CONC SIST ANHANG-BANDEIRANT S.A. AUTOBAN","setor":"Bens Industriais","subsetor":" Transporte ","segmento":" Exploração de Rodovias","patrimonio.liquido":638263000,"lucro.liquido":342163000,"atividades.operacionais":578706000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"CONSERVAS ODERICH S.A.","setor":"Consumo não Cíclico","subsetor":" Alimentos Processados ","segmento":" Alimentos Diversos","patrimonio.liquido":188881000,"lucro.liquido":14074000,"atividades.operacionais":29498000,"total.acoes":197952,"mil":true,"quantidade":1},{"nome.empresa":"CONSORCIO ALFA DE ADMINISTRACAO S.A.","setor":"Financeiro","subsetor":" Previdência e Seguros ","segmento":" Seguradoras","patrimonio.liquido":1717271000,"lucro.liquido":32665000,"atividades.operacionais":31971000,"total.acoes":15132392,"mil":true,"quantidade":1},{"nome.empresa":"CONSTRUTORA ADOLPHO LINDENBERG S.A.","setor":"Consumo Cíclico","subsetor":" Construção Civil ","segmento":" Incorporações","patrimonio.liquido":15049000,"lucro.liquido":-10976000,"atividades.operacionais":-9429000,"total.acoes":51644,"mil":true,"quantidade":1},{"nome.empresa":"CONSTRUTORA TENDA S.A.","setor":"Consumo Cíclico","subsetor":" Construção Civil ","segmento":" Incorporações","patrimonio.liquido":1252379000,"lucro.liquido":123437000,"atividades.operacionais":91265000,"total.acoes":99197204,"mil":true,"quantidade":1},{"nome.empresa":"CORREA RIBEIRO S.A. COMERCIO E INDUSTRIA","setor":"Financeiro","subsetor":" Exploração de Imóveis ","segmento":" Exploração de Imóveis","patrimonio.liquido":-4137000,"lucro.liquido":-1274000,"atividades.operacionais":-1336000,"total.acoes":16864,"mil":true,"quantidade":1},{"nome.empresa":"COSAN LOGISTICA S.A.","setor":"Bens Industriais","subsetor":" Transporte ","segmento":" Transporte Ferroviário","patrimonio.liquido":8038370000,"lucro.liquido":211390000,"atividades.operacionais":1341259000,"total.acoes":125570897,"mil":true,"quantidade":1},{"nome.empresa":"COSAN S.A.","setor":"Petróleo. Gás e Biocombustíveis","subsetor":" Petróleo. Gás e Biocombustíveis ","segmento":" Exploração. Refino e Distribuição","patrimonio.liquido":10098691000,"lucro.liquido":874354000,"atividades.operacionais":874716000,"total.acoes":155404710,"mil":true,"quantidade":1},{"nome.empresa":"CPFL ENERGIA S.A.","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":17301036000,"lucro.liquido":1144031000,"atividades.operacionais":2837861000,"total.acoes":170209781,"mil":true,"quantidade":1},{"nome.empresa":"CPFL ENERGIAS RENOVÁVEIS S.A.","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":4411895000,"lucro.liquido":-131521000,"atividades.operacionais":201640000,"total.acoes":291550,"mil":true,"quantidade":1},{"nome.empresa":"CPFL GERACAO DE ENERGIA S.A.","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":5059642000,"lucro.liquido":254024000,"atividades.operacionais":665052000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"CR2 EMPREENDIMENTOS IMOBILIARIOS S.A.","setor":"Consumo Cíclico","subsetor":" Construção Civil ","segmento":" Incorporações","patrimonio.liquido":160435000,"lucro.liquido":-7224000,"atividades.operacionais":-1622000,"total.acoes":2003649,"mil":true,"quantidade":1},{"nome.empresa":"CSU CARDSYSTEM S.A.","setor":"Bens Industriais","subsetor":" Serviços ","segmento":" Serviços Diversos","patrimonio.liquido":245935000,"lucro.liquido":9133000,"atividades.operacionais":42868000,"total.acoes":16724754,"mil":true,"quantidade":1},{"nome.empresa":"CTC - CENTRO DE TECNOLOGIA CANAVIEIRA S.A.","setor":"Consumo não Cíclico","subsetor":" Agropecuária ","segmento":" Agricultura","patrimonio.liquido":587156000,"lucro.liquido":7527000,"atividades.operacionais":-15234000,"total.acoes":158271,"mil":true,"quantidade":1},{"nome.empresa":"CTEEP - CIA TRANSMISSÃO ENERGIA ELÉTRICA PAULISTA","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":12164827000,"lucro.liquido":820072000,"atividades.operacionais":693063000,"total.acoes":422881944,"mil":true,"quantidade":1},{"nome.empresa":"CVC BRASIL OPERADORA E AGÊNCIA DE VIAGENS S.A.","setor":"Consumo Cíclico","subsetor":" Viagens e Lazer ","segmento":" Viagens e Turismo","patrimonio.liquido":1331642000,"lucro.liquido":78681000,"atividades.operacionais":119351000,"total.acoes":144684926,"mil":true,"quantidade":1},{"nome.empresa":"CYRELA BRAZIL REALTY S.A.EMPREEND E PART","setor":"Consumo Cíclico","subsetor":" Construção Civil ","segmento":" Incorporações","patrimonio.liquido":5680594000,"lucro.liquido":203692000,"atividades.operacionais":256885000,"total.acoes":263583096,"mil":true,"quantidade":1},{"nome.empresa":"CYRELA COMMERCIAL PROPERT S.A. EMPR PART","setor":"Financeiro","subsetor":" Exploração de Imóveis ","segmento":" Exploração de Imóveis","patrimonio.liquido":1766987000,"lucro.liquido":18068000,"atividades.operacionais":104286000,"total.acoes":26284954,"mil":true,"quantidade":1},{"nome.empresa":"DIAGNOSTICOS DA AMERICA S.A.","setor":"Saúde","subsetor":" Serv.Méd.Hospit..Análises e Diagnósticos ","segmento":" Serv.Méd.Hospit..Análises e Diagnósticos","patrimonio.liquido":3515961000,"lucro.liquido":103434000,"atividades.operacionais":127889000,"total.acoes":2639767,"mil":true,"quantidade":1},{"nome.empresa":"DIBENS LEASING S.A. - ARREND.MERCANTIL","setor":"Financeiro","subsetor":" Intermediários Financeiros ","segmento":" Soc. Arrendamento Mercantil","patrimonio.liquido":4968511000,"lucro.liquido":159936000,"atividades.operacionais":10631799000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"DIMED S.A. DISTRIBUIDORA DE MEDICAMENTOS","setor":"Saúde","subsetor":" Comércio e Distribuição ","segmento":" Medicamentos e Outros Produtos","patrimonio.liquido":481821000,"lucro.liquido":32334000,"atividades.operacionais":20588000,"total.acoes":1445915,"mil":true,"quantidade":1},{"nome.empresa":"DIRECIONAL ENGENHARIA S.A.","setor":"Consumo Cíclico","subsetor":" Construção Civil ","segmento":" Incorporações","patrimonio.liquido":1387828000,"lucro.liquido":58712000,"atividades.operacionais":154381000,"total.acoes":76763694,"mil":true,"quantidade":1},{"nome.empresa":"DOHLER S.A.","setor":"Consumo Cíclico","subsetor":" Tecidos. Vestuário e Calçados ","segmento":" Fios e Tecidos","patrimonio.liquido":571397000,"lucro.liquido":573000,"atividades.operacionais":19381000,"total.acoes":7812767,"mil":true,"quantidade":1},{"nome.empresa":"DOMMO ENERGIA S.A.","setor":"Petróleo. Gás e Biocombustíveis","subsetor":" Petróleo. Gás e Biocombustíveis ","segmento":" Exploração. Refino e Distribuição","patrimonio.liquido":-378799000,"lucro.liquido":-21617000,"atividades.operacionais":99233000,"total.acoes":269968506,"mil":true,"quantidade":1},{"nome.empresa":"DTCOM - DIRECT TO COMPANY S.A.","setor":"Bens Industriais","subsetor":" Serviços ","segmento":" Serviços Diversos","patrimonio.liquido":892000,"lucro.liquido":-5625000,"atividades.operacionais":7938000,"total.acoes":185908,"mil":true,"quantidade":1},{"nome.empresa":"DURATEX S.A.","setor":"Materiais Básicos","subsetor":" Madeira e Papel ","segmento":" Madeira","patrimonio.liquido":4728964000,"lucro.liquido":93276000,"atividades.operacionais":151800000,"total.acoes":273493230,"mil":true,"quantidade":1},{"nome.empresa":"ECO SECURITIZADORA DIREITOS CRED AGRONEGÓCIO S.A.","setor":"Não Classificados","subsetor":" Não Classificado ","segmento":" Não Classificados","patrimonio.liquido":1627000,"lucro.liquido":541000,"atividades.operacionais":-774000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"ECORODOVIAS CONCESSÕES E SERVIÇOS S.A.","setor":"Bens Industriais","subsetor":" Transporte ","segmento":" Exploração de Rodovias","patrimonio.liquido":1368655000,"lucro.liquido":246400000,"atividades.operacionais":524377000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"ECORODOVIAS INFRAESTRUTURA E LOGÍSTICA S.A.","setor":"Bens Industriais","subsetor":" Transporte ","segmento":" Exploração de Rodovias","patrimonio.liquido":787268000,"lucro.liquido":146949000,"atividades.operacionais":555454000,"total.acoes":171079276,"mil":true,"quantidade":1},{"nome.empresa":"EDP - ENERGIAS DO BRASIL S.A.","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":10044747000,"lucro.liquido":559300000,"atividades.operacionais":1112218000,"total.acoes":295402225,"mil":true,"quantidade":1},{"nome.empresa":"EDP ESPIRITO SANTO DISTRIBUIÇÃO DE ENERGIA S.A.","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":942949000,"lucro.liquido":101051000,"atividades.operacionais":315831000,"total.acoes":5876012,"mil":true,"quantidade":1},{"nome.empresa":"EDP SÃO PAULO DISTRIBUIÇÃO DE ENERGIA S.A.","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":1182199000,"lucro.liquido":104963000,"atividades.operacionais":330996000,"total.acoes":39091735037,"mil":true,"quantidade":1},{"nome.empresa":"ELECTRO ACO ALTONA S.A.","setor":"Bens Industriais","subsetor":" Máquinas e Equipamentos ","segmento":" Máq. e Equip. Industriais","patrimonio.liquido":160878000,"lucro.liquido":10494000,"atividades.operacionais":-11319000,"total.acoes":22500000,"mil":true,"quantidade":1},{"nome.empresa":"ELEKEIROZ S.A.","setor":"Materiais Básicos","subsetor":" Químicos ","segmento":" Petroquímicos","patrimonio.liquido":227862000,"lucro.liquido":42069000,"atividades.operacionais":15499000,"total.acoes":1106049,"mil":true,"quantidade":1},{"nome.empresa":"ELEKTRO REDES S.A.","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":2436803000,"lucro.liquido":189964000,"atividades.operacionais":189055000,"total.acoes":623844,"mil":true,"quantidade":1},{"nome.empresa":"ELETROBRÁS PARTICIPAÇÕES S.A. - ELETROPAR","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":169607000,"lucro.liquido":-3362000,"atividades.operacionais":24834000,"total.acoes":1915985,"mil":true,"quantidade":1},{"nome.empresa":"ELETRON S.A.","setor":"Outros","subsetor":" Outros ","segmento":" Outros","patrimonio.liquido":1224736000,"lucro.liquido":34320000,"atividades.operacionais":-1017000,"total.acoes":2,"mil":true,"quantidade":1},{"nome.empresa":"ELETROPAULO METROP. ELET. SAO PAULO S.A.","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":3084547000,"lucro.liquido":200364000,"atividades.operacionais":-86262000,"total.acoes":8133352,"mil":true,"quantidade":1},{"nome.empresa":"EMAE - EMPRESA METROP.AGUAS ENERGIA S.A.","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":902735000,"lucro.liquido":33880000,"atividades.operacionais":73905000,"total.acoes":22189646,"mil":true,"quantidade":1},{"nome.empresa":"EMBRAER S.A.","setor":"Bens Industriais","subsetor":" Material de Transporte ","segmento":" Material Aeronáutico e de Defesa","patrimonio.liquido":14984326000,"lucro.liquido":-122021000,"atividades.operacionais":-1175565000,"total.acoes":735868554,"mil":true,"quantidade":1},{"nome.empresa":"EMPRESA CONC RODOV DO NORTE S.A.ECONORTE","setor":"Bens Industriais","subsetor":" Transporte ","segmento":" Exploração de Rodovias","patrimonio.liquido":-112323000,"lucro.liquido":-6890000,"atividades.operacionais":17141000,"total.acoes":18928597,"mil":true,"quantidade":1},{"nome.empresa":"EMPRESA NAC COM REDITO PART S.A.ENCORPAR","setor":"Consumo Cíclico","subsetor":" Tecidos. Vestuário e Calçados ","segmento":" Fios e Tecidos","patrimonio.liquido":205333000,"lucro.liquido":3215000,"atividades.operacionais":-1157000,"total.acoes":337760,"mil":true,"quantidade":1},{"nome.empresa":"ENAUTA PARTICIPAÇÕES S.A.","setor":"Petróleo. Gás e Biocombustíveis","subsetor":" Petróleo. Gás e Biocombustíveis ","segmento":" Exploração. Refino e Distribuição","patrimonio.liquido":2744900000,"lucro.liquido":71380000,"atividades.operacionais":266320000,"total.acoes":75621071,"mil":true,"quantidade":1},{"nome.empresa":"ENERGISA MATO GROSSO DO SUL - DIST DE ENERGIA S.A.","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":847183000,"lucro.liquido":164463000,"atividades.operacionais":96260000,"total.acoes":421,"mil":true,"quantidade":1},{"nome.empresa":"ENERGISA MATO GROSSO-DISTRIBUIDORA DE ENERGIA S/A","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":1808049000,"lucro.liquido":246516000,"atividades.operacionais":467596000,"total.acoes":5354258,"mil":true,"quantidade":1},{"nome.empresa":"ENERGISA S.A.","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":6284978000,"lucro.liquido":119914000,"atividades.operacionais":1075777000,"total.acoes":1250895290,"mil":true,"quantidade":1},{"nome.empresa":"ENEVA S.A","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":6436436000,"lucro.liquido":145081000,"atividades.operacionais":544666000,"total.acoes":315323423,"mil":true,"quantidade":1},{"nome.empresa":"ENGIE BRASIL ENERGIA S.A.","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":7194673000,"lucro.liquido":950858000,"atividades.operacionais":1680026000,"total.acoes":254813401,"mil":true,"quantidade":1},{"nome.empresa":"EQUATORIAL ENERGIA S.A.","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":7091452000,"lucro.liquido":667190000,"atividades.operacionais":-760304000,"total.acoes":198202097,"mil":true,"quantidade":1},{"nome.empresa":"ESTACIO PARTICIPACOES S.A.","setor":"Consumo Cíclico","subsetor":" Diversos ","segmento":" Serviços Educacionais","patrimonio.liquido":3033730000,"lucro.liquido":435570000,"atividades.operacionais":428048000,"total.acoes":299667897,"mil":true,"quantidade":1},{"nome.empresa":"ETERNIT S.A.","setor":"Bens Industriais","subsetor":" Construção e Engenharia ","segmento":" Produtos para Construção","patrimonio.liquido":-42749000,"lucro.liquido":-54998000,"atividades.operacionais":-24805000,"total.acoes":29585948,"mil":true,"quantidade":1},{"nome.empresa":"EUCATEX S.A. INDUSTRIA E COMERCIO","setor":"Materiais Básicos","subsetor":" Madeira e Papel ","segmento":" Madeira","patrimonio.liquido":1288247000,"lucro.liquido":25584000,"atividades.operacionais":105032000,"total.acoes":68615887,"mil":true,"quantidade":1},{"nome.empresa":"EVEN CONSTRUTORA E INCORPORADORA S.A.","setor":"Consumo Cíclico","subsetor":" Construção Civil ","segmento":" Incorporações","patrimonio.liquido":1886945000,"lucro.liquido":84668000,"atividades.operacionais":143087000,"total.acoes":205280287,"mil":true,"quantidade":1},{"nome.empresa":"EXCELSIOR ALIMENTOS S.A.","setor":"Consumo não Cíclico","subsetor":" Alimentos Processados ","segmento":" Carnes e Derivados","patrimonio.liquido":69559000,"lucro.liquido":20412000,"atividades.operacionais":9605000,"total.acoes":1508636,"mil":true,"quantidade":1},{"nome.empresa":"EZ TEC EMPREEND. E PARTICIPACOES S.A.","setor":"Consumo Cíclico","subsetor":" Construção Civil ","segmento":" Incorporações","patrimonio.liquido":2751313000,"lucro.liquido":113125000,"atividades.operacionais":65171000,"total.acoes":68626741,"mil":true,"quantidade":1},{"nome.empresa":"FERREIRA GOMES ENERGIA S.A.","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":870245000,"lucro.liquido":-10385000,"atividades.operacionais":38899000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"FERROVIA CENTRO-ATLANTICA S.A.","setor":"Bens Industriais","subsetor":" Transporte ","segmento":" Transporte Ferroviário","patrimonio.liquido":5002277000,"lucro.liquido":-149376000,"atividades.operacionais":352321000,"total.acoes":24,"mil":true,"quantidade":1},{"nome.empresa":"FERTILIZANTES HERINGER S.A.","setor":"Materiais Básicos","subsetor":" Químicos ","segmento":" Fertilizantes e Defensivos","patrimonio.liquido":-732408000,"lucro.liquido":-110572000,"atividades.operacionais":-49075000,"total.acoes":15626962,"mil":true,"quantidade":1},{"nome.empresa":"FINANCEIRA ALFA S.A.- CRED FINANC E INVS","setor":"Financeiro","subsetor":" Intermediários Financeiros ","segmento":" Soc. Crédito e Financiamento","patrimonio.liquido":923271000,"lucro.liquido":30047000,"atividades.operacionais":-57092000,"total.acoes":25048128,"mil":true,"quantidade":1},{"nome.empresa":"FINANSINOS S.A.- CREDITO FINANC E INVEST","setor":"Financeiro","subsetor":" Intermediários Financeiros ","segmento":" Soc. Crédito e Financiamento","patrimonio.liquido":13829000,"lucro.liquido":115000,"atividades.operacionais":202000,"total.acoes":303030,"mil":true,"quantidade":1},{"nome.empresa":"FLEURY S.A.","setor":"Saúde","subsetor":" Serv.Méd.Hospit..Análises e Diagnósticos ","segmento":" Serv.Méd.Hospit..Análises e Diagnósticos","patrimonio.liquido":1702584000,"lucro.liquido":165171000,"atividades.operacionais":273187000,"total.acoes":305082672,"mil":true,"quantidade":1},{"nome.empresa":"FLEX GESTÃO DE RELACIONAMENTOS S.A.","setor":"Bens Industriais","subsetor":" Serviços ","segmento":" Serviços Diversos","patrimonio.liquido":67716000,"lucro.liquido":-3910000,"atividades.operacionais":-11438000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"FRAS-LE S.A.","setor":"Bens Industriais","subsetor":" Material de Transporte ","segmento":" Material Rodoviário","patrimonio.liquido":814282000,"lucro.liquido":25449000,"atividades.operacionais":33199000,"total.acoes":102565350,"mil":true,"quantidade":1},{"nome.empresa":"GAFISA S.A.","setor":"Consumo Cíclico","subsetor":" Construção Civil ","segmento":" Incorporações","patrimonio.liquido":575353000,"lucro.liquido":-59076000,"atividades.operacionais":-9972000,"total.acoes":67798040,"mil":true,"quantidade":1},{"nome.empresa":"GAIA AGRO SECURITIZADORA S.A.","setor":"Financeiro","subsetor":" Securitizadoras de Recebíveis ","segmento":" Securitizadoras de Recebíveis","patrimonio.liquido":-12000,"lucro.liquido":-180000,"atividades.operacionais":8000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"GAIA SECURITIZADORA S.A.","setor":"Financeiro","subsetor":" Securitizadoras de Recebíveis ","segmento":" Securitizadoras de Recebíveis","patrimonio.liquido":794000,"lucro.liquido":87000,"atividades.operacionais":0,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"GAMA PARTICIPACOES S.A.","setor":"Outros","subsetor":" Outros ","segmento":" Outros","patrimonio.liquido":1258000,"lucro.liquido":-73000,"atividades.operacionais":-81000,"total.acoes":417,"mil":true,"quantidade":1},{"nome.empresa":"GENERAL SHOPPING E OUTLETS DO BRASIL S.A.","setor":"Financeiro","subsetor":" Exploração de Imóveis ","segmento":" Exploração de Imóveis","patrimonio.liquido":7532000,"lucro.liquido":-31151000,"atividades.operacionais":-29114000,"total.acoes":67506100,"mil":true,"quantidade":1},{"nome.empresa":"GERDAU S.A.","setor":"Materiais Básicos","subsetor":" Siderurgia e Metalurgia ","segmento":" Siderurgia","patrimonio.liquido":26568445000,"lucro.liquido":825377000,"atividades.operacionais":229733000,"total.acoes":1040248828,"mil":true,"quantidade":1},{"nome.empresa":"GOL LINHAS AEREAS INTELIGENTES S.A.","setor":"Bens Industriais","subsetor":" Transporte ","segmento":" Transporte Aéreo","patrimonio.liquido":-6997512000,"lucro.liquido":-85618000,"atividades.operacionais":795115000,"total.acoes":134613917,"mil":true,"quantidade":1},{"nome.empresa":"GP INVESTMENTS. LTD.","setor":"Financeiro","subsetor":" Serviços Financeiros Diversos ","segmento":" Gestão de Recursos e Investimentos","patrimonio.liquido":2536572000,"lucro.liquido":246967000,"atividades.operacionais":-27998000,"total.acoes":67776390,"mil":true,"quantidade":1},{"nome.empresa":"GPC PARTICIPACOES S.A.","setor":"Materiais Básicos","subsetor":" Químicos ","segmento":" Petroquímicos","patrimonio.liquido":189579000,"lucro.liquido":8132000,"atividades.operacionais":-18927000,"total.acoes":6267569,"mil":true,"quantidade":1},{"nome.empresa":"GRAZZIOTIN S.A.","setor":"Consumo Cíclico","subsetor":" Comércio ","segmento":" Tecidos. Vestuário e Calçados","patrimonio.liquido":519373475,"lucro.liquido":20338805,"atividades.operacionais":10139428,"total.acoes":11049599,"mil":false,"quantidade":1},{"nome.empresa":"GRENDENE S.A.","setor":"Consumo Cíclico","subsetor":" Tecidos. Vestuário e Calçados ","segmento":" Calçados","patrimonio.liquido":3430816000,"lucro.liquido":118042000,"atividades.operacionais":336071000,"total.acoes":270820595,"mil":true,"quantidade":1},{"nome.empresa":"GRUPO SBF SA","setor":"Consumo Cíclico","subsetor":" Comércio ","segmento":" Produtos Diversos","patrimonio.liquido":953235000,"lucro.liquido":107686000,"atividades.operacionais":-332444000,"total.acoes":56408109,"mil":true,"quantidade":1},{"nome.empresa":"GUARARAPES CONFECCOES S.A.","setor":"Consumo Cíclico","subsetor":" Comércio ","segmento":" Tecidos. Vestuário e Calçados","patrimonio.liquido":4969287000,"lucro.liquido":84215000,"atividades.operacionais":-270565000,"total.acoes":86115120,"mil":true,"quantidade":1},{"nome.empresa":"HAGA S.A. INDUSTRIA E COMERCIO","setor":"Bens Industriais","subsetor":" Construção e Engenharia ","segmento":" Produtos para Construção","patrimonio.liquido":-80991930,"lucro.liquido":-2981175,"atividades.operacionais":677181,"total.acoes":9013373,"mil":false,"quantidade":1},{"nome.empresa":"HAPVIDA PARTICIPACOES E INVESTIMENTOS SA","setor":"Saúde","subsetor":" Serv.Méd.Hospit..Análises e Diagnósticos ","segmento":" Serv.Méd.Hospit..Análises e Diagnósticos","patrimonio.liquido":3929183000,"lucro.liquido":428803000,"atividades.operacionais":375446000,"total.acoes":146032921,"mil":true,"quantidade":1},{"nome.empresa":"HELBOR EMPREENDIMENTOS S.A.","setor":"Consumo Cíclico","subsetor":" Construção Civil ","segmento":" Incorporações","patrimonio.liquido":1120446000,"lucro.liquido":-47914000,"atividades.operacionais":120299000,"total.acoes":179586997,"mil":true,"quantidade":1},{"nome.empresa":"HERCULES S.A. FABRICA DE TALHERES","setor":"Consumo Cíclico","subsetor":" Utilidades Domésticas ","segmento":" Utensílios Domésticos","patrimonio.liquido":-386358000,"lucro.liquido":50000,"atividades.operacionais":0,"total.acoes":243750,"mil":true,"quantidade":1},{"nome.empresa":"HOTEIS OTHON S.A.","setor":"Consumo Cíclico","subsetor":" Hoteis e Restaurantes ","segmento":" Hotelaria","patrimonio.liquido":-258683000,"lucro.liquido":-12083000,"atividades.operacionais":2579000,"total.acoes":2562885,"mil":true,"quantidade":1},{"nome.empresa":"HYPERA S.A.","setor":"Saúde","subsetor":" Comércio e Distribuição ","segmento":" Medicamentos e Outros Produtos","patrimonio.liquido":8557617000,"lucro.liquido":658127000,"atividades.operacionais":387164000,"total.acoes":407518048,"mil":true,"quantidade":1},{"nome.empresa":"IDEIASNET S.A.","setor":"Financeiro","subsetor":" Serviços Financeiros Diversos ","segmento":" Serviços Financeiros Diversos","patrimonio.liquido":15080000,"lucro.liquido":2160000,"atividades.operacionais":-2777000,"total.acoes":16317766,"mil":true,"quantidade":1},{"nome.empresa":"IGB ELETRÔNICA S/A","setor":"Financeiro","subsetor":" Exploração de Imóveis ","segmento":" Exploração de Imóveis","patrimonio.liquido":-861333000,"lucro.liquido":-22097000,"atividades.operacionais":514000,"total.acoes":6048759,"mil":true,"quantidade":1},{"nome.empresa":"IGUA SANEAMENTO S.A.","setor":"Utilidade Pública","subsetor":" água e Saneamento ","segmento":" água e Saneamento","patrimonio.liquido":756906000,"lucro.liquido":8679000,"atividades.operacionais":11130000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"IGUATEMI EMPRESA DE SHOPPING CENTERS S.A","setor":"Financeiro","subsetor":" Exploração de Imóveis ","segmento":" Exploração de Imóveis","patrimonio.liquido":2872547000,"lucro.liquido":115565000,"atividades.operacionais":196289000,"total.acoes":86913923,"mil":true,"quantidade":1},{"nome.empresa":"INDUSTRIAS J B DUARTE S.A.","setor":"Outros","subsetor":" Outros ","segmento":" Outros","patrimonio.liquido":14496000,"lucro.liquido":16629000,"atividades.operacionais":251000,"total.acoes":4161639,"mil":true,"quantidade":1},{"nome.empresa":"INDUSTRIAS ROMI S.A.","setor":"Bens Industriais","subsetor":" Máquinas e Equipamentos ","segmento":" Máq. e Equip. Industriais","patrimonio.liquido":748548000,"lucro.liquido":82953000,"atividades.operacionais":-11527000,"total.acoes":29455637,"mil":true,"quantidade":1},{"nome.empresa":"INEPAR S.A. INDUSTRIA E CONSTRUCOES","setor":"Bens Industriais","subsetor":" Máquinas e Equipamentos ","segmento":" Máq. e Equip. Industriais","patrimonio.liquido":-1619895000,"lucro.liquido":-33613000,"atividades.operacionais":-3184000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"INNCORP S.A.","setor":"Outros","subsetor":" Outros ","segmento":" Outros","patrimonio.liquido":-167916,"lucro.liquido":-154354,"atividades.operacionais":-3909,"total.acoes":0,"mil":false,"quantidade":1},{"nome.empresa":"INSTITUTO HERMES PARDINI S.A.","setor":"Saúde","subsetor":" Serv.Méd.Hospit..Análises e Diagnósticos ","segmento":" Serv.Méd.Hospit..Análises e Diagnósticos","patrimonio.liquido":636670000,"lucro.liquido":70757000,"atividades.operacionais":110632000,"total.acoes":44851196,"mil":true,"quantidade":1},{"nome.empresa":"INTER CONSTRUTORA E INCORPORADORA S.A.","setor":"Consumo Cíclico","subsetor":" Construção Civil ","segmento":" Incorporações","patrimonio.liquido":58356783,"lucro.liquido":11317819,"atividades.operacionais":-24494879,"total.acoes":0,"mil":false,"quantidade":1},{"nome.empresa":"INTERNATIONAL MEAL COMPANY ALIMENTACAO S.A.","setor":"Consumo Cíclico","subsetor":" Hoteis e Restaurantes ","segmento":" Restaurante e Similares","patrimonio.liquido":912500000,"lucro.liquido":-7276000,"atividades.operacionais":53438000,"total.acoes":156768224,"mil":true,"quantidade":1},{"nome.empresa":"INVESTIMENTOS BEMGE S.A.","setor":"Outros","subsetor":" Outros ","segmento":" Outros","patrimonio.liquido":224159000,"lucro.liquido":4133000,"atividades.operacionais":0,"total.acoes":42570,"mil":true,"quantidade":1},{"nome.empresa":"INVESTIMENTOS E PARTICIP. EM INFRA S.A. - INVEPAR","setor":"Bens Industriais","subsetor":" Transporte ","segmento":" Serviços de Apoio e Armazenagem","patrimonio.liquido":1051356000,"lucro.liquido":-740355000,"atividades.operacionais":674251000,"total.acoes":214585684,"mil":true,"quantidade":1},{"nome.empresa":"IOCHPE MAXION S.A.","setor":"Consumo Cíclico","subsetor":" Automóveis e Motocicletas ","segmento":" Automóveis e Motocicletas","patrimonio.liquido":3330064000,"lucro.liquido":211116000,"atividades.operacionais":36663000,"total.acoes":139973015,"mil":true,"quantidade":1},{"nome.empresa":"IRB - BRASIL RESSEGUROS S.A.","setor":"Financeiro","subsetor":" Previdência e Seguros ","segmento":" Seguradoras","patrimonio.liquido":3982188000,"lucro.liquido":738851000,"atividades.operacionais":1207884000,"total.acoes":310415298,"mil":true,"quantidade":1},{"nome.empresa":"ITAPEBI GERACAO DE ENERGIA S.A.","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":318305000,"lucro.liquido":43017000,"atividades.operacionais":55061000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"ITAU UNIBANCO HOLDING S.A.","setor":"Financeiro","subsetor":" Intermediários Financeiros ","segmento":" Bancos","patrimonio.liquido":143813000000,"lucro.liquido":13593000000,"atividades.operacionais":6413000,"total.acoes":5126116234,"mil":true,"quantidade":1},{"nome.empresa":"ITAUSA INVESTIMENTOS ITAU S.A.","setor":"Financeiro","subsetor":" Intermediários Financeiros ","segmento":" Bancos","patrimonio.liquido":55357000000,"lucro.liquido":4980000000,"atividades.operacionais":-80000000,"total.acoes":5555380740,"mil":true,"quantidade":1},{"nome.empresa":"J. MACEDO S.A.","setor":"Consumo não Cíclico","subsetor":" Alimentos Processados ","segmento":" Alimentos Diversos","patrimonio.liquido":616282000,"lucro.liquido":-7006000,"atividades.operacionais":-235673000,"total.acoes":21832197,"mil":true,"quantidade":1},{"nome.empresa":"JBS S.A.","setor":"Consumo não Cíclico","subsetor":" Alimentos Processados ","segmento":" Carnes e Derivados","patrimonio.liquido":31118771000,"lucro.liquido":3497383000,"atividades.operacionais":4296421000,"total.acoes":1620646499,"mil":true,"quantidade":1},{"nome.empresa":"JEREISSATI PARTICIPACOES S.A.","setor":"Financeiro","subsetor":" Exploração de Imóveis ","segmento":" Exploração de Imóveis","patrimonio.liquido":2903266000,"lucro.liquido":101241000,"atividades.operacionais":205478000,"total.acoes":34873611,"mil":true,"quantidade":1},{"nome.empresa":"JHSF PARTICIPACOES S.A.","setor":"Consumo Cíclico","subsetor":" Construção Civil ","segmento":" Incorporações","patrimonio.liquido":2280376000,"lucro.liquido":21878000,"atividades.operacionais":-7943000,"total.acoes":134728334,"mil":true,"quantidade":1},{"nome.empresa":"JOAO FORTES ENGENHARIA S.A.","setor":"Consumo Cíclico","subsetor":" Construção Civil ","segmento":" Incorporações","patrimonio.liquido":260839000,"lucro.liquido":-427819000,"atividades.operacionais":166351000,"total.acoes":4930157,"mil":true,"quantidade":1},{"nome.empresa":"JOSAPAR-JOAQUIM OLIVEIRA S.A. - PARTICIP","setor":"Consumo não Cíclico","subsetor":" Alimentos Processados ","segmento":" Alimentos Diversos","patrimonio.liquido":666168000,"lucro.liquido":5895000,"atividades.operacionais":-137991000,"total.acoes":2125174,"mil":true,"quantidade":1},{"nome.empresa":"JSL S.A.","setor":"Bens Industriais","subsetor":" Transporte ","segmento":" Transporte Rodoviário","patrimonio.liquido":1499172000,"lucro.liquido":131920000,"atividades.operacionais":-721943000,"total.acoes":55040438,"mil":true,"quantidade":1},{"nome.empresa":"KARSTEN S.A.","setor":"Consumo Cíclico","subsetor":" Tecidos. Vestuário e Calçados ","segmento":" Fios e Tecidos","patrimonio.liquido":-307127000,"lucro.liquido":-47304000,"atividades.operacionais":27458000,"total.acoes":888075,"mil":true,"quantidade":1},{"nome.empresa":"KEPLER WEBER S.A.","setor":"Bens Industriais","subsetor":" Máquinas e Equipamentos ","segmento":" Máq. e Equip. Industriais","patrimonio.liquido":441589000,"lucro.liquido":564000,"atividades.operacionais":-184000,"total.acoes":26293632,"mil":true,"quantidade":1},{"nome.empresa":"KLABIN S.A.","setor":"Materiais Básicos","subsetor":" Madeira e Papel ","segmento":" Papel e Celulose","patrimonio.liquido":6203440000,"lucro.liquido":-123914000,"atividades.operacionais":963768000,"total.acoes":3011132125,"mil":true,"quantidade":1},{"nome.empresa":"KROTON EDUCACIONAL S.A.","setor":"Consumo Cíclico","subsetor":" Diversos ","segmento":" Serviços Educacionais","patrimonio.liquido":16050647000,"lucro.liquido":389987000,"atividades.operacionais":-108040000,"total.acoes":1498404420,"mil":true,"quantidade":1},{"nome.empresa":"LIBRA TERMINAL RIO S.A.","setor":"Bens Industriais","subsetor":" Transporte ","segmento":" Serviços de Apoio e Armazenagem","patrimonio.liquido":-164144000,"lucro.liquido":26203000,"atividades.operacionais":67230000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"LIGHT S.A.","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":3564521000,"lucro.liquido":175029000,"atividades.operacionais":399676000,"total.acoes":303934060,"mil":true,"quantidade":1},{"nome.empresa":"LIGHT SERVICOS DE ELETRICIDADE S.A.","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":2411587000,"lucro.liquido":-34542000,"atividades.operacionais":103293000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"LINX S.A.","setor":"Tecnologia da Informação","subsetor":" Programas e Serviços ","segmento":" Programas e Serviços","patrimonio.liquido":1875324000,"lucro.liquido":29648000,"atividades.operacionais":81421000,"total.acoes":160913029,"mil":true,"quantidade":1},{"nome.empresa":"LIQ PARTICIPAÇÕES S.A.","setor":"Bens Industriais","subsetor":" Serviços ","segmento":" Serviços Diversos","patrimonio.liquido":72291000,"lucro.liquido":-169021000,"atividades.operacionais":-14444000,"total.acoes":21901312,"mil":true,"quantidade":1},{"nome.empresa":"LITEL PARTICIPACOES S.A.","setor":"Materiais Básicos","subsetor":" Mineração ","segmento":" Minerais Metálicos","patrimonio.liquido":31300951000,"lucro.liquido":-1437331000,"atividades.operacionais":1385000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"LOCALIZA RENT A CAR S.A.","setor":"Consumo Cíclico","subsetor":" Diversos ","segmento":" Aluguel de carros","patrimonio.liquido":5150576000,"lucro.liquido":400867000,"atividades.operacionais":-1125777000,"total.acoes":560843706,"mil":true,"quantidade":1},{"nome.empresa":"LOG COMMERCIAL PROPERTIES","setor":"Financeiro","subsetor":" Exploração de Imóveis ","segmento":" Exploração de Imóveis","patrimonio.liquido":2287570000,"lucro.liquido":29526000,"atividades.operacionais":35101000,"total.acoes":47750725,"mil":true,"quantidade":1},{"nome.empresa":"LOG-IN LOGISTICA INTERMODAL S.A.","setor":"Bens Industriais","subsetor":" Transporte ","segmento":" Transporte Hidroviário","patrimonio.liquido":-336930000,"lucro.liquido":14912000,"atividades.operacionais":146701000,"total.acoes":20260349,"mil":true,"quantidade":1},{"nome.empresa":"LOJAS AMERICANAS S.A.","setor":"Consumo Cíclico","subsetor":" Comércio ","segmento":" Produtos Diversos","patrimonio.liquido":6039922000,"lucro.liquido":-43462000,"atividades.operacionais":-368567000,"total.acoes":887233239,"mil":true,"quantidade":1},{"nome.empresa":"LOJAS RENNER S.A.","setor":"Consumo Cíclico","subsetor":" Comércio ","segmento":" Tecidos. Vestuário e Calçados","patrimonio.liquido":4112250000,"lucro.liquido":396744000,"atividades.operacionais":507101000,"total.acoes":781384541,"mil":true,"quantidade":1},{"nome.empresa":"LONGDIS S.A.","setor":"Outros","subsetor":" Outros ","segmento":" Outros","patrimonio.liquido":-132535,"lucro.liquido":-136350,"atividades.operacionais":-2424,"total.acoes":24013,"mil":false,"quantidade":1},{"nome.empresa":"LPS BRASIL - CONSULTORIA DE IMOVEIS S.A.","setor":"Financeiro","subsetor":" Exploração de Imóveis ","segmento":" Intermediação Imobiliária","patrimonio.liquido":32208000,"lucro.liquido":-11789000,"atividades.operacionais":8983000,"total.acoes":93546908,"mil":true,"quantidade":1},{"nome.empresa":"LUPATECH S.A.","setor":"Petróleo. Gás e Biocombustíveis","subsetor":" Petróleo. Gás e Biocombustíveis ","segmento":" Equipamentos e Serviços","patrimonio.liquido":101497000,"lucro.liquido":-32711000,"atividades.operacionais":-488000,"total.acoes":21736590,"mil":true,"quantidade":1},{"nome.empresa":"M.DIAS BRANCO S.A. IND COM DE ALIMENTOS","setor":"Consumo não Cíclico","subsetor":" Alimentos Processados ","segmento":" Alimentos Diversos","patrimonio.liquido":5670178000,"lucro.liquido":157553000,"atividades.operacionais":432649000,"total.acoes":84751852,"mil":true,"quantidade":1},{"nome.empresa":"MAESTRO LOCADORA DE VEICULOS S.A.","setor":"Consumo Cíclico","subsetor":" Diversos ","segmento":" Aluguel de carros","patrimonio.liquido":49433000,"lucro.liquido":691000,"atividades.operacionais":-741000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"MAGAZINE LUIZA S.A.","setor":"Consumo Cíclico","subsetor":" Comércio ","segmento":" Eletrodomésticos","patrimonio.liquido":3110946000,"lucro.liquido":518730000,"atividades.operacionais":231726000,"total.acoes":554184304,"mil":true,"quantidade":1},{"nome.empresa":"MAHLE-METAL LEVE S.A.","setor":"Consumo Cíclico","subsetor":" Automóveis e Motocicletas ","segmento":" Automóveis e Motocicletas","patrimonio.liquido":1275575000,"lucro.liquido":121379000,"atividades.operacionais":127124000,"total.acoes":38492519,"mil":true,"quantidade":1},{"nome.empresa":"MANGELS INDUSTRIAL S.A.","setor":"Materiais Básicos","subsetor":" Siderurgia e Metalurgia ","segmento":" Artefatos de Ferro e Aço","patrimonio.liquido":-356711000,"lucro.liquido":7414000,"atividades.operacionais":6988000,"total.acoes":2532157,"mil":true,"quantidade":1},{"nome.empresa":"MANUFATURA DE BRINQUEDOS ESTRELA S.A.","setor":"Consumo Cíclico","subsetor":" Viagens e Lazer ","segmento":" Brinquedos e Jogos","patrimonio.liquido":-462560000,"lucro.liquido":-24899000,"atividades.operacionais":6823000,"total.acoes":553100,"mil":true,"quantidade":1},{"nome.empresa":"MARCOPOLO S.A.","setor":"Bens Industriais","subsetor":" Material de Transporte ","segmento":" Material Rodoviário","patrimonio.liquido":2229511000,"lucro.liquido":117899000,"atividades.operacionais":292885000,"total.acoes":747097003,"mil":true,"quantidade":1},{"nome.empresa":"MARFRIG GLOBAL FOODS S.A.","setor":"Consumo não Cíclico","subsetor":" Alimentos Processados ","segmento":" Carnes e Derivados","patrimonio.liquido":4209277000,"lucro.liquido":542372000,"atividades.operacionais":164470000,"total.acoes":386047807,"mil":true,"quantidade":1},{"nome.empresa":"MARISA LOJAS S.A.","setor":"Consumo Cíclico","subsetor":" Comércio ","segmento":" Tecidos. Vestuário e Calçados","patrimonio.liquido":905227000,"lucro.liquido":-69148000,"atividades.operacionais":40973000,"total.acoes":52529246,"mil":true,"quantidade":1},{"nome.empresa":"MENDES JUNIOR ENGENHARIA S.A.","setor":"Bens Industriais","subsetor":" Construção e Engenharia ","segmento":" Construção Pesada","patrimonio.liquido":-10862575000,"lucro.liquido":-145977000,"atividades.operacionais":313000,"total.acoes":331286,"mil":true,"quantidade":1},{"nome.empresa":"MERCANTIL BRASIL FINANC S.A. C.F.I.","setor":"Financeiro","subsetor":" Intermediários Financeiros ","segmento":" Soc. Crédito e Financiamento","patrimonio.liquido":241218000,"lucro.liquido":11297000,"atividades.operacionais":57459000,"total.acoes":2592615,"mil":true,"quantidade":1},{"nome.empresa":"METALFRIO SOLUTIONS S.A.","setor":"Bens Industriais","subsetor":" Máquinas e Equipamentos ","segmento":" Máq. e Equip. Industriais","patrimonio.liquido":108222000,"lucro.liquido":34010000,"atividades.operacionais":10132000,"total.acoes":1895139,"mil":true,"quantidade":1},{"nome.empresa":"METALGRAFICA IGUACU S.A.","setor":"Materiais Básicos","subsetor":" Embalagens ","segmento":" Embalagens","patrimonio.liquido":19822010,"lucro.liquido":-4735399,"atividades.operacionais":3885208,"total.acoes":43163,"mil":false,"quantidade":1},{"nome.empresa":"METALURGICA GERDAU S.A.","setor":"Materiais Básicos","subsetor":" Siderurgia e Metalurgia ","segmento":" Siderurgia","patrimonio.liquido":26380817000,"lucro.liquido":807473000,"atividades.operacionais":193300000,"total.acoes":667958182,"mil":true,"quantidade":1},{"nome.empresa":"METALURGICA RIOSULENSE S.A.","setor":"Bens Industriais","subsetor":" Material de Transporte ","segmento":" Material Rodoviário","patrimonio.liquido":-12254000,"lucro.liquido":7665000,"atividades.operacionais":5707000,"total.acoes":139898,"mil":true,"quantidade":1},{"nome.empresa":"METISA METALURGICA TIMBOENSE S.A.","setor":"Bens Industriais","subsetor":" Máquinas e Equipamentos ","segmento":" Máq. e Equip. Construção e Agrícolas","patrimonio.liquido":235232587,"lucro.liquido":8222364,"atividades.operacionais":15232528,"total.acoes":3304003,"mil":false,"quantidade":1},{"nome.empresa":"MGI - MINAS GERAIS PARTICIPAÇÕES S.A.","setor":"Outros","subsetor":" Outros ","segmento":" Outros","patrimonio.liquido":419631000,"lucro.liquido":-19270000,"atividades.operacionais":18338000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"MILLS ESTRUTURAS E SERVIÇOS DE ENGENHARIA S.A.","setor":"Bens Industriais","subsetor":" Construção e Engenharia ","segmento":" Serviços Diversos","patrimonio.liquido":1129155000,"lucro.liquido":-22870000,"atividades.operacionais":46214000,"total.acoes":114647292,"mil":true,"quantidade":1},{"nome.empresa":"MINASMAQUINAS S.A.","setor":"Bens Industriais","subsetor":" Comércio ","segmento":" Material de Transporte","patrimonio.liquido":142767000,"lucro.liquido":11315000,"atividades.operacionais":-15732000,"total.acoes":5482,"mil":true,"quantidade":1},{"nome.empresa":"MINERVA S.A.","setor":"Consumo não Cíclico","subsetor":" Alimentos Processados ","segmento":" Carnes e Derivados","patrimonio.liquido":-390322000,"lucro.liquido":-144728000,"atividades.operacionais":561731000,"total.acoes":136456880,"mil":true,"quantidade":1},{"nome.empresa":"MINUPAR PARTICIPACOES S.A.","setor":"Consumo não Cíclico","subsetor":" Alimentos Processados ","segmento":" Carnes e Derivados","patrimonio.liquido":-352216000,"lucro.liquido":7777000,"atividades.operacionais":2608000,"total.acoes":3387083,"mil":true,"quantidade":1},{"nome.empresa":"MMX MINERACAO E METALICOS S.A.","setor":"Materiais Básicos","subsetor":" Mineração ","segmento":" Minerais Metálicos","patrimonio.liquido":-693158000,"lucro.liquido":-80347000,"atividades.operacionais":687000,"total.acoes":2762888,"mil":true,"quantidade":1},{"nome.empresa":"MONTEIRO ARANHA S.A.","setor":"Financeiro","subsetor":" Holdings Diversificadas ","segmento":" Holdings Diversificadas","patrimonio.liquido":1066074000,"lucro.liquido":28239000,"atividades.operacionais":-47390000,"total.acoes":3096937,"mil":true,"quantidade":1},{"nome.empresa":"MOVIDA PARTICIPACOES SA","setor":"Consumo Cíclico","subsetor":" Diversos ","segmento":" Aluguel de carros","patrimonio.liquido":1701417000,"lucro.liquido":83464000,"atividades.operacionais":-705164000,"total.acoes":132725200,"mil":true,"quantidade":1},{"nome.empresa":"MRS LOGISTICA S.A.","setor":"Bens Industriais","subsetor":" Transporte ","segmento":" Transporte Ferroviário","patrimonio.liquido":4079619000,"lucro.liquido":235244000,"atividades.operacionais":423865000,"total.acoes":6261277,"mil":true,"quantidade":1},{"nome.empresa":"MRV ENGENHARIA E PARTICIPACOES S.A.","setor":"Consumo Cíclico","subsetor":" Construção Civil ","segmento":" Incorporações","patrimonio.liquido":4966065000,"lucro.liquido":400974000,"atividades.operacionais":30552000,"total.acoes":292910667,"mil":true,"quantidade":1},{"nome.empresa":"MULTIPLAN - EMPREEND IMOBILIARIOS S.A.","setor":"Financeiro","subsetor":" Exploração de Imóveis ","segmento":" Exploração de Imóveis","patrimonio.liquido":5488442000,"lucro.liquido":205968000,"atividades.operacionais":410567000,"total.acoes":270279854,"mil":true,"quantidade":1},{"nome.empresa":"MUNDIAL S.A. - PRODUTOS DE CONSUMO","setor":"Consumo Cíclico","subsetor":" Tecidos. Vestuário e Calçados ","segmento":" Acessórios","patrimonio.liquido":-139070000,"lucro.liquido":-4321000,"atividades.operacionais":13124000,"total.acoes":1666331,"mil":true,"quantidade":1},{"nome.empresa":"NADIR FIGUEIREDO IND E COM S.A.","setor":"Consumo Cíclico","subsetor":" Utilidades Domésticas ","segmento":" Utensílios Domésticos","patrimonio.liquido":420740000,"lucro.liquido":21616000,"atividades.operacionais":22974000,"total.acoes":440406,"mil":true,"quantidade":1},{"nome.empresa":"NATURA COSMETICOS S.A.","setor":"Consumo não Cíclico","subsetor":" Produtos de Uso Pessoal e de Limpeza ","segmento":" Produtos de Uso Pessoal","patrimonio.liquido":2699139000,"lucro.liquido":69397000,"atividades.operacionais":71219000,"total.acoes":175045801,"mil":true,"quantidade":1},{"nome.empresa":"NEOENERGIA S.A.","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":18284890000,"lucro.liquido":1049787000,"atividades.operacionais":1134247000,"total.acoes":239251040,"mil":true,"quantidade":1},{"nome.empresa":"NORDON INDUSTRIAS METALURGICAS S.A.","setor":"Bens Industriais","subsetor":" Máquinas e Equipamentos ","segmento":" Máq. e Equip. Industriais","patrimonio.liquido":-139789000,"lucro.liquido":-822000,"atividades.operacionais":21000,"total.acoes":71121,"mil":true,"quantidade":1},{"nome.empresa":"NORTEC QUÍMICA S.A.","setor":"Saúde","subsetor":" Medicamentos e Outros Produtos ","segmento":" Medicamentos e Outros Produtos","patrimonio.liquido":127795000,"lucro.liquido":5597000,"atividades.operacionais":3305000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"NOTRE DAME INTERMEDICA PARTICIPACOES SA","setor":"Saúde","subsetor":" Serv.Méd.Hospit..Análises e Diagnósticos ","segmento":" Serv.Méd.Hospit..Análises e Diagnósticos","patrimonio.liquido":2551877000,"lucro.liquido":192488000,"atividades.operacionais":316076000,"total.acoes":364914616,"mil":true,"quantidade":1},{"nome.empresa":"NUTRIPLANT INDUSTRIA E COMERCIO S.A.","setor":"Materiais Básicos","subsetor":" Químicos ","segmento":" Fertilizantes e Defensivos","patrimonio.liquido":-22997000,"lucro.liquido":-1371000,"atividades.operacionais":-524000,"total.acoes":32014,"mil":true,"quantidade":1},{"nome.empresa":"OCTANTE SECURITIZADORA S.A.","setor":"Financeiro","subsetor":" Securitizadoras de Recebíveis ","segmento":" Securitizadoras de Recebíveis","patrimonio.liquido":345000,"lucro.liquido":54000,"atividades.operacionais":-78000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"ODONTOPREV S.A.","setor":"Saúde","subsetor":" Serv.Méd.Hospit..Análises e Diagnósticos ","segmento":" Serv.Méd.Hospit..Análises e Diagnósticos","patrimonio.liquido":1071465000,"lucro.liquido":160549000,"atividades.operacionais":203068000,"total.acoes":263707679,"mil":true,"quantidade":1},{"nome.empresa":"OI S.A.","setor":"Telecomunicações","subsetor":" Telecomunicações ","segmento":" Telecomunicações","patrimonio.liquido":25859489000,"lucro.liquido":-1030482000,"atividades.operacionais":-253148000,"total.acoes":5952358824,"mil":true,"quantidade":1},{"nome.empresa":"OMEGA GERAÇÃO S.A.","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":1971728000,"lucro.liquido":-48464000,"atividades.operacionais":90144000,"total.acoes":45456235,"mil":true,"quantidade":1},{"nome.empresa":"OPPORTUNITY ENERGIA E PARTICIPACOES S.A.","setor":"Outros","subsetor":" Outros ","segmento":" Outros","patrimonio.liquido":21741000,"lucro.liquido":-1399000,"atividades.operacionais":-96000,"total.acoes":23880,"mil":true,"quantidade":1},{"nome.empresa":"OSX BRASIL S.A.","setor":"Petróleo. Gás e Biocombustíveis","subsetor":" Petróleo. Gás e Biocombustíveis ","segmento":" Equipamentos e Serviços","patrimonio.liquido":-4214210000,"lucro.liquido":-199962000,"atividades.operacionais":86000,"total.acoes":1062294,"mil":true,"quantidade":1},{"nome.empresa":"OURINVEST SECURITIZADORA SA","setor":"Não Classificados","subsetor":" Não Classificado ","segmento":" Não Classificados","patrimonio.liquido":1683000,"lucro.liquido":691000,"atividades.operacionais":622000,"total.acoes":826755,"mil":true,"quantidade":1},{"nome.empresa":"OURO FINO SAUDE ANIMAL PARTICIPACOES S.A.","setor":"Saúde","subsetor":" Medicamentos e Outros Produtos ","segmento":" Medicamentos e Outros Produtos","patrimonio.liquido":465041000,"lucro.liquido":8576000,"atividades.operacionais":50013000,"total.acoes":23568833,"mil":true,"quantidade":1},{"nome.empresa":"OURO VERDE LOCACAO E SERVICO S.A.","setor":"Não Classificados","subsetor":" Não Classificado ","segmento":" Não Classificados","patrimonio.liquido":66886000,"lucro.liquido":-44550000,"atividades.operacionais":78126000,"total.acoes":371975418,"mil":true,"quantidade":1},{"nome.empresa":"PANATLANTICA S.A.","setor":"Materiais Básicos","subsetor":" Siderurgia e Metalurgia ","segmento":" Artefatos de Ferro e Aço","patrimonio.liquido":425358000,"lucro.liquido":11559000,"atividades.operacionais":44192000,"total.acoes":832841,"mil":true,"quantidade":1},{"nome.empresa":"PARANA BCO S.A.","setor":"Financeiro","subsetor":" Intermediários Financeiros ","segmento":" Bancos","patrimonio.liquido":1448021000,"lucro.liquido":134069000,"atividades.operacionais":322109000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"PARANAPANEMA S.A.","setor":"Materiais Básicos","subsetor":" Siderurgia e Metalurgia ","segmento":" Artefatos de Cobre","patrimonio.liquido":690033000,"lucro.liquido":63885000,"atividades.operacionais":33699000,"total.acoes":41349361,"mil":true,"quantidade":1},{"nome.empresa":"PATRIA CIA SECURITIZADORA DE CRED IMOB","setor":"Financeiro","subsetor":" Securitizadoras de Recebíveis ","segmento":" Securitizadoras de Recebíveis","patrimonio.liquido":23000,"lucro.liquido":-171000,"atividades.operacionais":-178000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"PBG S/A","setor":"Bens Industriais","subsetor":" Construção e Engenharia ","segmento":" Produtos para Construção","patrimonio.liquido":369500000,"lucro.liquido":6937000,"atividades.operacionais":-40067000,"total.acoes":73786991,"mil":true,"quantidade":1},{"nome.empresa":"PDG COMPANHIA SECURITIZADORA","setor":"Financeiro","subsetor":" Securitizadoras de Recebíveis ","segmento":" Securitizadoras de Recebíveis","patrimonio.liquido":35027000,"lucro.liquido":38000,"atividades.operacionais":567000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"PDG REALTY S.A. EMPREEND E PARTICIPACOES","setor":"Consumo Cíclico","subsetor":" Construção Civil ","segmento":" Incorporações","patrimonio.liquido":-4503035000,"lucro.liquido":-493486000,"atividades.operacionais":105926000,"total.acoes":8066955,"mil":true,"quantidade":1},{"nome.empresa":"PETRO RIO S.A.","setor":"Petróleo. Gás e Biocombustíveis","subsetor":" Petróleo. Gás e Biocombustíveis ","segmento":" Exploração. Refino e Distribuição","patrimonio.liquido":1199843000,"lucro.liquido":109301000,"atividades.operacionais":377542000,"total.acoes":126730759,"mil":true,"quantidade":1},{"nome.empresa":"PETROBRAS DISTRIBUIDORA S/A","setor":"Petróleo. Gás e Biocombustíveis","subsetor":" Petróleo. Gás e Biocombustíveis ","segmento":" Exploração. Refino e Distribuição","patrimonio.liquido":8266000000,"lucro.liquido":779000000,"atividades.operacionais":958000000,"total.acoes":334937500,"mil":true,"quantidade":1},{"nome.empresa":"PETROLEO BRASILEIRO S.A. PETROBRAS","setor":"Petróleo. Gás e Biocombustíveis","subsetor":" Petróleo. Gás e Biocombustíveis ","segmento":" Exploração. Refino e Distribuição","patrimonio.liquido":309418000000,"lucro.liquido":23592000000,"atividades.operacionais":38249000000,"total.acoes":7470043315,"mil":true,"quantidade":1},{"nome.empresa":"PETTENATI S.A. INDUSTRIA TEXTIL","setor":"Consumo Cíclico","subsetor":" Tecidos. Vestuário e Calçados ","segmento":" Fios e Tecidos","patrimonio.liquido":240264504,"lucro.liquido":22616880,"atividades.operacionais":22533362,"total.acoes":31950788,"mil":false,"quantidade":1},{"nome.empresa":"PLASCAR PARTICIPACOES INDUSTRIAIS S.A.","setor":"Consumo Cíclico","subsetor":" Automóveis e Motocicletas ","segmento":" Automóveis e Motocicletas","patrimonio.liquido":-167991000,"lucro.liquido":-102613000,"atividades.operacionais":-23745000,"total.acoes":4970927,"mil":true,"quantidade":1},{"nome.empresa":"POLO CAPITAL SECURITIZADORA S.A","setor":"Financeiro","subsetor":" Securitizadoras de Recebíveis ","segmento":" Securitizadoras de Recebíveis","patrimonio.liquido":752000,"lucro.liquido":-48000,"atividades.operacionais":-55000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"POLPAR S.A.","setor":"Outros","subsetor":" Outros ","segmento":" Outros","patrimonio.liquido":31922000,"lucro.liquido":403000,"atividades.operacionais":372000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"POMIFRUTAS S/A","setor":"Consumo não Cíclico","subsetor":" Agropecuária ","segmento":" Agricultura","patrimonio.liquido":-69329000,"lucro.liquido":-765000,"atividades.operacionais":-15000,"total.acoes":612122,"mil":true,"quantidade":1},{"nome.empresa":"PORTO SEGURO S.A.","setor":"Financeiro","subsetor":" Previdência e Seguros ","segmento":" Seguradoras","patrimonio.liquido":7725534000,"lucro.liquido":675037000,"atividades.operacionais":1352490000,"total.acoes":94159042,"mil":true,"quantidade":1},{"nome.empresa":"PORTO SUDESTE V.M. S.A.","setor":"Bens Industriais","subsetor":" Transporte ","segmento":" Serviços de Apoio e Armazenagem","patrimonio.liquido":43845,"lucro.liquido":-167520,"atividades.operacionais":-205704,"total.acoes":0,"mil":false,"quantidade":1},{"nome.empresa":"POSITIVO TECNOLOGIA S.A.","setor":"Tecnologia da Informação","subsetor":" Computadores e Equipamentos ","segmento":" Computadores e Equipamentos","patrimonio.liquido":518975000,"lucro.liquido":6473000,"atividades.operacionais":-18538000,"total.acoes":24312498,"mil":true,"quantidade":1},{"nome.empresa":"PPLA PARTICIPATIONS LTD.","setor":"Financeiro","subsetor":" Serviços Financeiros Diversos ","segmento":" Gestão de Recursos e Investimentos","patrimonio.liquido":150000,"lucro.liquido":-3344000,"atividades.operacionais":0,"total.acoes":54058515,"mil":true,"quantidade":1},{"nome.empresa":"PRATICA KLIMAQUIP INDUSTRIA E COMERCIO SA","setor":"Bens Industriais","subsetor":" Máquinas e Equipamentos ","segmento":" Máq. e Equip. Industriais","patrimonio.liquido":41863000,"lucro.liquido":698000,"atividades.operacionais":5362000,"total.acoes":3728273,"mil":true,"quantidade":1},{"nome.empresa":"PRINER SERVIÇOS INDUSTRIAIS S.A.","setor":"Bens Industriais","subsetor":" Serviços ","segmento":" Serviços Diversos","patrimonio.liquido":62916000,"lucro.liquido":-2491000,"atividades.operacionais":15164000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"PRODUTORES ENERGET.DE MANSO S.A.- PROMAN","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":1100000,"lucro.liquido":0,"atividades.operacionais":1582000,"total.acoes":45000,"mil":true,"quantidade":1},{"nome.empresa":"PROFARMA DISTRIB PROD FARMACEUTICOS S.A.","setor":"Saúde","subsetor":" Comércio e Distribuição ","segmento":" Medicamentos e Outros Produtos","patrimonio.liquido":984326000,"lucro.liquido":-7335000,"atividades.operacionais":-10819000,"total.acoes":87499778,"mil":true,"quantidade":1},{"nome.empresa":"PROMPT PARTICIPACOES S.A.","setor":"Outros","subsetor":" Outros ","segmento":" Outros","patrimonio.liquido":43122,"lucro.liquido":-106453,"atividades.operacionais":-104867,"total.acoes":6,"mil":false,"quantidade":1},{"nome.empresa":"QUALICORP CONSULTORIA E CORRETORA DE SEGUROS S.A.","setor":"Saúde","subsetor":" Serv.Méd.Hospit..Análises e Diagnósticos ","segmento":" Serv.Méd.Hospit..Análises e Diagnósticos","patrimonio.liquido":2378408000,"lucro.liquido":206982000,"atividades.operacionais":459067000,"total.acoes":223809099,"mil":true,"quantidade":1},{"nome.empresa":"QUALITY SOFTWARE S.A.","setor":"Tecnologia da Informação","subsetor":" Programas e Serviços ","segmento":" Programas e Serviços","patrimonio.liquido":38447393,"lucro.liquido":541515,"atividades.operacionais":-1633170,"total.acoes":861605,"mil":false,"quantidade":1},{"nome.empresa":"RAIA DROGASIL S.A.","setor":"Saúde","subsetor":" Comércio e Distribuição ","segmento":" Medicamentos e Outros Produtos","patrimonio.liquido":3591225000,"lucro.liquido":231224000,"atividades.operacionais":448558000,"total.acoes":213553757,"mil":true,"quantidade":1},{"nome.empresa":"RAIZEN ENERGIA S.A.","setor":"Consumo não Cíclico","subsetor":" Alimentos Processados ","segmento":" Açucar e Alcool","patrimonio.liquido":7739325000,"lucro.liquido":-99370000,"atividades.operacionais":-253576000,"total.acoes":7376625657,"mil":true,"quantidade":1},{"nome.empresa":"RANDON S.A. IMPLEMENTOS E PARTICIPACOES","setor":"Bens Industriais","subsetor":" Material de Transporte ","segmento":" Material Rodoviário","patrimonio.liquido":2145674000,"lucro.liquido":149022000,"atividades.operacionais":135191000,"total.acoes":197578201,"mil":true,"quantidade":1},{"nome.empresa":"RB CAPITAL COMPANHIA DE SECURITIZAÇÃO","setor":"Financeiro","subsetor":" Securitizadoras de Recebíveis ","segmento":" Securitizadoras de Recebíveis","patrimonio.liquido":24805000,"lucro.liquido":2532000,"atividades.operacionais":-409000,"total.acoes":1,"mil":true,"quantidade":1},{"nome.empresa":"RB CAPITAL SECURITIZADORA S.A.","setor":"Financeiro","subsetor":" Securitizadoras de Recebíveis ","segmento":" Securitizadoras de Recebíveis","patrimonio.liquido":7688000,"lucro.liquido":-10000,"atividades.operacionais":2509000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"REAL AI PIC SEC DE CREDITOS IMOBILIARIO S.A.","setor":"Financeiro","subsetor":" Securitizadoras de Recebíveis ","segmento":" Securitizadoras de Recebíveis","patrimonio.liquido":2080000,"lucro.liquido":2009000,"atividades.operacionais":26731000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"RECRUSUL S.A.","setor":"Bens Industriais","subsetor":" Material de Transporte ","segmento":" Material Rodoviário","patrimonio.liquido":-65802000,"lucro.liquido":-2049000,"atividades.operacionais":-2311000,"total.acoes":75823374,"mil":true,"quantidade":1},{"nome.empresa":"REDE ENERGIA PARTICIPAÇÕES S.A.","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":4633217000,"lucro.liquido":537069000,"atividades.operacionais":820451000,"total.acoes":8916515,"mil":true,"quantidade":1},{"nome.empresa":"REFINARIA DE PETROLEOS MANGUINHOS S.A.","setor":"Petróleo. Gás e Biocombustíveis","subsetor":" Petróleo. Gás e Biocombustíveis ","segmento":" Exploração. Refino e Distribuição","patrimonio.liquido":-2619851000,"lucro.liquido":-67364000,"atividades.operacionais":21855000,"total.acoes":23658396,"mil":true,"quantidade":1},{"nome.empresa":"RENOVA ENERGIA S.A.","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":-685314000,"lucro.liquido":-608825000,"atividades.operacionais":-10468000,"total.acoes":12943352,"mil":true,"quantidade":1},{"nome.empresa":"RESTOQUE COMÉRCIO E CONFECÇÕES DE ROUPAS S.A.","setor":"Consumo Cíclico","subsetor":" Comércio ","segmento":" Tecidos. Vestuário e Calçados","patrimonio.liquido":2253942000,"lucro.liquido":28174000,"atividades.operacionais":7787000,"total.acoes":25796692,"mil":true,"quantidade":1},{"nome.empresa":"RGE SUL DISTRIBUIDORA DE ENERGIA S.A.","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":3862908000,"lucro.liquido":296317000,"atividades.operacionais":735873000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"RIO PARANAPANEMA ENERGIA S.A.","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":1799806000,"lucro.liquido":164080000,"atividades.operacionais":403533000,"total.acoes":3597286,"mil":true,"quantidade":1},{"nome.empresa":"RNI NEGÓCIOS IMOBILIÁRIOS S.A.","setor":"Consumo Cíclico","subsetor":" Construção Civil ","segmento":" Incorporações","patrimonio.liquido":616649000,"lucro.liquido":-8669000,"atividades.operacionais":21417000,"total.acoes":15066029,"mil":true,"quantidade":1},{"nome.empresa":"RODOVIAS DAS COLINAS S.A.","setor":"Bens Industriais","subsetor":" Transporte ","segmento":" Exploração de Rodovias","patrimonio.liquido":565612000,"lucro.liquido":86409000,"atividades.operacionais":144275000,"total.acoes":74220000,"mil":true,"quantidade":1},{"nome.empresa":"ROSSI RESIDENCIAL S.A.","setor":"Consumo Cíclico","subsetor":" Construção Civil ","segmento":" Incorporações","patrimonio.liquido":-438601000,"lucro.liquido":-190105000,"atividades.operacionais":13186000,"total.acoes":12915712,"mil":true,"quantidade":1},{"nome.empresa":"RUMO MALHA NORTE S.A.","setor":"Bens Industriais","subsetor":" Transporte ","segmento":" Transporte Ferroviário","patrimonio.liquido":3474940000,"lucro.liquido":439903000,"atividades.operacionais":798495000,"total.acoes":1189412363,"mil":true,"quantidade":1},{"nome.empresa":"RUMO MALHA PAULISTA S.A.","setor":"Bens Industriais","subsetor":" Transporte ","segmento":" Transporte Ferroviário","patrimonio.liquido":-278721000,"lucro.liquido":-48229000,"atividades.operacionais":311492000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"RUMO S.A.","setor":"Bens Industriais","subsetor":" Transporte ","segmento":" Transporte Ferroviário","patrimonio.liquido":8034522000,"lucro.liquido":213802000,"atividades.operacionais":1343421000,"total.acoes":1053753059,"mil":true,"quantidade":1},{"nome.empresa":"SALUS INFRAESTRUTURA PORTUARIA SA","setor":"Bens Industriais","subsetor":" Transporte ","segmento":" Serviços de Apoio e Armazenagem","patrimonio.liquido":-24886000,"lucro.liquido":-24391000,"atividades.operacionais":-4228000,"total.acoes":4200,"mil":true,"quantidade":1},{"nome.empresa":"SANESALTO SANEAMENTO S.A.","setor":"Utilidade Pública","subsetor":" água e Saneamento ","segmento":" água e Saneamento","patrimonio.liquido":-525000,"lucro.liquido":310000,"atividades.operacionais":7012000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"SANSUY S.A. INDUSTRIA DE PLASTICOS","setor":"Materiais Básicos","subsetor":" Materiais Diversos ","segmento":" Materiais Diversos","patrimonio.liquido":-1145232000,"lucro.liquido":-91499000,"atividades.operacionais":7437000,"total.acoes":192910,"mil":true,"quantidade":1},{"nome.empresa":"SANTHER FAB DE PAPEL STA THEREZINHA S.A.","setor":"Materiais Básicos","subsetor":" Madeira e Papel ","segmento":" Papel e Celulose","patrimonio.liquido":28493000,"lucro.liquido":21874000,"atividades.operacionais":14764000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"SANTO ANTONIO ENERGIA S.A.","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":3748670000,"lucro.liquido":-445000000,"atividades.operacionais":223928000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"SANTOS BRASIL PARTICIPACOES S.A.","setor":"Bens Industriais","subsetor":" Transporte ","segmento":" Serviços de Apoio e Armazenagem","patrimonio.liquido":1342811000,"lucro.liquido":-2710000,"atividades.operacionais":24447000,"total.acoes":662056831,"mil":true,"quantidade":1},{"nome.empresa":"SAO CARLOS EMPREEND E PARTICIPACOES S.A.","setor":"Financeiro","subsetor":" Exploração de Imóveis ","segmento":" Exploração de Imóveis","patrimonio.liquido":1477549000,"lucro.liquido":66133000,"atividades.operacionais":16865000,"total.acoes":25378930,"mil":true,"quantidade":1},{"nome.empresa":"SAO MARTINHO S.A.","setor":"Consumo não Cíclico","subsetor":" Alimentos Processados ","segmento":" Açucar e Alcool","patrimonio.liquido":3518535000,"lucro.liquido":91463000,"atividades.operacionais":140770000,"total.acoes":147017773,"mil":true,"quantidade":1},{"nome.empresa":"SAO PAULO TURISMO S.A.","setor":"Consumo Cíclico","subsetor":" Viagens e Lazer ","segmento":" Produção de Eventos e Shows","patrimonio.liquido":16266000,"lucro.liquido":-23937000,"atividades.operacionais":-5536000,"total.acoes":277159,"mil":true,"quantidade":1},{"nome.empresa":"SARAIVA LIVREIROS S.A. - EM RECUPERAÇÃO JUDICIAL","setor":"Consumo Cíclico","subsetor":" Comércio ","segmento":" Produtos Diversos","patrimonio.liquido":-14597000,"lucro.liquido":-135533000,"atividades.operacionais":-19126000,"total.acoes":18649595,"mil":true,"quantidade":1},{"nome.empresa":"SCHULZ S.A.","setor":"Bens Industriais","subsetor":" Máquinas e Equipamentos ","segmento":" Motores . Compressores e Outros","patrimonio.liquido":579374000,"lucro.liquido":45128000,"atividades.operacionais":48491000,"total.acoes":49597453,"mil":true,"quantidade":1},{"nome.empresa":"SER EDUCACIONAL S.A.","setor":"Consumo Cíclico","subsetor":" Diversos ","segmento":" Serviços Educacionais","patrimonio.liquido":1326080000,"lucro.liquido":115098000,"atividades.operacionais":19212000,"total.acoes":54338507,"mil":true,"quantidade":1},{"nome.empresa":"SIDERURGICA J. L. ALIPERTI S.A.","setor":"Consumo não Cíclico","subsetor":" Agropecuária ","segmento":" Agricultura","patrimonio.liquido":227898000,"lucro.liquido":-1488000,"atividades.operacionais":3266000,"total.acoes":9166,"mil":true,"quantidade":1},{"nome.empresa":"SINQIA S.A.","setor":"Tecnologia da Informação","subsetor":" Programas e Serviços ","segmento":" Programas e Serviços","patrimonio.liquido":88658000,"lucro.liquido":-5918000,"atividades.operacionais":-12250000,"total.acoes":8875888,"mil":true,"quantidade":1},{"nome.empresa":"SLC AGRICOLA S.A.","setor":"Consumo não Cíclico","subsetor":" Agropecuária ","segmento":" Agricultura","patrimonio.liquido":3080439000,"lucro.liquido":323333000,"atividades.operacionais":-92386000,"total.acoes":85085106,"mil":true,"quantidade":1},{"nome.empresa":"SMARTFIT ESCOLA DE GINÁSTICA E DANÇA S.A.","setor":"Consumo Cíclico","subsetor":" Viagens e Lazer ","segmento":" Atividades Esportivas","patrimonio.liquido":1171831000,"lucro.liquido":-34222000,"atividades.operacionais":139061000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"SMILES FIDELIDADE S.A.","setor":"Consumo Cíclico","subsetor":" Diversos ","segmento":" Programas de Fidelização","patrimonio.liquido":1011870000,"lucro.liquido":297632000,"atividades.operacionais":551457000,"total.acoes":58842428,"mil":true,"quantidade":1},{"nome.empresa":"SONDOTECNICA ENGENHARIA SOLOS S.A.","setor":"Bens Industriais","subsetor":" Construção e Engenharia ","segmento":" Engenharia Consultiva","patrimonio.liquido":48630000,"lucro.liquido":876000,"atividades.operacionais":-816000,"total.acoes":884008,"mil":true,"quantidade":1},{"nome.empresa":"SPRINGER S.A.","setor":"Financeiro","subsetor":" Holdings Diversificadas ","segmento":" Holdings Diversificadas","patrimonio.liquido":38946000,"lucro.liquido":-1496000,"atividades.operacionais":-1134000,"total.acoes":317644,"mil":true,"quantidade":1},{"nome.empresa":"SPRINGS GLOBAL PARTICIPACOES S.A.","setor":"Consumo Cíclico","subsetor":" Tecidos. Vestuário e Calçados ","segmento":" Fios e Tecidos","patrimonio.liquido":1452108000,"lucro.liquido":133532000,"atividades.operacionais":-58337000,"total.acoes":23408641,"mil":true,"quantidade":1},{"nome.empresa":"STARA S.A. - INDÚSTRIA DE IMPLEMENTOS AGRÍCOLAS","setor":"Bens Industriais","subsetor":" Máquinas e Equipamentos ","segmento":" Máq. e Equip. Construção e Agrícolas","patrimonio.liquido":484556000,"lucro.liquido":45470000,"atividades.operacionais":-18420000,"total.acoes":31484081,"mil":true,"quantidade":1},{"nome.empresa":"STATKRAFT ENERGIAS RENOVAVEIS S.A.","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":1274868000,"lucro.liquido":46922000,"atividades.operacionais":90425000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"SUDESTE S.A.","setor":"Outros","subsetor":" Outros ","segmento":" Outros","patrimonio.liquido":37285,"lucro.liquido":-106128,"atividades.operacionais":-105140,"total.acoes":3,"mil":false,"quantidade":1},{"nome.empresa":"SUL 116 PARTICIPACOES S.A.","setor":"Outros","subsetor":" Outros ","segmento":" Outros","patrimonio.liquido":13788000,"lucro.liquido":-1225000,"atividades.operacionais":-860000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"SUL AMERICA S.A.","setor":"Financeiro","subsetor":" Previdência e Seguros ","segmento":" Seguradoras","patrimonio.liquido":6773826000,"lucro.liquido":483833000,"atividades.operacionais":294748000,"total.acoes":836228310,"mil":true,"quantidade":1},{"nome.empresa":"SUZANO HOLDING S.A.","setor":"Materiais Básicos","subsetor":" Madeira e Papel ","segmento":" Papel e Celulose","patrimonio.liquido":20506370000,"lucro.liquido":-530506000,"atividades.operacionais":3164467000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"SUZANO S.A.","setor":"Materiais Básicos","subsetor":" Madeira e Papel ","segmento":" Papel e Celulose","patrimonio.liquido":20429480000,"lucro.liquido":-529284000,"atividades.operacionais":3167400000,"total.acoes":725859318,"mil":true,"quantidade":1},{"nome.empresa":"T4F ENTRETENIMENTO S.A.","setor":"Consumo Cíclico","subsetor":" Viagens e Lazer ","segmento":" Produção de Eventos e Shows","patrimonio.liquido":290510000,"lucro.liquido":-52505000,"atividades.operacionais":30773000,"total.acoes":34987639,"mil":true,"quantidade":1},{"nome.empresa":"TAURUS ARMAS S.A.","setor":"Bens Industriais","subsetor":" Máquinas e Equipamentos ","segmento":" Armas e Munições","patrimonio.liquido":-305716000,"lucro.liquido":47675000,"atividades.operacionais":43480000,"total.acoes":43410258,"mil":true,"quantidade":1},{"nome.empresa":"TCP TERMINAL DE CONTEINERES DE PARANAGUA SA","setor":"Não Classificados","subsetor":" Não Classificado ","segmento":" Não Classificados","patrimonio.liquido":265123000,"lucro.liquido":4674000,"atividades.operacionais":160655000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"TECHNOS S.A.","setor":"Consumo Cíclico","subsetor":" Tecidos. Vestuário e Calçados ","segmento":" Acessórios","patrimonio.liquido":420060000,"lucro.liquido":-46455000,"atividades.operacionais":-1662000,"total.acoes":63134967,"mil":true,"quantidade":1},{"nome.empresa":"TECNISA S.A.","setor":"Consumo Cíclico","subsetor":" Construção Civil ","segmento":" Incorporações","patrimonio.liquido":636162000,"lucro.liquido":-146376000,"atividades.operacionais":83587000,"total.acoes":547783816,"mil":true,"quantidade":1},{"nome.empresa":"TECNOSOLO ENGENHARIA S.A.","setor":"Bens Industriais","subsetor":" Construção e Engenharia ","segmento":" Engenharia Consultiva","patrimonio.liquido":365000,"lucro.liquido":-770000,"atividades.operacionais":-1000,"total.acoes":80233505,"mil":true,"quantidade":1},{"nome.empresa":"TEGMA GESTAO LOGISTICA S.A.","setor":"Bens Industriais","subsetor":" Transporte ","segmento":" Transporte Rodoviário","patrimonio.liquido":515840000,"lucro.liquido":59135000,"atividades.operacionais":107049000,"total.acoes":32006778,"mil":true,"quantidade":1},{"nome.empresa":"TEKA-TECELAGEM KUEHNRICH S.A.","setor":"Consumo Cíclico","subsetor":" Tecidos. Vestuário e Calçados ","segmento":" Fios e Tecidos","patrimonio.liquido":-1510445000,"lucro.liquido":-75226000,"atividades.operacionais":5631000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"TEKNO S.A. - INDUSTRIA E COMERCIO","setor":"Materiais Básicos","subsetor":" Siderurgia e Metalurgia ","segmento":" Artefatos de Ferro e Aço","patrimonio.liquido":171955000,"lucro.liquido":-1420000,"atividades.operacionais":-4998000,"total.acoes":310036,"mil":true,"quantidade":1},{"nome.empresa":"TELEC BRASILEIRAS S.A. TELEBRAS","setor":"Telecomunicações","subsetor":" Telecomunicações ","segmento":" Telecomunicações","patrimonio.liquido":138178000,"lucro.liquido":-230818000,"atividades.operacionais":-108296000,"total.acoes":3072072,"mil":true,"quantidade":1},{"nome.empresa":"TELEFÔNICA BRASIL S.A","setor":"Telecomunicações","subsetor":" Telecomunicações ","segmento":" Telecomunicações","patrimonio.liquido":69666124000,"lucro.liquido":2761647000,"atividades.operacionais":8022907000,"total.acoes":444452657,"mil":true,"quantidade":1},{"nome.empresa":"TERMELÉTRICA PERNAMBUCO III S.A.","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":-238471000,"lucro.liquido":-19887000,"atividades.operacionais":8034000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"TERMINAL GARAGEM MENEZES CORTES S.A.","setor":"Financeiro","subsetor":" Exploração de Imóveis ","segmento":" Exploração de Imóveis","patrimonio.liquido":114007000,"lucro.liquido":480000,"atividades.operacionais":-483000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"TERMOPERNAMBUCO S.A.","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":827993000,"lucro.liquido":101275000,"atividades.operacionais":110690000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"TERRA SANTA AGRO S.A.","setor":"Consumo não Cíclico","subsetor":" Agropecuária ","segmento":" Agricultura","patrimonio.liquido":1030876000,"lucro.liquido":-8739000,"atividades.operacionais":111471000,"total.acoes":7289479,"mil":true,"quantidade":1},{"nome.empresa":"TEXTIL RENAUXVIEW S.A.","setor":"Consumo Cíclico","subsetor":" Tecidos. Vestuário e Calçados ","segmento":" Fios e Tecidos","patrimonio.liquido":-305523000,"lucro.liquido":7271000,"atividades.operacionais":6516000,"total.acoes":4259280,"mil":true,"quantidade":1},{"nome.empresa":"TIM PARTICIPACOES S.A.","setor":"Telecomunicações","subsetor":" Telecomunicações ","segmento":" Telecomunicações","patrimonio.liquido":21939911000,"lucro.liquido":2142134000,"atividades.operacionais":1354707000,"total.acoes":807711660,"mil":true,"quantidade":1},{"nome.empresa":"TOTVS S.A.","setor":"Tecnologia da Informação","subsetor":" Programas e Serviços ","segmento":" Programas e Serviços","patrimonio.liquido":2405720000,"lucro.liquido":69271000,"atividades.operacionais":161699000,"total.acoes":134465885,"mil":true,"quantidade":1},{"nome.empresa":"TPI - TRIUNFO PARTICIP. E INVEST. S.A.","setor":"Bens Industriais","subsetor":" Transporte ","segmento":" Exploração de Rodovias","patrimonio.liquido":804301000,"lucro.liquido":-164828000,"atividades.operacionais":125489000,"total.acoes":74079297,"mil":true,"quantidade":1},{"nome.empresa":"TRANSMISSORA ALIANÇA DE ENERGIA ELÉTRICA S.A.","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":4906045000,"lucro.liquido":467005000,"atividades.operacionais":457903000,"total.acoes":655704742,"mil":true,"quantidade":1},{"nome.empresa":"TREVISA INVESTIMENTOS S.A.","setor":"Bens Industriais","subsetor":" Transporte ","segmento":" Transporte Hidroviário","patrimonio.liquido":110258000,"lucro.liquido":5137000,"atividades.operacionais":12321000,"total.acoes":1569600,"mil":true,"quantidade":1},{"nome.empresa":"TRIÂNGULO DO SOL AUTO-ESTRADAS S.A.","setor":"Bens Industriais","subsetor":" Transporte ","segmento":" Exploração de Rodovias","patrimonio.liquido":326323000,"lucro.liquido":86488000,"atividades.operacionais":143150000,"total.acoes":610000,"mil":true,"quantidade":1},{"nome.empresa":"TRISUL S.A.","setor":"Consumo Cíclico","subsetor":" Construção Civil ","segmento":" Incorporações","patrimonio.liquido":666276000,"lucro.liquido":57958000,"atividades.operacionais":2892000,"total.acoes":40017939,"mil":true,"quantidade":1},{"nome.empresa":"TRONOX PIGMENTOS DO BRASIL S.A.","setor":"Materiais Básicos","subsetor":" Químicos ","segmento":" Químicos Diversos","patrimonio.liquido":530778000,"lucro.liquido":38013000,"atividades.operacionais":78687000,"total.acoes":29018747,"mil":true,"quantidade":1},{"nome.empresa":"TRUE SECURITIZADORA S.A.","setor":"Financeiro","subsetor":" Securitizadoras de Recebíveis ","segmento":" Securitizadoras de Recebíveis","patrimonio.liquido":2348000,"lucro.liquido":1868000,"atividades.operacionais":1913000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"TUPY S.A.","setor":"Bens Industriais","subsetor":" Material de Transporte ","segmento":" Material Rodoviário","patrimonio.liquido":2205327000,"lucro.liquido":139890000,"atividades.operacionais":69364000,"total.acoes":65947515,"mil":true,"quantidade":1},{"nome.empresa":"ULTRAPAR PARTICIPACOES S.A.","setor":"Petróleo. Gás e Biocombustíveis","subsetor":" Petróleo. Gás e Biocombustíveis ","segmento":" Exploração. Refino e Distribuição","patrimonio.liquido":10068130000,"lucro.liquido":363286000,"atividades.operacionais":1527246000,"total.acoes":1085159631,"mil":true,"quantidade":1},{"nome.empresa":"UNICASA INDÚSTRIA DE MÓVEIS S.A.","setor":"Consumo Cíclico","subsetor":" Utilidades Domésticas ","segmento":" Móveis","patrimonio.liquido":178292000,"lucro.liquido":7026000,"atividades.operacionais":14285000,"total.acoes":28074138,"mil":true,"quantidade":1},{"nome.empresa":"UNIDAS S.A.","setor":"Consumo Cíclico","subsetor":" Diversos ","segmento":" Aluguel de carros","patrimonio.liquido":1333466000,"lucro.liquido":86689000,"atividades.operacionais":-424752000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"UNIPAR CARBOCLORO S.A.","setor":"Materiais Básicos","subsetor":" Químicos ","segmento":" Químicos Diversos","patrimonio.liquido":1453417000,"lucro.liquido":56603000,"atividades.operacionais":168072000,"total.acoes":59097731,"mil":true,"quantidade":1},{"nome.empresa":"UPTICK PARTICIPACOES S.A.","setor":"Utilidade Pública","subsetor":" Energia Elétrica ","segmento":" Energia Elétrica","patrimonio.liquido":87303000,"lucro.liquido":6882000,"atividades.operacionais":-334000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"USINAS SID DE MINAS GERAIS S.A.-USIMINAS","setor":"Materiais Básicos","subsetor":" Siderurgia e Metalurgia ","segmento":" Siderurgia","patrimonio.liquido":15917202000,"lucro.liquido":247524000,"atividades.operacionais":298707000,"total.acoes":674719826,"mil":true,"quantidade":1},{"nome.empresa":"VALE S.A.","setor":"Materiais Básicos","subsetor":" Mineração ","segmento":" Minerais Metálicos","patrimonio.liquido":165982310000,"lucro.liquido":-6964487000,"atividades.operacionais":19824377000,"total.acoes":3147743563,"mil":true,"quantidade":1},{"nome.empresa":"VALID SOLUÇÕES S.A.","setor":"Bens Industriais","subsetor":" Serviços ","segmento":" Serviços Diversos","patrimonio.liquido":1103928000,"lucro.liquido":21038000,"atividades.operacionais":69162000,"total.acoes":68845943,"mil":true,"quantidade":1},{"nome.empresa":"VERT COMPANHIA SECURITIZADORA","setor":"Financeiro","subsetor":" Securitizadoras de Recebíveis ","segmento":" Securitizadoras de Recebíveis","patrimonio.liquido":1149000,"lucro.liquido":-116000,"atividades.operacionais":-163000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"VIA VAREJO S.A.","setor":"Consumo Cíclico","subsetor":" Comércio ","segmento":" Eletrodomésticos","patrimonio.liquido":1850000000,"lucro.liquido":-196000000,"atividades.operacionais":-2539000000,"total.acoes":1147404383,"mil":true,"quantidade":1},{"nome.empresa":"VIVER INCORPORADORA E CONSTRUTORA S.A.","setor":"Consumo Cíclico","subsetor":" Construção Civil ","segmento":" Incorporações","patrimonio.liquido":-12568000,"lucro.liquido":-94020000,"atividades.operacionais":-14057000,"total.acoes":46317035,"mil":true,"quantidade":1},{"nome.empresa":"VULCABRAS/AZALEIA S.A.","setor":"Consumo Cíclico","subsetor":" Tecidos. Vestuário e Calçados ","segmento":" Calçados","patrimonio.liquido":997967000,"lucro.liquido":56187000,"atividades.operacionais":149559000,"total.acoes":74685291,"mil":true,"quantidade":1},{"nome.empresa":"WEG S.A.","setor":"Bens Industriais","subsetor":" Máquinas e Equipamentos ","segmento":" Motores . Compressores e Outros","patrimonio.liquido":8168446000,"lucro.liquido":703467000,"atividades.operacionais":406964000,"total.acoes":740696136,"mil":true,"quantidade":1},{"nome.empresa":"WETZEL S.A.","setor":"Bens Industriais","subsetor":" Material de Transporte ","segmento":" Material Rodoviário","patrimonio.liquido":-190336000,"lucro.liquido":-19532000,"atividades.operacionais":-1655000,"total.acoes":0,"mil":true,"quantidade":1},{"nome.empresa":"WHIRLPOOL S.A.","setor":"Consumo Cíclico","subsetor":" Utilidades Domésticas ","segmento":" Eletrodomésticos","patrimonio.liquido":2551517000,"lucro.liquido":536254000,"atividades.operacionais":126850000,"total.acoes":28701029,"mil":true,"quantidade":1},{"nome.empresa":"WILSON SONS LTD.","setor":"Bens Industriais","subsetor":" Transporte ","segmento":" Serviços de Apoio e Armazenagem","patrimonio.liquido":1890969000,"lucro.liquido":47123000,"atividades.operacionais":200518000,"total.acoes":29799660,"mil":true,"quantidade":1},{"nome.empresa":"WIZ SOLUÇÕES E CORRETAGEM DE SEGUROS S.A.","setor":"Financeiro","subsetor":" Previdência e Seguros ","segmento":" Corretoras de Seguros","patrimonio.liquido":194894000,"lucro.liquido":110655000,"atividades.operacionais":128358000,"total.acoes":76791625,"mil":true,"quantidade":1},{"nome.empresa":"WLM PART. E COMÉRCIO DE MÁQUINAS E VEÍCULOS S.A.","setor":"Bens Industriais","subsetor":" Comércio ","segmento":" Material de Transporte","patrimonio.liquido":400923000,"lucro.liquido":15083000,"atividades.operacionais":16092000,"total.acoes":5501255,"mil":true,"quantidade":1},{"nome.empresa":"524 PARTICIPACOES S.A.","setor":"Outros","subsetor":" Outros ","segmento":" Outros","patrimonio.liquido":88000,"lucro.liquido":-104000,"atividades.operacionais":-100000,"total.acoes":910,"mil":true,"quantidade":1}],"settings":{"type":"tree_map","id":["setor","subsetor","segmento","nome.empresa"],"title":["function (main = NULL, sub = NULL, xlab = NULL, ylab = NULL, ","    line = NA, outer = FALSE, ...) ","{","    main <- as.graphicsAnnot(main)","    sub <- as.graphicsAnnot(sub)","    xlab <- as.graphicsAnnot(xlab)","    ylab <- as.graphicsAnnot(ylab)","    .External.graphics(C_title, main, sub, xlab, ylab, line, ","        outer, ...)","    invisible()","}"],"currency":"US$","number_text":["K","M","M","B","B"],"currency_var":null,"percent_var":null,"noformat_number_var":null,"d3plus_number_format":true,"locale":"en_US","clean_previous":false,"dictionary":{}},"d3plusSize":{"value":"patrimonio.liquido"},"d3plusLegend":{"value":true,"order":{"sort":"desc","value":"size"}},"d3plusColor":{"value":"setor"},"d3plusDepth":{"value":1},"d3plusLabels":{"value":true,"valign":"top"},"d3plusUi":[{"method":"size","value":[{"Patrimonio":"patrimonio.liquido"},{"Qtd.Empresas":"quantidade"},{"Qtd.Acoes":"total.acoes"}]},{"method":"depth","type":"drop","value":[{"Setor":0},{"Subsetor":1},{"Segmento":2},{"Empresa":3}]}]},"evals":[],"jsHooks":[]}</script>
</div>
<p>No treemap acima, somamos o total do patrimônio para avaliarmos as proporções, mas é curioso notar que existem empresas com patrimônio líquido negativo. Vamos verificar os setores separando o total de patrimônio líquido negativo e positivo.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
library(ggplot2)</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
dados %&gt;% 
  mutate(patrimonio = ifelse(patrimonio.liquido &gt; 0, &#39;positivo&#39;, &#39;negativo&#39;)) %&gt;% 
  group_by(setor, patrimonio) %&gt;% 
  summarise(patrimonio.total = sum(patrimonio.liquido)) %&gt;% 
  ungroup() %&gt;% 
  ggplot(aes(x = reorder(setor, patrimonio.total), y = patrimonio.total, fill = patrimonio))+
  geom_bar(stat = &quot;identity&quot;)+
  coord_flip() + 
  theme(legend.position = &quot;none&quot;) +
  labs(title = &quot;Patrimônio positivo e negativo por setores&quot;,
       y = &quot;Patrimônio&quot;,
       x = &quot;Setores&quot;)</code></pre>
<p><img src="b3-rvest-explorando-dados-financeiros-com-r_files/figure-html5/unnamed-chunk-34-1.png" width="624" /></p>
</div>
<p>Comportamento parecido existe no somatório do lucro líquido dos grandes setores. Faremos o mesmo exercício separando o lucro líquido positivo e o lucro líquido negativo.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
dados %&gt;% 
  mutate(lucro = ifelse(lucro.liquido &gt; 0, &#39;positivo&#39;, &#39;negativo&#39;)) %&gt;% 
  group_by(setor, lucro) %&gt;% 
  summarise(lucro.total = sum(lucro.liquido)) %&gt;% 
  ungroup() %&gt;% 
  ggplot(aes(x = reorder(setor, lucro.total), y = lucro.total, fill = lucro))+
  geom_bar(stat = &quot;identity&quot;) +
  coord_flip() + 
  theme(legend.position = &quot;none&quot;) + 
  labs(title = &quot;Lucro e prejuízo por setores&quot;,
       y = &quot;Lucro&quot;,
       x = &quot;Setores&quot;)</code></pre>
<p><img src="b3-rvest-explorando-dados-financeiros-com-r_files/figure-html5/unnamed-chunk-35-1.png" width="624" /></p>
</div>
<h2 id="conclusao">Conclusão</h2>
<p>Com o R + rvest foi possível raspar alguns dados da B3 e montar um dataframe básico, com isso exploramos minimamente os setores das empresas oferecidas na bolsa de valores brasileira e esboçamos algumas visualizações para começar a interpretar. Muitas outras visualizações e explorações passam a ser possíveis com essa estrutura de scraping. Nos próximos posts desse tema vamos tentar outras abordagens e</p>
<!--radix_placeholder_article_footer-->
<div class="article-footer">
  <p class="social_footer">
    <span class="disqus-comments">
      <i class="fas fa-comments"></i>
      &nbsp;
      <span class="disqus-comment-count" data-disqus-identifier="posts/2019-07-18-b3-rvest-explorando-dados-financeiros-com-r/">Comment on this article</span>
    </span>
    <span class="article-sharing">
      Share: &nbsp;
      <a href="https://twitter.com/share?text=B3%20%2B%20rvest%3A%20Explorando%20dados%20financeiros%20com%20R%20-%20parte%201&amp;url=https%3A%2F%2Fwww.fulljoin.com.br%2Fposts%2F2019-07-18-b3-rvest-explorando-dados-financeiros-com-r%2F">
        <i class="fab fa-twitter"></i>
      </a>
      <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fwww.fulljoin.com.br%2Fposts%2F2019-07-18-b3-rvest-explorando-dados-financeiros-com-r%2F&amp;title=B3%20%2B%20rvest%3A%20Explorando%20dados%20financeiros%20com%20R%20-%20parte%201">
        <i class="fab fa-linkedin"></i>
      </a>
      <a href="https://www.facebook.com/sharer/sharer.php?s=100&amp;p[url]=https%3A%2F%2Fwww.fulljoin.com.br%2Fposts%2F2019-07-18-b3-rvest-explorando-dados-financeiros-com-r%2F">
        <i class="fab fa-facebook"></i>
      </a>
    </span>
  </p>
  <script id="dsq-count-scr" src="https://fulljoin.disqus.com/count.js" async></script>
  <div id="disqus_thread" class="hidden"></div>
  <script>
var disqus_config = function () {
  this.page.url = 'https://www.fulljoin.com.br/posts/2019-07-18-b3-rvest-explorando-dados-financeiros-com-r/';
  this.page.identifier = 'posts/2019-07-18-b3-rvest-explorando-dados-financeiros-com-r/';
};
(function() {
  var d = document, s = d.createElement('script');
  s.src = 'https://fulljoin.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
})();
</script>
</div>
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Guerra (2019, Aug. 27). Fulljoin: B3 + rvest: Explorando dados financeiros com R - parte 1. Retrieved from https://www.fulljoin.com.br/posts/2019-07-18-b3-rvest-explorando-dados-financeiros-com-r/</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@misc{guerra2019b3,
  author = {Guerra, Saulo},
  title = {Fulljoin: B3 + rvest: Explorando dados financeiros com R - parte 1},
  url = {https://www.fulljoin.com.br/posts/2019-07-18-b3-rvest-explorando-dados-financeiros-com-r/},
  year = {2019}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<div class="distill-site-nav distill-site-footer">
  <p>Gostou do blog? <u><a href="https://www.buymeacoffee.com/LYcEmgQ">Pague-nos um cafezinho!</a></u></p>
</div>
<!--/radix_placeholder_navigation_after_body-->


</body>

</html>
